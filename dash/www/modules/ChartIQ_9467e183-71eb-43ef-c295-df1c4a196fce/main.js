define(["backbone","Handlebars","QuickBase","css!./css/app.css","css!./css/./../lib/chartiq/css/stx-chart","css!./css/./chart"],function(a,e,t){var r={_LayerId:{type:"string",options:{hidden:!0}},_PossibleColumns:{type:"array",options:{hidden:!0}},Name:{type:"string",title:"Name",default:"",propertyOrder:10,watch:{Field:"Field"}},Data:{type:"data",title:"Data Source",default:"",propertyOrder:20},XAxisData:{type:"string",title:"X-Axis Data",enumSource:"possible_columns",watch:{possible_columns:"arrItem._PossibleColumns"},propertyOrder:100},YAxisData:{type:"string",title:"Y-Axis Data",enumSource:"possible_columns",watch:{possible_columns:"arrItem._PossibleColumns"},propertyOrder:110},YAxis:{type:"string",title:"Y-Axis",enumSource:"possible_axes",watch:{possible_axes:"root._PossibleAxes"},propertyOrder:120},Color:{type:"gradient",default:"#ff0000",options:{gradient:!1},propertyOrder:310},Opacity:{default:80,minimum:1,maximum:100,type:"number",step:1,format:"range",propertyOrder:320},SelectedObjectRouting:{type:"array",format:"table",title:"Selected Item ViewState Routing",options:{collapsed:!0},items:{type:"object",title:"Routing",properties:{ColumnProperty:{title:"Column",type:"string",enumSource:"possible_columns",watch:{possible_columns:"arrItem._PossibleColumns"}},ViewstateProperty:{title:"Viewstate",type:"viewstate"}}},propertyOrder:510}},s={getComponentDefinition:function(e){var t,i,n={id:1,componentName:"ChartIQ",componentDescription:"",version:"4.0.0d2",appArgs:{quickStart:[{path:"Layers.0.Data"}],json:{Layers:[{_Type:"Line",Width:1,_LayerId:"layer_25980",_PossibleColumns:[],Name:"",Data:"",XAxisData:"",YAxisData:"",YAxis:"Axis",Color:"#ff0000",Opacity:80,SelectedObjectRouting:[]}],Axes:{X:{DisplayGridLines:!0},Y:[{Name:"Axis",DisplayGridLines:!0,DecimalPlaces:4,LabelStyle:"roundRectArrow",Min:0,Max:100,Position:"Right"}]},Options:{DisplayMenu:!1},Style:{advanced:""}},schema:{type:"object",title:"Properties",properties:{_PossibleAxes:{options:{hidden:!0}},Layers:{type:"array",propertyOrder:200,_paste:function(e,t,i){function n(e){return _.get(e,"_LayerId")&&_.set(e,"_LayerId",_.uniqueId("layer_")),e}i(_.isArray(e)?_.map(e,n):n(e))},items:{type:"object",id:"arrItem",additionalProperties:!1,options:{keep_oneof_values:!0,oneof_filter:function(e,t){return!("OHLC"===e.title&&0<t)}},title:"Layer",headerTemplate:"Layer {{ i1 }}",oneOf:[{title:"Line",options:{linked_oneof_property:{property:"_Type",value:"Line"}},properties:_.extend({_Type:{type:"string",default:"Line",options:{hidden:!0}},Width:{default:1,minimum:1,maximum:10,type:"number",step:1,format:"range",propertyOrder:330}},r)},{title:"Bar",options:{linked_oneof_property:{property:"_Type",value:"Bar"}},properties:_.extend({_Type:{type:"string",default:"Bar",options:{hidden:!0}}},r)},{title:"Mountain",options:{linked_oneof_property:{property:"_Type",value:"Mountain"}},properties:_.extend({_Type:{type:"string",default:"Mountain",options:{hidden:!0}}},r)},{title:"OHLC",options:{linked_oneof_property:{property:"_Type",value:"OHLC"}},properties:_.extend({_Type:{type:"string",default:"OHLC",options:{hidden:!0}}},r,{XAxisData:{options:{hidden:!0}},YAxisData:{options:{hidden:!0}},Color:{options:{hidden:!0}},Opacity:{options:{hidden:!0}}})}]}},Axes:{type:"object",propertyOrder:201,properties:{X:{type:"object",properties:{DisplayGridLines:{type:"boolean",format:"checkbox",title:"Display Grid Lines"},RangeMin:{type:"string",title:"View Start",propertyOrder:200},RangeMax:{type:"string",title:"View End",propertyOrder:210},DataStart:{type:"viewstate",title:"Data Start",propertyOrder:220},DataEnd:{type:"viewstate",title:"Data End",propertyOrder:230}}},Y:{type:"array",items:{type:"object",id:"arrItem",title:"Axis",headerTemplate:"Axis {{ Name }}",properties:{DisplayGridLines:{type:"boolean",format:"checkbox",title:"Display Grid Lines"},DecimalPlaces:{type:"number",min:0,max:4},LabelStyle:{type:"string",title:"Label Style",enum:["roundRectArrow","semiRoundRect","roundRect","tickedRect","rect","noop"]},Min:{type:"number"},Max:{type:"number"},Name:{type:"string"},Position:{type:"string",enum:["Left","Right"]}}}}}},Options:{type:"object",propertyOrder:202,properties:{DisplayMenu:{type:"boolean",format:"checkbox",title:"Display Menu"},Layout:{type:"string"},Drawings:{type:"string"}}},Style:{type:"object",title:"Style",options:{collapsed:!0},propertyOrder:210,properties:{advanced:{type:"css",title:"Advanced CSS",default:""}}}}}}};if(0<_.keys(e.settingsModel.attributes).length)for(i=s.upgrades.indexOf(_.find(s.upgrades,{version:e.settingsModel.get("version")}))+1;i<s.upgrades.length;i+=1)(t=s.upgrades[i]).fn(e.settingsModel),e.settingsModel.set("version",t.version);return n},upgrades:[{version:0,fn:function(){}},{version:"4.0.0d2",fn:function(e){e.set("Style.advanced","")}}]},i=(n.app=e.template({compiler:[7,">= 4.0.0"],main:function(e,t,i,n,r){return'<div class="chart-container"></div>'},useData:!0}),n.chart=e.template({compiler:[7,">= 4.0.0"],main:function(e,t,i,n,r){return'<div cq-context>\r\n    <cq-ui-manager></cq-ui-manager>\r\n    <cq-color-picker>\r\n        <cq-colors></cq-colors>\r\n        <cq-overrides>\r\n            <template>\r\n                <div class="ciq-btn"></div>\r\n            </template>\r\n        </cq-overrides>\r\n    </cq-color-picker>\r\n\r\n    <div class="ciq-nav ui-widget-content">\r\n        <div class="ciq-menu-section">\r\n            <div class="ciq-dropdowns">\r\n                <cq-menu class="ciq-menu ciq-period">\r\n                    <span><cq-clickable stxbind="Layout.periodicity">1D</cq-clickable></span>\r\n                    <cq-menu-dropdown class="ui-widget-content">\r\n                        <cq-item stxtap="Layout.setPeriodicity(1, \'day\')">1 D</cq-item>\r\n                        <cq-item stxtap="Layout.setPeriodicity(1, \'week\')">1 W</cq-item>\r\n                        <cq-item stxtap="Layout.setPeriodicity(1, \'month\')">1 Mo</cq-item>\r\n                        <cq-separator></cq-separator>\r\n                        <cq-item stxtap="Layout.setPeriodicity(1, 1)">1 Min</cq-item>\r\n                        <cq-item stxtap="Layout.setPeriodicity(1,5)">5 Min</cq-item>\r\n                        <cq-item stxtap="Layout.setPeriodicity(1,10)">10 Min</cq-item>\r\n                        <cq-item stxtap="Layout.setPeriodicity(3,5)">15 Min</cq-item>\r\n                        <cq-item stxtap="Layout.setPeriodicity(1,30)">30 Min</cq-item>\r\n                        <cq-item stxtap="Layout.setPeriodicity(2,30)">1 Hour</cq-item>\r\n                        <cq-item stxtap="Layout.setPeriodicity(8,30)">4 Hour</cq-item>\r\n                    </cq-menu-dropdown>\r\n                </cq-menu>\r\n                <cq-menu class="ciq-menu ciq-views collapse">\r\n                    <span>Views</span>\r\n                    <cq-menu-dropdown class="ui-widget-content">\r\n                        <cq-views>\r\n                            <cq-heading>Saved Views</cq-heading>\r\n                            <cq-views-content>\r\n                                <template cq-view>\r\n                                    <cq-item>\r\n                                        <cq-label></cq-label>\r\n                                        <div class="ciq-icon ciq-close"></div>\r\n                                    </cq-item>\r\n                                </template>\r\n                            </cq-views-content>\r\n                            <cq-separator cq-partial></cq-separator>\r\n                            <cq-view-save>\r\n                                <cq-item><cq-plus></cq-plus> Save View </cq-item>\r\n                            </cq-view-save>\r\n                        </cq-views>\r\n                    </cq-menu-dropdown>\r\n                </cq-menu>\r\n                <cq-menu class="ciq-menu ciq-display collapse">\r\n                    <span>Display</span>\r\n                    <cq-menu-dropdown class="ui-widget-content">\r\n                        <cq-heading>Chart Style</cq-heading>\r\n                        <cq-item stxsetget="Layout.ChartType(\'candle\')">\r\n                            Candle<span class="ciq-radio"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-item stxsetget="Layout.ChartType(\'bar\')">\r\n                            Bar<span class="ciq-radio"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-item stxsetget="Layout.ChartType(\'colored_bar\')">\r\n                            Colored Bar<span class="ciq-radio"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-item stxsetget="Layout.ChartType(\'line\')">\r\n                            Line<span class="ciq-radio"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-item stxsetget="Layout.ChartType(\'hollow_candle\')">\r\n                            Hollow Candle<span class="ciq-radio"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-item stxsetget="Layout.ChartType(\'mountain\')">\r\n                            Mountain<span class="ciq-radio"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-item stxsetget="Layout.ChartType(\'baseline_delta\')">\r\n                            Baseline<span class="ciq-radio"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-item stxsetget="Layout.ChartType(\'volume_candle\')">\r\n                            Volume Candle<span class="ciq-radio"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-separator></cq-separator>\r\n                        <cq-item>\r\n                            <div stxsetget="Layout.ChartType(\'heikinashi\')">\r\n                                Heikin Ashi<span class="ciq-radio"><span></span></span>\r\n                            </div>\r\n                        </cq-item>\r\n                        <cq-item>\r\n                            <span class="ciq-edit" stxtap="Layout.showAggregationEdit(\'kagi\')"></span>\r\n                            <div stxsetget="Layout.ChartType(\'kagi\')">\r\n                                Kagi<span class="ciq-radio"><span></span></span>\r\n                            </div>\r\n                        </cq-item>\r\n                        <cq-item>\r\n                            <span class="ciq-edit" stxtap="Layout.showAggregationEdit(\'linebreak\')"></span>\r\n                            <div stxsetget="Layout.ChartType(\'linebreak\')">\r\n                                Line Break<span class="ciq-radio"><span></span></span>\r\n                            </div>\r\n                        </cq-item>\r\n                        <cq-item>\r\n                            <span class="ciq-edit" stxtap="Layout.showAggregationEdit(\'renko\')"></span>\r\n                            <div stxsetget="Layout.ChartType(\'renko\')">\r\n                                Renko<span class="ciq-radio"><span></span></span>\r\n                            </div>\r\n                        </cq-item>\r\n                        <cq-item>\r\n                            <span class="ciq-edit" stxtap="Layout.showAggregationEdit(\'rangebars\')"></span>\r\n                            <div stxsetget="Layout.ChartType(\'rangebars\')">\r\n                                Range Bars<span class="ciq-radio"><span></span></span>\r\n                            </div>\r\n                        </cq-item>\r\n                        <cq-item>\r\n                            <span class="ciq-edit" stxtap="Layout.showAggregationEdit(\'pandf\')"></span>\r\n                            <div stxsetget="Layout.ChartType(\'pandf\')">\r\n                                Point & Figure<span class="ciq-radio"><span></span></span>\r\n                            </div>\r\n                        </cq-item>\r\n                        <cq-separator></cq-separator>\r\n                        <cq-heading>Chart Preferences</cq-heading>\r\n                        <cq-item stxsetget="Layout.ChartScale(\'log\')">\r\n                            Log Scale<span class="ciq-checkbox ciq-active"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-item stxsetget="Layout.ExtendedHours()">\r\n                            Extended Hours<span class="ciq-checkbox ciq-active"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-separator></cq-separator>\r\n                        <cq-heading>Timezone</cq-heading>\r\n                        <cq-item>\r\n                            <cq-clickable cq-selector="cq-timezone-dialog" cq-method="open">\r\n                                <translate original="Change Timezone">Change Timezone</translate>\r\n                            </cq-clickable>\r\n                        </cq-item>\r\n                        \x3c!--<cq-separator></cq-separator>\r\n                        <cq-heading>Themes</cq-heading>\r\n                        <cq-themes id="">\r\n                            <cq-themes-builtin cq-no-close="">\r\n                                <template>\r\n                                    <cq-item></cq-item>\r\n                                </template>\r\n                                <cq-item>\r\n                                    <translate original="Day">Day</translate>\r\n                                </cq-item>\r\n                                <cq-item>\r\n                                    <translate original="Night">Night</translate>\r\n                                </cq-item>\r\n                            </cq-themes-builtin>\r\n                            <cq-themes-custom cq-no-close="">\r\n                                <template>\r\n                                    <cq-theme-custom>\r\n                                        <cq-item>\r\n                                            <cq-label></cq-label>\r\n                                            <cq-close></cq-close>\r\n                                        </cq-item>\r\n                                    </cq-theme-custom>\r\n                                </template>\r\n                            </cq-themes-custom>\r\n                            <cq-separator cq-partial=""></cq-separator>\r\n                            <cq-item stxtap="newTheme()">\r\n                                <cq-plus></cq-plus>\r\n                                <translate original="New Theme">New Theme</translate>\r\n                            </cq-item>\r\n                        </cq-themes>--\x3e\r\n                    </cq-menu-dropdown>\r\n                </cq-menu>\r\n                <cq-menu class="ciq-menu ciq-studies collapse">\r\n                    <span>Studies</span>\r\n                    <cq-menu-dropdown cq-no-scroll class="ui-widget-content">\r\n                        <cq-study-legend cq-no-close>\r\n                            <cq-section-dynamic class="ui-widget-content">\r\n                                <cq-heading>Current Studies</cq-heading>\r\n                                <cq-study-legend-content>\r\n                                    <template>\r\n                                        <cq-item>\r\n                                            <cq-label class="click-to-edit"></cq-label>\r\n                                            <div class="ciq-icon ciq-close"></div>\r\n                                        </cq-item>\r\n                                    </template>\r\n                                </cq-study-legend-content>\r\n                                <cq-placeholder>\r\n                                    <div stxtap="Layout.clearStudies()" class="ciq-btn sm">Clear All</div>\r\n                                </cq-placeholder>\r\n                            </cq-section-dynamic>\r\n                        </cq-study-legend>\r\n                        <cq-scroll>\r\n\t\t\t\t\t\t\t<cq-studies>\r\n\t\t\t\t\t\t\t\t<cq-studies-content>\r\n\t\t\t\t\t\t\t\t\t\t<template>\r\n\t\t\t\t\t\t\t\t\t\t\t<cq-item>\r\n\t\t\t\t\t\t\t\t\t\t\t\t<cq-label></cq-label>\r\n\t\t\t\t\t\t\t\t\t\t\t</cq-item>\r\n\t\t\t\t\t\t\t\t\t\t</template>\r\n\t\t\t\t\t\t\t\t</cq-studies-content>\r\n\t\t\t\t\t\t\t</cq-studies>\r\n\t\t\t\t\t\t</cq-scroll>\r\n\r\n                    </cq-menu-dropdown>\r\n                </cq-menu>\r\n                \x3c!--<cq-menu class="ciq-menu stx-markers collapse">\r\n                    <span>Events</span>\r\n                    <cq-menu-dropdown class="ui-widget-content">\r\n                        <cq-item class="square">\r\n                            Simple Square <span class="ciq-radio"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-item class="circle">\r\n                            Simple Circle <span class="ciq-radio"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-item class="callouts">\r\n                            Callouts <span class="ciq-radio"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-item class="abstract">\r\n                            Abstract <span class="ciq-radio"><span></span></span>\r\n                        </cq-item>\r\n                        <cq-item class="none">\r\n                            None <span class="ciq-radio ciq-active"><span></span></span>\r\n                        </cq-item>\r\n                    </cq-menu-dropdown>\r\n                </cq-menu>--\x3e\r\n            </div>\r\n            <div class="ciq-toggles">\r\n                <cq-toggle class="ciq-CH" cq-member="crosshair"><span></span><cq-tooltip>Crosshair</cq-tooltip></cq-toggle>\r\n                <cq-toggle class="ciq-HU" cq-member="headsUp" cq-toggles="dynamic,static,null"><span></span><cq-tooltip>Info</cq-tooltip></cq-toggle>\r\n                <cq-toggle class="ciq-draw"><span></span><cq-tooltip>Draw</cq-tooltip></cq-toggle>\r\n\r\n                \x3c!-- comment in the following line if you are using the TFC plug in --\x3e\r\n                \x3c!-- <cq-toggle class="sidebar stx-trade"><span></span><cq-tooltip>Trade</cq-tooltip></cq-toggle> --\x3e\r\n                \x3c!-- comment in the following line if you are using the tradingcentral plug in --\x3e\r\n                \x3c!-- <cq-toggle class="stx-tradingcentral"><span></span><cq-tooltip>Analysis</cq-tooltip></cq-toggle> --\x3e\r\n\r\n            </div>\r\n        </div>\r\n    </div>\r\n    \x3c!-- End Navbar --\x3e\r\n    \x3c!-- comment in the following line if you are using the TFC plug in --\x3e\r\n    \x3c!-- <cq-tfc></cq-tfc> --\x3e\r\n    \x3c!-- comment in the following line if you are using the tradingcentral plug in --\x3e\r\n    \x3c!-- <cq-tradingcentral token="leWp5sKSbV7sENXba2EUXQ==" partner="647" disabled></cq-tradingcentral> --\x3e\r\n    <div class="ciq-chart-area">\r\n        <div class="ciq-license ui-widget-content ui-state-error">\r\n            <i class="fa fa-close close" title="Close"></i>\r\n            <p><i class="fa fa-exclamation-triangle" aria-hidden="true"></i>This is an evaluation version of ChartIQ. An additional licence is required for use in production.</p>\r\n            <p class="contact">Please&nbsp;contact&nbsp;<a href="mailto:sales@kx.com">sales@kx.com</a>.</p>\r\n        </div>\r\n        <div class="ciq-chart">\r\n            <cq-toolbar>\r\n                <cq-menu class="ciq-select">\r\n                    <span cq-current-tool>Select Tool</span>\r\n                    <cq-menu-dropdown>\r\n                        <cq-item stxtap="noTool()">None</cq-item>\r\n                        <cq-item stxtap="clearDrawings()">Clear Drawings</cq-item>\r\n                        <cq-item stxtap="tool(\'measure\')">Measure</cq-item>\r\n                        <cq-separator></cq-separator>\r\n                        <cq-item stxtap="tool(\'annotation\')">Annotation</cq-item>\r\n                        <cq-item stxtap="tool(\'callout\')">Callout</cq-item>\r\n                        <cq-item stxtap="tool(\'channel\')">Channel</cq-item>\r\n                        <cq-item stxtap="tool(\'continuous\')">Continuous</cq-item>\r\n                        <cq-item stxtap="tool(\'crossline\')">Crossline</cq-item>\r\n                        <cq-item stxtap="tool(\'freeform\')">Doodle</cq-item>\r\n                        <cq-item stxtap="tool(\'ellipse\')">Ellipse</cq-item>\r\n                        <cq-item stxtap="tool(\'fibonacci\')">Fibonacci</cq-item>\r\n                        <cq-item stxtap="tool(\'fibarc\')">Fib Arc</cq-item>\r\n                        <cq-item stxtap="tool(\'fibfan\')">Fib Fan</cq-item>\r\n                        <cq-item stxtap="tool(\'fibtimezone\')">Fib Time Zone</cq-item>\r\n                        <cq-item stxtap="tool(\'gannfan\')">Gann Fan</cq-item>\r\n                        <cq-item stxtap="tool(\'gartley\')">Gartley</cq-item>\r\n                        <cq-item stxtap="tool(\'horizontal\')">Horizontal</cq-item>\r\n                        <cq-item stxtap="tool(\'line\')">Line</cq-item>\r\n                        <cq-item stxtap="tool(\'pitchfork\')">Pitchfork</cq-item>\r\n                        <cq-item stxtap="tool(\'quadrant\')">Quadrant Lines</cq-item>\r\n                        <cq-item stxtap="tool(\'ray\')">Ray</cq-item>\r\n                        <cq-item stxtap="tool(\'rectangle\')">Rectangle</cq-item>\r\n                        <cq-item stxtap="tool(\'regression\')">Regression Line</cq-item>\r\n                        <cq-item stxtap="tool(\'segment\')">Segment</cq-item>\r\n                        <cq-item stxtap="tool(\'arrow\')">Shape - Arrow</cq-item>\r\n                        <cq-item stxtap="tool(\'check\')">Shape - Check</cq-item>\r\n                        <cq-item stxtap="tool(\'xcross\')">Shape - Cross</cq-item>\r\n                        <cq-item stxtap="tool(\'focusarrow\')">Shape - Focus</cq-item>\r\n                        <cq-item stxtap="tool(\'heart\')">Shape - Heart</cq-item>\r\n                        <cq-item stxtap="tool(\'star\')">Shape - Star</cq-item>\r\n                        <cq-item stxtap="tool(\'speedarc\')">Speed Resistance Arc</cq-item>\r\n                        <cq-item stxtap="tool(\'speedline\')">Speed Resistance Line</cq-item>\r\n                        <cq-item stxtap="tool(\'timecycle\')">Time Cycle</cq-item>\r\n                        <cq-item stxtap="tool(\'tirone\')">Tirone Levels</cq-item>\r\n                        <cq-item stxtap="tool(\'vertical\')">Vertical</cq-item>\r\n                    </cq-menu-dropdown>\r\n                </cq-menu>\r\n                <cq-toolbar-settings>\r\n                    <cq-fill-color cq-section class="ciq-color" stxbind="getFillColor()" stxtap="pickFillColor()">\r\n                        <span></span>\r\n                    </cq-fill-color>\r\n                    <div>\r\n                        <cq-line-color cq-section class="ciq-color" stxbind="getLineColor()" stxtap="pickLineColor()"><span></span></cq-line-color>\r\n                        <cq-line-style cq-section>\r\n                            <cq-menu class="ciq-select">\r\n                                <span cq-line-style class="ciq-line ciq-selected"></span>\r\n                                <cq-menu-dropdown class="ciq-line-style-menu">\r\n                                    <cq-item stxtap="setLine(1,\'solid\')"><span class="ciq-line-style-option ciq-solid-1"></span></cq-item>\r\n                                    <cq-item stxtap="setLine(3,\'solid\')"><span class="ciq-line-style-option ciq-solid-3"></span></cq-item>\r\n                                    <cq-item stxtap="setLine(5,\'solid\')"><span class="ciq-line-style-option ciq-solid-5"></span></cq-item>\r\n                                    <cq-item stxtap="setLine(1,\'dotted\')"><span class="ciq-line-style-option ciq-dotted-1"></span></cq-item>\r\n                                    <cq-item stxtap="setLine(3,\'dotted\')"><span class="ciq-line-style-option ciq-dotted-3"></span></cq-item>\r\n                                    <cq-item stxtap="setLine(5,\'dotted\')"><span class="ciq-line-style-option ciq-dotted-5"></span></cq-item>\r\n                                    <cq-item stxtap="setLine(1,\'dashed\')"><span class="ciq-line-style-option ciq-dashed-1"></span></cq-item>\r\n                                    <cq-item stxtap="setLine(3,\'dashed\')"><span class="ciq-line-style-option ciq-dashed-3"></span></cq-item>\r\n                                    <cq-item stxtap="setLine(5,\'dashed\')"><span class="ciq-line-style-option ciq-dashed-5"></span></cq-item>\r\n                                    <cq-item stxtap="setLine(0,\'none\')" class="ciq-none">None</cq-item>\r\n                                </cq-menu-dropdown>\r\n                            </cq-menu>\r\n                        </cq-line-style>\r\n                    </div>\r\n                    <cq-axis-label cq-section>\r\n                        <div class="ciq-heading">Axis Label:</div>\r\n                        <span stxtap="toggleAxisLabel()" class="ciq-checkbox ciq-active"><span></span></span>\r\n                    </cq-axis-label>\r\n                    <cq-annotation cq-section>\r\n                        <div stxtap="toggleFontStyle(\'italic\')" class="ciq-btn" style="font-style:italic;">I</div>\r\n                        <div stxtap="toggleFontStyle(\'bold\')" class="ciq-btn" style="font-weight:bold;">B</div>\r\n                        <cq-menu class="ciq-select">\r\n                            <span cq-font-size>12px</span>\r\n                            <cq-menu-dropdown class="ciq-font-size">\r\n                                <cq-item stxtap="setFontSize(\'8px\')">8</cq-item>\r\n                                <cq-item stxtap="setFontSize(\'10px\')">10</cq-item>\r\n                                <cq-item stxtap="setFontSize(\'12px\')">12</cq-item>\r\n                                <cq-item stxtap="setFontSize(\'13px\')">13</cq-item>\r\n                                <cq-item stxtap="setFontSize(\'14px\')">14</cq-item>\r\n                                <cq-item stxtap="setFontSize(\'16px\')">16</cq-item>\r\n                                <cq-item stxtap="setFontSize(\'20px\')">20</cq-item>\r\n                                <cq-item stxtap="setFontSize(\'28px\')">28</cq-item>\r\n                                <cq-item stxtap="setFontSize(\'36px\')">36</cq-item>\r\n                                <cq-item stxtap="setFontSize(\'48px\')">48</cq-item>\r\n                                <cq-item stxtap="setFontSize(\'64px\')">64</cq-item>\r\n                            </cq-menu-dropdown>\r\n                        </cq-menu>\r\n                        <cq-menu class="ciq-select">\r\n                            <span cq-font-family>Default</span>\r\n                            <cq-menu-dropdown class="ciq-font-family">\r\n                                <cq-item stxtap="setFontFamily(\'Default\')">Default</cq-item>\r\n                                <cq-item stxtap="setFontFamily(\'Helvetica\')">Helvetica</cq-item>\r\n                                <cq-item stxtap="setFontFamily(\'Courier\')">Courier</cq-item>\r\n                                <cq-item stxtap="setFontFamily(\'Garamond\')">Garamond</cq-item>\r\n                                <cq-item stxtap="setFontFamily(\'Palatino\')">Palatino</cq-item>\r\n                                <cq-item stxtap="setFontFamily(\'Times New Roman\')">Times New Roman</cq-item>\r\n                            </cq-menu-dropdown>\r\n                        </cq-menu>\r\n                    </cq-annotation>\r\n                </cq-toolbar-settings>\r\n                <cq-measure><span class="measureUnlit" id="mMeasure"></span></cq-measure>\r\n                <cq-undo-section>\r\n                    <cq-undo class="ciq-btn">Undo</cq-undo>\r\n                    <cq-redo class="ciq-btn">Redo</cq-redo>\r\n                </cq-undo-section>\r\n            </cq-toolbar>\r\n            <div class="chart-container">\r\n\r\n                <stx-hu-tooltip class="ui-widget-content">\r\n                    \x3c!--<stx-hu-tooltip-field field="DT">\r\n                        <stx-hu-tooltip-field-name>Date/Time:</stx-hu-tooltip-field-name>\r\n                        <stx-hu-tooltip-field-value></stx-hu-tooltip-field-value>\r\n                    </stx-hu-tooltip-field>\r\n                    <stx-hu-tooltip-field field="Close">\r\n                        <stx-hu-tooltip-field-name></stx-hu-tooltip-field-name>\r\n                        <stx-hu-tooltip-field-value></stx-hu-tooltip-field-value>\r\n                    </stx-hu-tooltip-field>--\x3e\r\n                </stx-hu-tooltip>\r\n\r\n                <cq-chart-title cq-marker>\r\n                    <cq-symbol-description></cq-symbol-description>\r\n                    \x3c!--<cq-symbol></cq-symbol>--\x3e\r\n                    \x3c!--<cq-chart-price>\r\n                        <cq-current-price cq-animate></cq-current-price>\r\n                        <cq-change>\r\n                            <div class="ico"></div>\r\n                            <cq-todays-change></cq-todays-change> (\r\n                            <cq-todays-change-pct></cq-todays-change-pct>)\r\n                        </cq-change>\r\n                    </cq-chart-price>--\x3e\r\n                </cq-chart-title>\r\n                \r\n                \x3c!--- \tHere is an example of how to create a study legend on the chart.\r\n                        We use the cq-marker attribute to ensure that it floats inside the chart.\r\n                        We set the optional cq-panel-only attribute so that only studies from\r\n                        this panel are displayed.\r\n                        -- Comment out if a legend on the chart window is not desired --\r\n                --\x3e\r\n                <cq-study-legend cq-marker-label="Studies" cq-overlays-only cq-marker cq-hovershow>\r\n                    <template>\r\n                        <cq-item>\r\n                            <cq-label></cq-label>\r\n                            <span class="ciq-edit"></span>\r\n                            <div class="ciq-icon ciq-close"></div>\r\n                        </cq-item>\r\n                    </template>\r\n                </cq-study-legend>\r\n                <cq-loader></cq-loader>\r\n                <cq-hu-static>\r\n                    <div>\r\n                        <cq-hu-price></cq-hu-price>\r\n                        <cq-hu-open></cq-hu-open>\r\n                        <cq-hu-close></cq-hu-close>\r\n                        <cq-volume-section>\r\n                            <cq-hu-volume></cq-hu-volume>\r\n                            <cq-volume-rollup></cq-volume-rollup>\r\n                        </cq-volume-section>\r\n                        <cq-hu-high></cq-hu-high>\r\n                        <cq-hu-low></cq-hu-low>\r\n                    </div>\r\n                </cq-hu-static>\r\n\r\n            </div>\r\n            \x3c!-- End Chart Container --\x3e\r\n        </div>\r\n        \x3c!-- End Chart Box --\x3e\r\n    </div>\r\n\r\n    \x3c!-- End Chart Area --\x3e\r\n    \x3c!-- Markers/Events --\x3e\r\n    <div class="stx-marker-templates" style="display:none">\r\n        \x3c!-- Callout Markers --\x3e\r\n        <div class="callouts">\r\n            <div class="stx-marker callout" style="left:0px; bottom:60px;">\r\n                <div class="stx-stem"></div>\r\n                <div class="stx-marker-content">\r\n                    <h4>This is a callout marker</h4>\r\n                    <div class="stx-marker-expand">\r\n                        <p>Like all ChartIQ markers, the object itself is managed by the chart, so when you scroll the chart the object moves with you. It is also destroyed automatically for you when the symbol is changed.</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="stx-marker callout" style="left:200px; bottom:60px;">\r\n                <div class="stx-stem"></div>\r\n                <div class="stx-marker-content">\r\n                    <h4>This is a callout marker</h4>\r\n                    <div class="stx-marker-expand">\r\n                        <p>Like all ChartIQ markers, the object itself is managed by the chart, so when you scroll the chart the object moves with you. It is also destroyed automatically for you when the symbol is changed.</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n            <div class="stx-marker callout" style="left:400px; bottom:60px;">\r\n                <div class="stx-stem"></div>\r\n                <div class="stx-marker-content">\r\n                    <h4>This is a callout marker</h4>\r\n                    <div class="stx-marker-expand">\r\n                        <p>Like all ChartIQ markers, the object itself is managed by the chart, so when you scroll the chart the object moves with you. It is also destroyed automatically for you when the symbol is changed.</p>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n        \x3c!-- Abstract Markers. You can remove this unless you actually need a helicopter. Seriously though, markers can be anything you want them to be! --\x3e\r\n        <div class="abstract">\r\n            <div class="stx-marker abstract">\r\n                <div class="stx-marker-content">\r\n                    <style>\r\n                        .stx-marker.abstract {\r\n                            width: 0;\r\n                            transition: all .2s;\r\n                        }\r\n\r\n                        .stx-marker-content .sample {\r\n                            position: absolute;\r\n                            bottom: 0;\r\n                            margin-left: -67px;\r\n                            width: 135px;\r\n                            height: 135px;\r\n                            background: rgba(255, 255, 255, .1);\r\n                            text-align: left;\r\n                            border-radius: 50%;\r\n                            -webkit-transition: width 0.2s 0s, height 0.2s 0s, border-radius 0.2s 0s, margin 0.2s 0s, background 0.5s;\r\n                            transition: width 0.2s 0s, height 0.2s 0s, border-radius 0.2s 0s, margin 0.2s 0s, background 0.5s;\r\n                        }\r\n\r\n                        .sample:hover {\r\n                            width: 250px;\r\n                            margin-left: -125px;\r\n                            border-radius: 5px;\r\n                            background: #fff;\r\n                            -webkit-transition: width 0.2s .5s, height 0.2s .5s, border-radius 0.2s .5s, margin 0.2s .5s, background 1s;\r\n                            transition: width 0.2s .5s, height 0.2s .5s, border-radius 0.2s .5s, margin 0.2s .5s, background 1s;\r\n                        }\r\n\r\n                        .sample .text {\r\n                            position: absolute;\r\n                            font-size: 11px;\r\n                            left: 160px;\r\n                            width: 80px;\r\n                            bottom: 13px;\r\n                            opacity: 0;\r\n                            line-height: 13px;\r\n                            -webkit-transition: opacity 0s 0s;\r\n                            -moz-transition: opacity 0s 0s;\r\n                            transition: opacity 0s 0s;\r\n                        }\r\n\r\n                        .sample:hover .text {\r\n                            opacity: 1;\r\n                            -webkit-transition: opacity 0.4s .7s;\r\n                            -moz-transition: opacity 0.4s .7s;\r\n                            transition: opacity 0.4s .7s;\r\n                        }\r\n\r\n                        #stage {\r\n                            position: absolute;\r\n                            left: 10px;\r\n                            bottom: 10px;\r\n                            width: 115px;\r\n                            height: 115px;\r\n                            background: #e8e8e8;\r\n                            border-radius: 50%;\r\n                            -webkit-transition: width 0.2s 0s, height 0.2s 0s, border-radius 0.2s 0s, margin 0.2s 0s, background 0.2s;\r\n                            transition: width 0.2s 0s, height 0.2s 0s, border-radius 0.2s 0s, margin 0.2s 0s, background 0.2s;\r\n                        }\r\n\r\n                        .sample:hover #stage {\r\n                            width: 135px;\r\n                            border-radius: 5px;\r\n                            background: #e8e8e8;\r\n                            -webkit-transition: width 0.2s .5s, height 0.2s .5s, border-radius 0.2s .5s, margin 0.2s .5s, background 0.2s;\r\n                            transition: width 0.2s .5s, height 0.2s .5s, border-radius 0.2s .5s, margin 0.2s .5s, background 0.2s;\r\n                        }\r\n\r\n                        @-webkit-keyframes heli-hover {\r\n                            0% {\r\n                                -webkit-transform: rotate(0deg) translateY(0px);\r\n                            }\r\n\r\n                            35% {\r\n                                -webkit-transform: rotate(6deg) translateY(-70px);\r\n                            }\r\n\r\n                            80% {\r\n                                -webkit-transform: rotate(-4deg) translateY(0px);\r\n                            }\r\n\r\n                            100% {\r\n                                -webkit-transform: translateY(0px);\r\n                            }\r\n                        }\r\n\r\n                        @keyframes heli-hover {\r\n                            0% {\r\n                                transform: rotate(0deg) translateY(0px);\r\n                            }\r\n\r\n                            35% {\r\n                                transform: rotate(6deg) translateY(-70px);\r\n                            }\r\n\r\n                            80% {\r\n                                transform: rotate(-4deg) translateY(0px);\r\n                            }\r\n\r\n                            100% {\r\n                                transform: translateY(0px);\r\n                            }\r\n                        }\r\n\r\n                        #helicopter {\r\n                            position: absolute;\r\n                            margin-left: -5px;\r\n                            margin-bottom: 5px;\r\n                            left: -10px;\r\n                            bottom: 15px;\r\n                            width: 145px;\r\n                            height: 55px;\r\n                            -webkit-transition: margin 0.75s;\r\n                            transition: margin 0.75s;\r\n                        }\r\n\r\n                        .sample:hover #helicopter {\r\n                            margin-left: 0px;\r\n                            margin-bottom: 0;\r\n                            -webkit-animation: heli-hover 6s ease-in-out infinite;\r\n                            /* Chrome, Safari, Opera */\r\n                            animation: heli-hover 6s ease-in-out infinite;\r\n                            /* Standard syntax */\r\n                        }\r\n\r\n                        #propeller {\r\n                            position: absolute;\r\n                            top: 2px;\r\n                            left: 30px;\r\n                            width: 0px;\r\n                            perspective: 500px;\r\n                            -webkit-perspective: 500px;\r\n                            z-index: 1;\r\n                        }\r\n\r\n                        @keyframes spinner {\r\n                            from {\r\n                                transform: rotateY(0deg);\r\n                            }\r\n\r\n                            to {\r\n                                transform: rotateY(-360deg);\r\n                            }\r\n                        }\r\n\r\n                        @-webkit-keyframes spinner {\r\n                            from {\r\n                                -webkit-transform: rotateY(0deg);\r\n                            }\r\n\r\n                            to {\r\n                                -webkit-transform: rotateY(-360deg);\r\n                            }\r\n                        }\r\n\r\n                        #spinner {\r\n                            -webkit-animation: spinner 1s linear infinite;\r\n                            /* Chrome, Safari, Opera */\r\n                            animation: spinner 1s linear infinite;\r\n                            /* Standard syntax */\r\n                            -webkit-transform-style: preserve-3d;\r\n                            transform-style: preserve-3d;\r\n                        }\r\n\r\n                            #spinner div {\r\n                                position: absolute;\r\n                                background: #999;\r\n                                width: 80px;\r\n                                height: 4px;\r\n                            }\r\n\r\n                        #heli-body {\r\n                            position: absolute;\r\n                            left: 0;\r\n                            width: 145px;\r\n                            height: 55px;\r\n                            position: absolute;\r\n                            background: url(css/img/helicopter.png) no-repeat center;\r\n                            z-index: 2;\r\n                        }\r\n                    </style>\r\n                    <div class="sample">\r\n                        <div id="stage">\r\n                            <div id="helicopter">\r\n                                <div id="propeller" style="height: 160px;">\r\n                                    <div id="spinner" style="-webkit-transform-origin: 40px 0 0; transform-origin: 40px 0 0;">\r\n                                        <div style="-webkit-transform: rotateY(0deg) translateX(40px); transform: rotateY(0deg) translateX(40px);"></div>\r\n                                        <div style="-webkit-transform: rotateY(-90deg) translateX(40px); transform: rotateY(-90deg) translateX(40px);"></div>\r\n                                        <div style="-webkit-transform: rotateY(-180deg) translateX(40px); transform: rotateY(-180deg) translateX(40px);"></div>\r\n                                        <div style="-webkit-transform: rotateY(-270deg) translateX(40px); transform: rotateY(-270deg) translateX(40px);"></div>\r\n                                    </div>\r\n                                </div>\r\n                                <div id="heli-body"></div>\r\n                            </div>\r\n                        </div>\r\n                        <div class="text"> This is an example of a complex marker which can contain html, video, images, css, and animations. </div>\r\n                    </div>\r\n                </div>\r\n            </div>\r\n        </div>\r\n    </div>\r\n    \x3c!-- End Marker/Events --\x3e\r\n    \x3c!-- Attribution component --\x3e\r\n    <cq-attribution>\r\n        <template>\r\n            <cq-attrib-container>\r\n                <cq-attrib-source></cq-attrib-source>\r\n                <cq-attrib-quote-type></cq-attrib-quote-type>\r\n            </cq-attrib-container>\r\n        </template>\r\n    </cq-attribution>\r\n\r\n    <cq-hu-dynamic>\r\n        <svg version="1.1" xmlns="http://www.w3.org/2000/svg" xmlns:xlink="http://www.w3.org/1999/xlink" x="0px" y="0px" viewBox="0 0 215 140" enable-background="new 0 0 215 140" xml:space="preserve">\r\n        <defs>\r\n        <filter id="ciq-hu-shadow" height="130%">\r\n        <feGaussianBlur in="SourceAlpha" stdDeviation="1" />\r\n\r\n\r\n\r\n        <feOffset dx="0" dy="1" result="offsetblur" />\r\n\r\n\r\n\r\n        <feComponentTransfer>\r\n        <feFuncA type="linear" slope="0.2" />\r\n\r\n\r\n\r\n\t\t\t\t</feComponentTransfer>\r\n        <feMerge>\r\n        <feMergeNode />\r\n\r\n\r\n\r\n        <feMergeNode in="SourceGraphic" />\r\n\r\n\r\n\r\n\t\t\t\t</feMerge>\r\n\t\t\t</filter>\r\n\t\t</defs>\r\n        <polygon class="ciq-hu-bg" fill="#2A51D0" points="198.4,124.4 1,124.4 1,1 214,1 214,137.8" filter="url(#ciq-hu-shadow)" />\r\n\r\n\r\n\r\n        <path class="ciq-hu-stroke" fill="#398DFF" d="M213,2v133.6l-13.7-11.8l-0.6-0.5H198H2V2H213 M215,0H0v125.4h198l17,14.6V0L215,0z" />\r\n\r\n\r\n\r\n\t</svg>\r\n        <div>\r\n            <cq-hu-col1>\r\n                <cq-hu-date></cq-hu-date>\r\n                <cq-hu-price></cq-hu-price>\r\n                <cq-volume-grouping>\r\n                    <div>Volume</div>\r\n                    <div><cq-volume-visual></cq-volume-visual></div>\r\n                    <div><cq-hu-volume></cq-hu-volume><cq-volume-rollup></cq-volume-rollup></div>\r\n                </cq-volume-grouping>\r\n            </cq-hu-col1>\r\n            <cq-hu-col2>\r\n                <cq-hu-open></cq-hu-open>\r\n                <cq-hu-close></cq-hu-close>\r\n                <cq-hu-high></cq-hu-high>\r\n                <cq-hu-low></cq-hu-low>\r\n            </cq-hu-col2>\r\n        </div>\r\n\r\n    </cq-hu-dynamic>\r\n    <cq-dialog cq-views>\r\n        <cq-view-dialog>\r\n            <h4>Save View</h4>\r\n            <div stxtap="close()" class="ciq-icon ciq-close"></div>\r\n            <div style="text-align:center;margin-top:10px;">\r\n                <i>Enter name of view:</i>\r\n                <p>\r\n                    <input spellcheck="false" autocapitalize="off" autocorrect="off" autocomplete="off" maxlength="40" placeholder="Name"><br>\r\n                </p>\r\n                <span class="ciq-btn" stxtap="save()">Save</span>\r\n            </div>\r\n        </cq-view-dialog>\r\n    </cq-dialog>\r\n    <cq-dialog>\r\n        <cq-aggregation-dialog>\r\n            <h4 class="title"></h4>\r\n            <div stxtap="hide()" class="ciq-icon ciq-close"></div>\r\n            <div style="text-align:center;margin-top:10px;">\r\n                <div class="ciqkagi">\r\n                    <i>Enter value and hit "Enter"</i>\r\n                    <p>\r\n                        <input name="kagi" stxtap="Layout.setAggregationEdit(\'kagi\')">\r\n                </div>\r\n                <div class="ciqrenko">\r\n                    <i>Enter value and hit "Enter"</i>\r\n                    <p>\r\n                        <input name="renko" stxtap="Layout.setAggregationEdit(\'renko\')">\r\n                </div>\r\n                <div class="ciqlinebreak">\r\n                    <i>Enter value and hit "Enter"</i>\r\n                    <p>\r\n                        <input name="priceLines" stxtap="Layout.setAggregationEdit(\'priceLines\')">\r\n                </div>\r\n                <div class="ciqrangebars">\r\n                    <i>Enter value and hit "Enter"</i>\r\n                    <p>\r\n                        <input name="range" stxtap="Layout.setAggregationEdit(\'range\')">\r\n                </div>\r\n                <div class="ciqpandf">\r\n                    <i>Enter box size and hit "Enter"</i>\r\n                    <p>\r\n                        <input name="box" stxtap="Layout.setAggregationEdit(\'pandf.box\')">\r\n                    <p>\r\n                        <i>Enter reversal and hit "Enter"</i>\r\n                    <p>\r\n                        <input name="reversal" stxtap="Layout.setAggregationEdit(\'pandf.reversal\')">\r\n                </div>\r\n                <p>or\r\n                <p>\r\n                    <div class="ciq-btn" stxtap="Layout.setAggregationEdit(\'auto\')">Auto Select</div>\r\n            </div>\r\n        </cq-aggregation-dialog>\r\n    </cq-dialog>\r\n\r\n    <cq-dialog>\r\n        <cq-study-context>\r\n            <div stxtap="StudyEdit.edit()">Edit Settings...</div>\r\n            <div stxtap="StudyEdit.remove()">Delete Study</div>\r\n        </cq-study-context>\r\n    </cq-dialog>\r\n    <cq-dialog cq-study-dialog>\r\n        <cq-study-dialog>\r\n            <h4 class="title">Study</h4>\r\n            <cq-scroll cq-no-maximize>\r\n                <cq-study-inputs>\r\n                    <template cq-study-input>\r\n                        <cq-study-input>\r\n                            <div class="ciq-heading"></div>\r\n                            <div class="stx-data">\r\n                                <template cq-menu>\r\n                                    <cq-menu class="ciq-select">\r\n                                        <cq-selected></cq-selected>\r\n                                        <cq-menu-dropdown cq-lift></cq-menu-dropdown>\r\n                                    </cq-menu>\r\n                                </template>\r\n                            </div>\r\n                        </cq-study-input>\r\n                    </template>\r\n                </cq-study-inputs>\r\n                <hr>\r\n                <cq-study-outputs>\r\n                    <template cq-study-output>\r\n                        <cq-study-output>\r\n                            <div class="ciq-heading"></div>\r\n                            <cq-swatch></cq-swatch>\r\n                        </cq-study-output>\r\n                    </template>\r\n                </cq-study-outputs>\r\n                <hr>\r\n                <cq-study-parameters>\r\n                    <template cq-study-parameters>\r\n                        <cq-study-parameter>\r\n                            <div class="ciq-heading"></div>\r\n                            <div class="stx-data"><cq-swatch></cq-swatch></div>\r\n                        </cq-study-parameter>\r\n                    </template>\r\n                </cq-study-parameters>\r\n            </cq-scroll>\r\n            <div class="ciq-dialog-cntrls">\r\n                <div class="ciq-btn" stxtap="close()">Done</div>\r\n            </div>\r\n        </cq-study-dialog>\r\n    </cq-dialog>\r\n    <cq-dialog cq-theme-dialog>\r\n        <cq-theme-dialog>\r\n            <h4 class="title">Create Custom Theme</h4>\r\n            <cq-close></cq-close>\r\n            <cq-scroll cq-no-maximize>\r\n                <cq-section>\r\n                    <cq-placeholder>\r\n                        Candle Color\r\n                        <cq-theme-piece cq-piece="cu"><cq-swatch cq-overrides="Hollow"></cq-swatch></cq-theme-piece>\r\n                        <cq-theme-piece cq-piece="cd"><cq-swatch cq-overrides="Hollow"></cq-swatch></cq-theme-piece>\r\n                    </cq-placeholder>\r\n                    <cq-placeholder>\r\n                        Candle Wick\r\n                        <cq-theme-piece cq-piece="wu"><cq-swatch></cq-swatch></cq-theme-piece>\r\n                        <cq-theme-piece cq-piece="wd"><cq-swatch></cq-swatch></cq-theme-piece>\r\n                    </cq-placeholder>\r\n                    <cq-placeholder>\r\n                        Candle Border\r\n                        <cq-theme-piece cq-piece="bu"><cq-swatch cq-overrides="No Border"></cq-swatch></cq-theme-piece>\r\n                        <cq-theme-piece cq-piece="bd"><cq-swatch cq-overrides="No Border"></cq-swatch></cq-theme-piece>\r\n                    </cq-placeholder>\r\n                    <cq-separator></cq-separator>\r\n                    <cq-placeholder>\r\n                        Line/Bar Chart\r\n                        <cq-theme-piece cq-piece="lc"><cq-swatch></cq-swatch></cq-theme-piece>\r\n                    </cq-placeholder>\r\n                    <cq-separator></cq-separator>\r\n                    <cq-placeholder>\r\n                        Mountain Color\r\n                        <cq-theme-piece cq-piece="mc"><cq-swatch></cq-swatch></cq-theme-piece>\r\n                    </cq-placeholder>\r\n                </cq-section>\r\n                <cq-section>\r\n                    <cq-placeholder>\r\n                        Background\r\n                        <cq-theme-piece cq-piece="bg"><cq-swatch></cq-swatch></cq-theme-piece>\r\n                    </cq-placeholder>\r\n                    <cq-placeholder>\r\n                        Grid Lines\r\n                        <cq-theme-piece cq-piece="gl"><cq-swatch></cq-swatch></cq-theme-piece>\r\n                    </cq-placeholder>\r\n                    <cq-placeholder>\r\n                        Date Dividers\r\n                        <cq-theme-piece cq-piece="dd"><cq-swatch></cq-swatch></cq-theme-piece>\r\n                    </cq-placeholder>\r\n                    <cq-placeholder>\r\n                        Axis Text\r\n                        <cq-theme-piece cq-piece="at"><cq-swatch></cq-swatch></cq-theme-piece>\r\n                    </cq-placeholder>\r\n                </cq-section>\r\n                <cq-action>\r\n                    <input><div stxtap="save()" class="ciq-btn">Save</div>\r\n                </cq-action>\r\n            </cq-scroll>\r\n        </cq-theme-dialog>\r\n    </cq-dialog>\r\n    <cq-dialog cq-timezone-dialog>\r\n        <cq-timezone-dialog>\r\n            <h4 class="title">Choose Timezone</h4>\r\n            <cq-close></cq-close>\r\n\r\n            <p>To set your timezone use the location button below, or scroll through the following list...</p>\r\n            <p id="currentUserTimeZone"></p>\r\n            <div class="detect">\r\n                <div class="ciq-btn" stxtap="removeTimezone()">Use My Current Location</div>\r\n            </div>\r\n            <div id="timezoneDialogWrapper" style="max-height:360px; overflow: auto;">\r\n                <ul>\r\n                    <li id="timezoneTemplate" style="display:none;cursor:pointer;"></li>\r\n                </ul>\r\n            </div>\r\n            <div class="instruct">(Scroll for more options)</div>\r\n        </cq-timezone-dialog>\r\n    </cq-dialog>\r\n    \x3c!--<cq-side-panel></cq-side-panel>--\x3e\r\n</div>'},useData:!0}),n.customCss=e.template({compiler:[7,">= 4.0.0"],main:function(e,t,i,n,r){var s=null!=t?t:e.nullContext||{},a=i.helperMissing,o="function",c=e.escapeExpression;return'<style id="styleChartIQ">\r\n    [data-widgetid="'+c(typeof(e=null!=(e=i.widgetId||(null!=t?t.widgetId:t))?e:a)==o?e.call(s,{name:"widgetId",hash:{},data:r}):e)+'"] .stx_line_chart {\r\n        color: '+c(typeof(e=null!=(e=i.color||(null!=t?t.color:t))?e:a)==o?e.call(s,{name:"color",hash:{},data:r}):e)+" !important;\r\n        width: "+c(typeof(e=null!=(e=i.width||(null!=t?t.width:t))?e:a)==o?e.call(s,{name:"width",hash:{},data:r}):e)+"px !important;\r\n    }\r\n</style>"},useData:!0}),n);function n(){}function o(e){this.cid=_.uniqueId("subscription"),_.extend(this,_.pick(e,c)),this.initialize.apply(this,arguments)}var c=["api","source"];_.extend(o.prototype,a.Events,{initialize:function(e){this.primaryKey="_rowIndex",this.initializeCollection(),this.initializeEvents(),this.layers=[],e.symbolObject&&(this.type=e.symbolObject.type,this.xAxisData=e.symbolObject.xAxisData,this.yAxisData=e.symbolObject.yAxisData),this.api.subscribe(this.source,_.bind(this.onData,this)),this.debouncedOnDataCollectionChanged=_.debounce(this.onDataCollectionChanged,100)},initializeCollection:function(){var t=this,e=a.Collection.extend({modelId:function(e){return e[t.primaryKey]}});this.collection=new e,this.debouncedOnDataCollectionChanged=_.debounce(this.onDataCollectionChanged,100)},initializeEvents:function(){this.listenTo(this.collection,"change remove",this.debouncedOnDataCollectionChanged),this.listenTo(this.collection,"add",this.onDataCollectionAdd),this.listenTo(this.collection,"reset",this.onDataCollectionReset)},addLayer:function(e){this.layers=_.union(this.layers,[e]),this.columns&&this.trigger("columns-change",this.columns)},formatModel:function(e){var t,i;return"OHLC"===this.type?(t=u.convertKDBTemporalToMoment(e.get("Date")),i={Date:u.convertMomentToDatePicker(t),Close:e.get("Close"),High:e.get("High"),Low:e.get("Low"),Open:e.get("Open"),Volume:e.get("Volume")}):(i={Close:e.get(this.yAxisData)},u.isKDBTemporal(e.get(this.xAxisData))?(t=u.convertKDBTemporalToMoment(e.get(this.xAxisData)),i.Date=new Date(t.valueOf())):i.Date=e.get(this.xAxisData)),i},getDataSourceKey:function(e){return!!e&&(e.path||e.id)},getQuotes:function(e){return this.type=e.type,this.xAxisData=e.xAxisData,this.yAxisData=e.yAxisData,"update"!==e.fetch||_.includes(this.pendingLayers,e.layer)?(this.pendingLayers=_.without(this.pendingLayers,e.layer),e=this.moreAvailable,this.moreAvailable=!1,{moreAvailable:e,quotes:this.collection.map(_.bind(this.formatModel,this))}):{moreAvailable:this.moreAvailable,quotes:[]}},onData:function(e,t,i){var n=this;e.primaryKey!==this.primaryKey&&(this.primaryKey=e.primaryKey),t.reset?(e.columns.reset&&(this.columns=e.columns.reset,this.trigger("columns-change",this.columns)),this.collection.reset(t.reset)):_.isArray(e.columns.reset)&&_.isEmpty(e.columns.reset)?this.collection.reset():(this.collection.remove(_.map(t.remove,function(e){return e[n.primaryKey]})),this.collection.add(t.add),this.collection.set(t.change,{remove:!1}),t.change&&1<t.change.length&&this.trigger("data-reset")),this.moreAvailable=!0,this.pendingLayers=_.clone(this.layers),this.pendingCallbacks&&(this.pendingCallbacks.fire({quotes:this.collection.map(_.bind(this.formatModel,this))}),this.pendingCallbacks.empty(),this.pendingCallbacks=null)},onDataCollectionAdd:function(e){this.trigger("append-quote",this.formatModel(e))},onDataCollectionChanged:function(){},onDataCollectionReset:function(){this.trigger("data-reset")},remove:function(){return this.api.unsubscribe(this.source),this.stopListening(),this},removeLayer:function(e){this.layers=_.without(this.layers,e),_.isEmpty(this.layers)&&(this.trigger("empty"),this.remove())}}),o.getDataSourceKey=function(e){return!!e&&(e.path||e.id)};function l(e){this.cid=_.uniqueId("quoteFeed"),_.extend(this,_.pick(e,d)),this.initialize.apply(this,arguments)}var d=["api","getDataSource"];_.extend(l.prototype,a.Events,{initialize:function(){this.layers={},this.dashSubscriptions={},this.pendingCallbacks={}},fetchInitialData:function(e,t,i,n,r){var s=n.symbolObject.layer,s=this.getSubscription(s);s?r(s.getQuotes(_.extend({fetch:"initial"},n.symbolObject))):this.subscribe({symbol:n.symbol,symbolObject:n.symbolObject},r)},fetchPaginationData:function(e,t,i,n,r){var s=n.symbolObject.layer,s=this.getSubscription(s);this.trigger("pagination",t,i),r(s?s.getQuotes(_.extend({fetch:"pagination"},n.symbolObject)):{moreAvailable:!0,quotes:[]})},fetchUpdateData:function(e,t,i,n){var r,s=i.symbolObject.layer,s=this.getSubscription(s);s&&(r=s.getQuotes(_.extend({fetch:"update"},i.symbolObject)))&&n(r)},getSubscription:function(e){return this.layers[e]||null},getValue:function(e,t,i){var n,e=this.getSubscription(e);return e&&(n=e.collection.get(t))?n.get(i):null},remove:function(){return this.stopListening(),this},subscribe:function(e,t){var i,n,r=e.symbolObject.layer,s=this.getDataSource(e.symbolObject.source);s instanceof a.Model&&(i=o.getDataSourceKey(s),n=(n=this.dashSubscriptions[i])||(this.dashSubscriptions[i]=new o({api:this.api,pendingCallbacks:this.pendingCallbacks[r],source:s,symbolObject:e.symbolObject})),this.layers[r]||(this.listenTo(n,"append-quote",function(e){this.trigger("append-quote:"+r,e)}),this.listenTo(n,"columns-change",function(e){this.trigger("columns-change:"+r,e)}),this.listenTo(n,"data-reset",function(){this.trigger("data-reset:"+r)}),this.listenTo(n,"empty",function(){this.stopListening(n),delete this.dashSubscriptions[i]}),n.addLayer(r),this.layers[r]=n),n.pendingCallbacks||(n.pendingCallbacks=$.Callbacks()),n.pendingCallbacks.add(t))},unsubscribe:function(e){var t=e.symbolObject.layer,e=this.getDataSource(e.symbolObject.source);e instanceof a.Model&&(e=o.getDataSourceKey(e),(e=this.dashSubscriptions[e])&&(e.removeLayer(t),delete this.layers[t]))}});var h=a.View.extend({initialize:function(e){var t=this;_.extend(this,_.pick(e,["api","chart","chartEngine","layerId","quoteFeed","widgetId"])),this.hideQueryStatus=this.api.hideQueryStatus,this.showQueryStatus=this.api.showQueryStatus,this.viewModel=new a.DeepModel,this.initializeEvents(),_.defer(function(){t.postInitializeEvents()})},initializeEvents:function(){this.listenTo(this.quoteFeed,"append-quote:"+this.getLayerId(),this.onAppendQuote),this.listenTo(this.quoteFeed,"columns-change:"+this.getLayerId(),this.onColumnsChange),this.listenTo(this.quoteFeed,"data-reset:"+this.getLayerId(),this.onDataReset),this.listenTo(this.viewModel,"change:Data",this.onDataSourceChange),this.listenTo(this.viewModel,"change:Name",this.onNameChange)},postInitializeEvents:function(){this.listenTo(this.viewModel,"change:_Type",this.initializeSeries),this.listenTo(this.viewModel,"change:Color change:Opacity change:Width change:YAxis",this.setRenderer),this.listenTo(this.viewModel,"change:Order",this.setPossibleColumns),this.listenTo(this.viewModel,"change:XAxisData change:YAxisData",this.onAxisDataChanged)},getAxis:function(){var e=this.chart.axes[this.viewModel.get("YAxis")];return e&&"right"===e.position?null:e},getAxisPosition:function(){var e=this.chart.axes[this.viewModel.get("YAxis")];return e?e.position:"right"},getLayerId:function(){return this.layerId},getLayerIndex:function(){return this.viewModel.get("Order")||0},getSymbolObject:function(){return{layer:this.getLayerId(),source:this.model?this.model.path:"",symbol:this.getSymbolName()||this.getLayerId(),type:this.viewModel.get("_Type"),xAxisData:this.viewModel.get("XAxisData"),yAxisData:this.viewModel.get("YAxisData")}},getSymbolName:function(){return this.viewModel.get("Name")},hexToRGBA:function(e,t){var i,n,r;return _.isNull(e)||_.isUndefined(e)?null:e.match(/^#?([0-9A-Fa-f]){3}\s*$|^#?([0-9A-Fa-f]){6}\s*$/)?7===e.length?(i=parseInt(e.substring(1,3),16),n=parseInt(e.substring(3,5),16),r=parseInt(e.substring(5,7),16),_.isNumber(t)?"rgba("+i+", "+n+", "+r+", "+t/100+")":"rgb("+i+", "+n+", "+r+")"):e:(console.log("Invalid HEX value or color name",e),e)},initializeQueryStatusHandler:function(e){this.updateQueryStatus(),this.listenTo(e,"change:queryStatus",this.updateQueryStatus)},initializeSeries:function(){var e=this,t={OHLC:"candle",Line:"line",Bar:"bar"};this.chart.series[this.getLayerId()]&&this.chartEngine.removeSeries(this.getLayerId()),this.viewModel.get("Data")&&("OHLC"===this.viewModel.get("_Type")?(this.chartEngine.layout.chartType=t[this.viewModel.get("_Type")],this.chartEngine.newChart(this.getSymbolObject(),null,null,function(){})):(this.chart.symbol===this.getLayerId()?this.chartEngine.newChart("base",[]):this.chart.symbol,this.chartEngine.addSeries(this.getLayerId(),{display:this.viewModel.get("Name"),shareYAxis:"right"===this.getAxisPosition(),symbolObject:this.getSymbolObject()},function(){e.setRenderer()})))},onAppendQuote:function(e){"OHLC"===this.viewModel.get("_Type")&&this.chartEngine.appendMasterData(e)},onAxisDataChanged:function(){this.initializeSeries()},onColumnsChange:function(e){this.possibleColumns=_.map(e,"id"),this.setPossibleColumns()},onDataReset:function(){this.initializeSeries()},onDataSourceChange:function(){this.model&&this.stopListening(this.model),this.onColumnsChange([]),this.model=this.viewModel.get("Data")||null,this.trigger("new-data-source",this.model),this.initializeSeries(),this.model&&this.initializeQueryStatusHandler(this.model)},onItemSelected:function(i){var n=this,e=this.viewModel.get("SelectedObjectRouting");_.each(e,function(e,t){t="Layers."+n.getLayerIndex()+".SelectedObjectRouting."+t+".ViewstateProperty",e=n.quoteFeed.getValue(n.getLayerId(),i,e.ColumnProperty);u.isKDBTemporal(e)&&(e=u.convertKDBTemporalToMoment(e).toDashString()),n.api.setProperty(t,e)})},onNameChange:function(){this.initializeSeries()},remove:function(){this.chart.series[this.getLayerId()]&&this.chartEngine.removeSeries(this.getLayerId()),a.View.prototype.remove.apply(this)},setPossibleColumns:function(){var e=this;this.possibleColumns&&_.defer(function(){e.api.setProperty("Layers."+e.getLayerIndex()+"._PossibleColumns",e.possibleColumns,{silent:!0})})},setRenderer:function(){var e={name:this.viewModel.get("Name"),color:this.hexToRGBA(this.viewModel.get("Color"),this.viewModel.get("Opacity")),opacity:this.viewModel.get("Opacity"),width:this.viewModel.get("Width"),yAxis:this.getAxis()},t=CIQ.Renderer.Lines;switch(this.viewModel.get("_Type")){case"Bar":t=CIQ.Renderer.Histogram;break;case"Mountain":e.type="mountain"}this.renderer&&(this.renderer.removeAllSeries(),this.chartEngine.removeSeriesRenderer(this.renderer),delete this.renderer),this.renderer=this.chartEngine.setSeriesRenderer(new t({params:e})),this.renderer.attachSeries(this.getLayerId(),{color:e.color,display:this.viewModel.get("Name")}).ready()},updateQueryStatus:function(){this.model.get("queryStatus")?this.showQueryStatus(this.model.get("queryStatus")):this.hideQueryStatus()}}),p=a.View.extend({events:{"click .ciq-license .close":"onLicenceClick"},initialize:function(e){var t=this;_.extend(this,_.pick(e,["api","baseLayer","quoteFeed","viewModel"])),this.debouncedOnAxesChanged=_.debounce(this.onAxesChanged,100),this.render(),this.initializeChart(),this.initializeEvents(),this.initializeUI(),_.defer(function(){t.postInitializeEvents(),t.onAxesChanged()})},initializeEvents:function(){this.listenTo(this.viewModel,"change:Options.DisplayMenu",this.onDisplayMenuChanged)},postInitializeEvents:function(){this.listenTo(this.viewModel,"change:Axes",this.debouncedOnAxesChanged)},checkWidth:function(){768<this.$el.width()&&this.$el.removeClass("break-md break-sm").addClass("break-lg"),this.$el.width()<=768&&this.$el.removeClass("break-lg break-sm").addClass("break-md"),this.$el.width()<=500&&this.$el.removeClass("break-md break-lg").addClass("break-sm")},hideMarkers:function(){CIQ.Marker.removeByLabel(this.chartEngine,"circle"),CIQ.Marker.removeByLabel(this.chartEngine,"square"),CIQ.Marker.removeByLabel(this.chartEngine,"callout")},initializeChart:function(){this.chartEngine=new CIQ.ChartEngine({container:this.$chartContainer[0],allowScroll:!0,allowZoom:!0,layout:{chartType:"line",crosshair:!0},preferences:{currentPriceLine:!0,labels:!1,whitespace:0},xaxisHeight:30,xAxisAsFooter:!0}),this.chartEngine.append("drawXAxis",_.bind(this.onMove,this)),this.chartEngine.callbacks.drawing=_.bind(this.saveDrawings,this),this.chartEngine.callbacks.layout=_.bind(this.saveLayout,this),this.chartEngine.callbacks.tap=_.bind(this.onClick,this),this.chartEngine.attachQuoteFeed(this.quoteFeed,{refreshInterval:1}),this.chart=this.chartEngine.chart,this.chart.axes={},this.chart.legend={x:260,y:10},this.chartEngine.newChart("base",[]),new CIQ.Tooltip({stx:this.chartEngine,ohl:!0,volume:!0,series:!0,studies:!0})},initializeUI:function(){var i=this;this.UIContext=new CIQ.UI.Context(this.chartEngine,this.$el.find("*[cq-context]")),new CIQ.UI.Layout(this.UIContext).timezoneDialog=this.$el.find("cq-dialog[cq-timezone-dialog]");var t=new CIQ.UI.HeadsUp(this.$el.find("cq-hu-dynamic"),this.UIContext,{followMouse:!0,autoStart:!1}),n=new CIQ.UI.HeadsUp(this.$el.find("cq-hu-static"),this.UIContext,{autoStart:!0});this.UIContext.lookupDriver=new CIQ.UI.Lookup.Driver.ChartIQ;new CIQ.UI.KeystrokeHub($("body"),this.UIContext,{cb:CIQ.UI.KeystrokeHub.defaultHotKeys}),new CIQ.UI.StudyEdit(null,this.UIContext),new CIQ.NameValueStore;var e=this.$el.find("cq-side-panel")[0];e&&e.registerCallback(this.onResize),this.$el.find(".ciq-HU")[0].registerCallback(function(e){"static"===e?(t.end(),n.begin(),this.node.addClass("active")):"dynamic"===e?(n.end(),t.begin(),this.node.addClass("active")):(n.end(),t.end(),this.node.removeClass("active"))}),this.$el.find(".ciq-draw")[0].registerCallback(function(e){e?(this.node.addClass("active"),i.$el.addClass("toolbar-on")):(this.node.removeClass("active"),i.$el.removeClass("toolbar-on")),i.setHeight();var t=this.context.stx;t.resizeChart(),e?t.changeVectorType(this.priorVectorType):(this.priorVectorType=t.currentVectorParameters.vectorType,t.changeVectorType(""))}),this.$el.find(".stx-trade")[0]&&this.$el.find(".stx-trade")[0].registerCallback(function(e){var t=i.$el.find("cq-side-panel")[0];e?(t.open({selector:".stx-trade-panel",className:"active"}),this.node.addClass("active"),i.$el.find(".stx-trade-panel").removeClass("closed")):(t.close(),this.node.removeClass("active"),i.$el.find(".stx-trade-panel").addClass("closed"))}),this.$el.find(".stx-tradingcentral")[0]&&this.$el.find(".stx-tradingcentral")[0].registerCallback(function(e){var t=i.$el.find("cq-tradingcentral")[0];e?t.removeAttribute("disabled"):t.setAttribute("disabled","disabled")}),this.$el.find("cq-redo")[0].pairUp(this.$el.find("cq-undo"));this.$el.find("cq-views").each(function(){this.initialize()});var r={excludedStudies:{Directional:!0,Gopala:!0,vchart:!0},alwaysDisplayDialog:{ma:!0}};this.$el.find("cq-studies").each(function(){this.initialize(r)}),this.UIContext.loader&&this.UIContext.loader.show(),_.delay(function(){i.restoreLayout(i.chartEngine,function(){i.UIContext.loader&&i.UIContext.loader.hide()})},2e3),CIQ.UI.begin()},onAxesChanged:function(){var n=this,e=_.map(this.viewModel.get("Axes.Y"),"Name");_.isEmpty(e)||this.api.setProperty("_PossibleAxes",e),this.chart.xAxis.displayGridLines=this.viewModel.get("Axes.X.DisplayGridLines"),_.each(this.viewModel.get("Axes.Y"),function(e,t){var i=0===t?(n.chartEngine.yaxisLabelStyle=e.LabelStyle,n.chart.yAxis):n.chart.axes[e.Name];(i=i||(n.chart.axes[e.Name]=new CIQ.ChartEngine.YAxis)).position=(""+e.Position).toLowerCase(),i.displayGridLines=e.DisplayGridLines,i.decimalPlaces=e.DecimalPlaces,0!==t&&(i.max=e.Max,i.min=e.Min)}),this.chartEngine.draw()},onClick:function(e){var t=this.chartEngine.barFromPixel(e.x),e=this.chartEngine.tickFromPixel(e.x);this.chartEngine.dateFromTick(e),this.chart.xaxis[t];this.trigger("selectedItem",e)},onDisplayMenuChanged:function(){this.$el.toggleClass("menu-on",this.viewModel.get("Options.DisplayMenu")),this.setHeight()},onLicenceClick:function(){var e=this;e.$el.find(".ciq-license").hide(),_.delay(function(){e.$el.find(".ciq-license").fadeIn()},6e4)},onMove:function(e,t){var i=_.first(e.xaxis),e=_.last(e.xaxis);i&&e&&!_.isNaN(i.DT.valueOf())&&!_.isNaN(e.DT.valueOf())&&this.trigger("rangeChanged",i.DT,e.DT)},onResize:function(){var e;this.UIContext&&(this.checkWidth(),this.setHeight(),(e=this.$el.find("cq-side-panel"))&&($(".ciq-chart-area").css({right:e.width()+"px"}),$("cq-tradingcentral").css({"margin-right":e.width()+15+"px"})),this.chartEngine.resizeChart())},remove:function(){this.chartEngine.destroy(),a.View.prototype.remove.call(this)},render:function(){return this.$el.addClass("chartiq-app"),this.$el.html(i.chart()),this.$chartContainer=this.$el.find(".chart-container"),this},restoreDrawings:function(e,t){var i=this.api.getPropertyMeta("Options.Drawings"),i=!i||!i.type&&i.value?this.api.getProperty("Options.Drawings"):this.api.loadSetting("drawing-"+e.chart.symbol);i&&e.importDrawings(JSON.parse(i))},restoreLayout:function(e,t){var i=this,n=this.api.getPropertyMeta("Options.Layout"),n=!n||!n.type&&n.value?this.api.getProperty("Options.Layout"):this.api.loadSetting("layout");n?((n=JSON.parse(n)).symbols=e.getSymbols(),e.importLayout(n,{managePeriodicity:!0,cb:function(){i.restoreDrawings(e,e.chart.symbol),t()}})):t()},saveDrawings:function(e){var t=e.stx.exportDrawings(),i=this.api.getPropertyMeta("Options.Drawings");0<t.length&&(i&&i.type?this.api.saveSetting("drawing-"+e.stx.chart.symbol,JSON.stringify(t)):this.api.setProperty("Options.Drawings",void 0))},saveLayout:function(e){var t=JSON.stringify(e.stx.exportLayout(!0)),e=this.api.getPropertyMeta("Options.Layout");t&&(e&&e.type?this.api.saveSetting("layout",t):this.api.setProperty("Options.Layout",t))},setHeight:function(){var e=this.$el.height();this.$el.hasClass("toolbar-on")?this.$chartContainer.css("height",this.$el.find(".ciq-chart").height()-45+"px"):this.$chartContainer.css("height",this.$el.find(".ciq-chart").height()+"px"),$("#maxHeightCSS").remove(),$("head").append('<style id="maxHeightCSS">cq-dialog { max-height: '+e+"px }</style>")},showMarkers:function(){this.hideMarkers();this.chartEngine.masterData.length;for(var e=this.chartEngine.masterData,t=0;t<e.length;t++){var i=e[t];i.story="Like all ChartIQ markers, the object itself is managed by the chart, so when you scroll the chart the object moves with you. It is also destroyed automatically for you when the symbol is changed.";i={stx:this.chartEngine,xPositioner:"master",x:i.x,label:"events",node:new CIQ.Marker.Simple(i)},new CIQ.Marker(i)}this.chartEngine.draw()}},{getComponentDefinition:s.getComponentDefinition}),u=t.Tools;return a.View.extend({initialize:function(e){_.extend(this,_.pick(e,["api","settingsModel","widgetId"])),this.layerRegex=/Layers\.(\d+)\.(.+)/,this.dataSourceMap={},this.layers={},this.viewModel=new a.DeepModel,this.$el.addClass("chartiq-app"),this.quoteFeed=new l({api:this.api,getDataSource:_.bind(this.getDataSource,this)}),require(["json!version.json"],_.bind(this.initializeRequire,this),_.bind(this.initializeRequire,this))},initializeEvents:function(){this.listenTo(this.chartView,"rangeChanged",_.throttle(this.onRangeChanged,2e3)),this.listenTo(this.chartView,"selectedItem",this.onItemSelected),this.listenTo(this.quoteFeed,"pagination",this.onPagination)},initializeRequire:function(e){e=e.ChartIQ||"ChartIQ";require.config({paths:{addOns:e+"/lib/chartiq/js/addOns",chartiq:e+"/lib/chartiq/js/chartiq",components:e+"/lib/chartiq/js/components",componentUI:e+"/lib/chartiq/js/componentUI","object-observe":e+"/lib/chartiq/js/thirdparty/object-observe","custom-elements":e+"/lib/chartiq/js/thirdparty/@webcomponents/custom-elements.min"}}),require(["chartiq","components","componentUI","addOns"],_.bind(this.onChartIQLoaded,this))},addLayer:function(e){this.layers[e]=new h({api:this.api,chart:this.chartView.chart,chartEngine:this.chartView.chartEngine,layerId:e,quoteFeed:this.quoteFeed,widgetId:this.widgetId}),this.listenTo(this.layers[e],"new-data-source",this.onNewDataSource)},findLayerByIndex:function(i){return _.find(this.layers,function(e,t){return e.viewModel.get("Order")===i})},getDataSource:function(e){return this.dataSourceMap[e]||null},onChartIQLoaded:function(e){window.CIQ=e.CIQ,this.chartView=new p({el:this.$el,api:this.api,quoteFeed:this.quoteFeed,viewModel:this.viewModel}),this.initializeEvents(),_.each(this.pendingSettings,_.bind(this.onSettingsChange,this)),delete this.pendingSettings},onItemSelected:function(i){_.each(this.layers,function(e,t){e.onItemSelected(i)})},onNewDataSource:function(e){e&&e.path&&(this.dataSourceMap[e.path]=e)},onPagination:function(e,t){e&&t&&(this.api.setProperty("Axes.X.DataStart",u.convertValueToMoment(e).toDashString()),this.api.setProperty("Axes.X.DataEnd",u.convertValueToMoment(t).toDashString()))},onRangeChanged:function(e,t){e&&t&&(this.api.setProperty("Axes.X.RangeMin",u.convertValueToMoment(e).toDashString()),this.api.setProperty("Axes.X.RangeMax",u.convertValueToMoment(t).toDashString()))},onResize:function(){this.chartView&&_.isFunction(this.chartView.onResize)&&this.chartView.onResize()},onSettingsChange:function(e){var s=this,a=[];if(!this.chartView)return this.pendingSettings||(this.pendingSettings=[]),void this.pendingSettings.push(e);_.each(e,_.bind(function(e,t){var i,n,r=this.layerRegex.exec(t);"Layers"===t&&_.isArray(e)?(a=_.keys(this.layers),_.each(e,_.bind(function(e,t){i=e._LayerId,e.Order=t,i||(i=_.uniqueId("layer_"),_.defer(function(){s.api.setProperty("Layers."+t+"._LayerId",i)})),this.layers[i]||this.addLayer(i),this.layers[i].viewModel.set(e),a=_.without(a,i)},this))):r?(n=Number(r[1]),r=r[2],(n=this.findLayerByIndex(n))&&n.viewModel.set(r,e)):this.viewModel.set(t,e)},this)),_.each(a,_.bind(function(e){this.layers[e]&&(this.layers[e].remove(),delete this.layers[e])},this))},updateErrorMessage:function(){this.model.get("error")?this.showErrorMessage(this.model.get("error")):this.hideErrorMessage()}},{getComponentDefinition:s.getComponentDefinition})});
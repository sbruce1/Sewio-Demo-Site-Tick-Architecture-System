define(["jquery","d3","Handlebars","QuickBase","backbone","css!./css/app.css"],function(e,a,b,r,v){"use strict";var o,n=this&&this.__extends||(o=function(t,e){return(o=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var a in e)e.hasOwnProperty(a)&&(t[a]=e[a])})(t,e)},function(t,e){function a(){this.constructor=t}o(t,e),t.prototype=null===e?Object.create(e):(a.prototype=e.prototype,new a)}),x=(i.app=b.template({compiler:[7,">= 4.0.0"],main:function(t,e,a,o,n){return'<div class="ContextMenu">\r\n\r\n    <div class="title">\r\n    </div>\r\n\r\n    <div class="frame">\r\n    </div>\r\n</div>'},useData:!0}),i.button=b.template({compiler:[7,">= 4.0.0"],main:function(t,e,a,o,n){var r=null!=e?e:t.nullContext||{},i=a.helperMissing,l="function",s=t.escapeExpression;return'<div data="'+s(typeof(t=null!=(t=a.text||(null!=e?e.text:e))?t:i)==l?t.call(r,{name:"text",hash:{},data:n}):t)+'" model="'+s(typeof(t=null!=(t=a.model||(null!=e?e.model:e))?t:i)==l?t.call(r,{name:"model",hash:{},data:n}):t)+'"\r\n    style="background: '+s(typeof(t=null!=(t=a.bgColor||(null!=e?e.bgColor:e))?t:i)==l?t.call(r,{name:"bgColor",hash:{},data:n}):t)+";border: "+s(typeof(t=null!=(t=a.border||(null!=e?e.border:e))?t:i)==l?t.call(r,{name:"border",hash:{},data:n}):t)+"px solid "+s(typeof(t=null!=(t=a.borderColor||(null!=e?e.borderColor:e))?t:i)==l?t.call(r,{name:"borderColor",hash:{},data:n}):t)+"; border-radius: "+s(typeof(t=null!=(t=a.rounding||(null!=e?e.rounding:e))?t:i)==l?t.call(r,{name:"rounding",hash:{},data:n}):t)+"px; width: "+s(typeof(t=null!=(t=a.width||(null!=e?e.width:e))?t:i)==l?t.call(r,{name:"width",hash:{},data:n}):t)+"; height: "+s(typeof(t=null!=(t=a.height||(null!=e?e.height:e))?t:i)==l?t.call(r,{name:"height",hash:{},data:n}):t)+"; display: inline-block; padding: "+s(typeof(t=null!=(t=a.padding||(null!=e?e.padding:e))?t:i)==l?t.call(r,{name:"padding",hash:{},data:n}):t)+"px; margin: "+s(typeof(t=null!=(t=a.margin||(null!=e?e.margin:e))?t:i)==l?t.call(r,{name:"margin",hash:{},data:n}):t)+'px;">\r\n    <div style="height: 100%; text-align: '+s(typeof(t=null!=(t=a.position||(null!=e?e.position:e))?t:i)==l?t.call(r,{name:"position",hash:{},data:n}):t)+'">\r\n        <div style="height: '+s(typeof(t=null!=(t=a.imgPercent||(null!=e?e.imgPercent:e))?t:i)==l?t.call(r,{name:"imgPercent",hash:{},data:n}):t)+"%; vertical-align: "+s(typeof(t=null!=(t=a.valign||(null!=e?e.valign:e))?t:i)==l?t.call(r,{name:"valign",hash:{},data:n}):t)+'">\r\n            <div class="'+s(typeof(t=null!=(t=a.icontype||(null!=e?e.icontype:e))?t:i)==l?t.call(r,{name:"icontype",hash:{},data:n}):t)+" "+s(typeof(t=null!=(t=a.svg||(null!=e?e.svg:e))?t:i)==l?t.call(r,{name:"svg",hash:{},data:n}):t)+'" style="font-size: '+s(typeof(t=null!=(t=a.shapeSize||(null!=e?e.shapeSize:e))?t:i)==l?t.call(r,{name:"shapeSize",hash:{},data:n}):t)+"px; color: "+s(typeof(t=null!=(t=a.shapeColor||(null!=e?e.shapeColor:e))?t:i)==l?t.call(r,{name:"shapeColor",hash:{},data:n}):t)+"; margin: "+s(typeof(t=null!=(t=a.iconMargin||(null!=e?e.iconMargin:e))?t:i)==l?t.call(r,{name:"iconMargin",hash:{},data:n}):t)+'px;"></div>\r\n        </div>\r\n        <div style="color: '+s(typeof(t=null!=(t=a.textColor||(null!=e?e.textColor:e))?t:i)==l?t.call(r,{name:"textColor",hash:{},data:n}):t)+"; height: "+s(typeof(t=null!=(t=a.textPercent||(null!=e?e.textPercent:e))?t:i)==l?t.call(r,{name:"textPercent",hash:{},data:n}):t)+'%;">\r\n            <span class="span-header">&nbsp;'+s(typeof(t=null!=(t=a.text||(null!=e?e.text:e))?t:i)==l?t.call(r,{name:"text",hash:{},data:n}):t)+' </span>\r\n            <br />\r\n            <span class="span-body">&nbsp;'+s(typeof(t=null!=(t=a.textContent||(null!=e?e.textContent:e))?t:i)==l?t.call(r,{name:"textContent",hash:{},data:n}):t)+'</span>\r\n        </div>\r\n    </div>\r\n    <div class="tooltip" data="'+s(typeof(t=null!=(t=a.info||(null!=e?e.info:e))?t:i)==l?t.call(r,{name:"info",hash:{},data:n}):t)+'"></div>\r\n</div>'},useData:!0}),i.buttonEW=b.template({compiler:[7,">= 4.0.0"],main:function(t,e,a,o,n){var r=null!=e?e:t.nullContext||{},i=a.helperMissing,l="function",s=t.escapeExpression;return'<div data="'+s(typeof(t=null!=(t=a.text||(null!=e?e.text:e))?t:i)==l?t.call(r,{name:"text",hash:{},data:n}):t)+'" model="'+s(typeof(t=null!=(t=a.model||(null!=e?e.model:e))?t:i)==l?t.call(r,{name:"model",hash:{},data:n}):t)+'"\r\n    style="background: '+s(typeof(t=null!=(t=a.bgColor||(null!=e?e.bgColor:e))?t:i)==l?t.call(r,{name:"bgColor",hash:{},data:n}):t)+"; border: "+s(typeof(t=null!=(t=a.border||(null!=e?e.border:e))?t:i)==l?t.call(r,{name:"border",hash:{},data:n}):t)+"px solid "+s(typeof(t=null!=(t=a.borderColor||(null!=e?e.borderColor:e))?t:i)==l?t.call(r,{name:"borderColor",hash:{},data:n}):t)+"; border-radius: "+s(typeof(t=null!=(t=a.rounding||(null!=e?e.rounding:e))?t:i)==l?t.call(r,{name:"rounding",hash:{},data:n}):t)+"px; width: "+s(typeof(t=null!=(t=a.width||(null!=e?e.width:e))?t:i)==l?t.call(r,{name:"width",hash:{},data:n}):t)+"; height: "+s(typeof(t=null!=(t=a.height||(null!=e?e.height:e))?t:i)==l?t.call(r,{name:"height",hash:{},data:n}):t)+"; display: inline-block; padding: "+s(typeof(t=null!=(t=a.padding||(null!=e?e.padding:e))?t:i)==l?t.call(r,{name:"padding",hash:{},data:n}):t)+"px; margin:"+s(typeof(t=null!=(t=a.margin||(null!=e?e.margin:e))?t:i)==l?t.call(r,{name:"margin",hash:{},data:n}):t)+'px;">\r\n    <div style="height: 100%; text-align: '+s(typeof(t=null!=(t=a.position||(null!=e?e.position:e))?t:i)==l?t.call(r,{name:"position",hash:{},data:n}):t)+'">\r\n        <div style="display: inline-block; vertical-align: '+s(typeof(t=null!=(t=a.valign||(null!=e?e.valign:e))?t:i)==l?t.call(r,{name:"valign",hash:{},data:n}):t)+'">\r\n            <div class="'+s(typeof(t=null!=(t=a.icontype||(null!=e?e.icontype:e))?t:i)==l?t.call(r,{name:"icontype",hash:{},data:n}):t)+" "+s(typeof(t=null!=(t=a.svg||(null!=e?e.svg:e))?t:i)==l?t.call(r,{name:"svg",hash:{},data:n}):t)+'" style="font-size: '+s(typeof(t=null!=(t=a.shapeSize||(null!=e?e.shapeSize:e))?t:i)==l?t.call(r,{name:"shapeSize",hash:{},data:n}):t)+"px; color: "+s(typeof(t=null!=(t=a.shapeColor||(null!=e?e.shapeColor:e))?t:i)==l?t.call(r,{name:"shapeColor",hash:{},data:n}):t)+"; margin: "+s(typeof(t=null!=(t=a.iconMargin||(null!=e?e.iconMargin:e))?t:i)==l?t.call(r,{name:"iconMargin",hash:{},data:n}):t)+'px;"></div>\r\n        </div>\r\n        <div style="color: '+s(typeof(t=null!=(t=a.textColor||(null!=e?e.textColor:e))?t:i)==l?t.call(r,{name:"textColor",hash:{},data:n}):t)+"; display: inline-block; width: "+s(typeof(t=null!=(t=a.textPercent||(null!=e?e.textPercent:e))?t:i)==l?t.call(r,{name:"textPercent",hash:{},data:n}):t)+'%;">\r\n            <span class="span-header">&nbsp;'+s(typeof(t=null!=(t=a.text||(null!=e?e.text:e))?t:i)==l?t.call(r,{name:"text",hash:{},data:n}):t)+' </span>\r\n            <br />\r\n            <span class="span-body">&nbsp;'+s(typeof(t=null!=(t=a.textContent||(null!=e?e.textContent:e))?t:i)==l?t.call(r,{name:"textContent",hash:{},data:n}):t)+'</span>\r\n        </div>\r\n    </div>\r\n    <div class="tooltip"></div>\r\n</div>'},useData:!0}),i.buttonSN=b.template({compiler:[7,">= 4.0.0"],main:function(t,e,a,o,n){var r=null!=e?e:t.nullContext||{},i=a.helperMissing,l="function",s=t.escapeExpression;return'<div data="'+s(typeof(t=null!=(t=a.text||(null!=e?e.text:e))?t:i)==l?t.call(r,{name:"text",hash:{},data:n}):t)+'" model="'+s(typeof(t=null!=(t=a.model||(null!=e?e.model:e))?t:i)==l?t.call(r,{name:"model",hash:{},data:n}):t)+'"\r\n    style="background: '+s(typeof(t=null!=(t=a.bgColor||(null!=e?e.bgColor:e))?t:i)==l?t.call(r,{name:"bgColor",hash:{},data:n}):t)+"; border: "+s(typeof(t=null!=(t=a.border||(null!=e?e.border:e))?t:i)==l?t.call(r,{name:"border",hash:{},data:n}):t)+"px solid "+s(typeof(t=null!=(t=a.borderColor||(null!=e?e.borderColor:e))?t:i)==l?t.call(r,{name:"borderColor",hash:{},data:n}):t)+"; border-radius: "+s(typeof(t=null!=(t=a.rounding||(null!=e?e.rounding:e))?t:i)==l?t.call(r,{name:"rounding",hash:{},data:n}):t)+"px; width: "+s(typeof(t=null!=(t=a.width||(null!=e?e.width:e))?t:i)==l?t.call(r,{name:"width",hash:{},data:n}):t)+"; height: "+s(typeof(t=null!=(t=a.height||(null!=e?e.height:e))?t:i)==l?t.call(r,{name:"height",hash:{},data:n}):t)+"; display: inline-block; padding: "+s(typeof(t=null!=(t=a.padding||(null!=e?e.padding:e))?t:i)==l?t.call(r,{name:"padding",hash:{},data:n}):t)+"px; margin: "+s(typeof(t=null!=(t=a.margin||(null!=e?e.margin:e))?t:i)==l?t.call(r,{name:"margin",hash:{},data:n}):t)+'px">\r\n    <div style="height: 100%; text-align: '+s(typeof(t=null!=(t=a.position||(null!=e?e.position:e))?t:i)==l?t.call(r,{name:"position",hash:{},data:n}):t)+'">\r\n        <div style="color: '+s(typeof(t=null!=(t=a.textColor||(null!=e?e.textColor:e))?t:i)==l?t.call(r,{name:"textColor",hash:{},data:n}):t)+"; height: "+s(typeof(t=null!=(t=a.textPercent||(null!=e?e.textPercent:e))?t:i)==l?t.call(r,{name:"textPercent",hash:{},data:n}):t)+"%; vertical-align: "+s(typeof(t=null!=(t=a.valign||(null!=e?e.valign:e))?t:i)==l?t.call(r,{name:"valign",hash:{},data:n}):t)+'">\r\n            <span class="span-header">&nbsp;'+s(typeof(t=null!=(t=a.text||(null!=e?e.text:e))?t:i)==l?t.call(r,{name:"text",hash:{},data:n}):t)+' </span>\r\n            <br />\r\n            <span class="span-body">&nbsp;'+s(typeof(t=null!=(t=a.textContent||(null!=e?e.textContent:e))?t:i)==l?t.call(r,{name:"textContent",hash:{},data:n}):t)+'</span>\r\n        </div>\r\n        <div style="height: '+s(typeof(t=null!=(t=a.imgPercent||(null!=e?e.imgPercent:e))?t:i)==l?t.call(r,{name:"imgPercent",hash:{},data:n}):t)+'%;">\r\n            <div class="'+s(typeof(t=null!=(t=a.icontype||(null!=e?e.icontype:e))?t:i)==l?t.call(r,{name:"icontype",hash:{},data:n}):t)+" "+s(typeof(t=null!=(t=a.svg||(null!=e?e.svg:e))?t:i)==l?t.call(r,{name:"svg",hash:{},data:n}):t)+'" style="font-size: '+s(typeof(t=null!=(t=a.shapeSize||(null!=e?e.shapeSize:e))?t:i)==l?t.call(r,{name:"shapeSize",hash:{},data:n}):t)+"px; color: "+s(typeof(t=null!=(t=a.shapeColor||(null!=e?e.shapeColor:e))?t:i)==l?t.call(r,{name:"shapeColor",hash:{},data:n}):t)+"; margin: "+s(typeof(t=null!=(t=a.iconMargin||(null!=e?e.iconMargin:e))?t:i)==l?t.call(r,{name:"iconMargin",hash:{},data:n}):t)+'px;"></div>\r\n        </div>\r\n    </div>\r\n    <div class="tooltip" data="'+s(typeof(t=null!=(t=a.info||(null!=e?e.info:e))?t:i)==l?t.call(r,{name:"info",hash:{},data:n}):t)+'"></div>\r\n</div>'},useData:!0}),i.buttonWE=b.template({compiler:[7,">= 4.0.0"],main:function(t,e,a,o,n){var r=null!=e?e:t.nullContext||{},i=a.helperMissing,l="function",s=t.escapeExpression;return'<div data="'+s(typeof(t=null!=(t=a.text||(null!=e?e.text:e))?t:i)==l?t.call(r,{name:"text",hash:{},data:n}):t)+'" model="'+s(typeof(t=null!=(t=a.model||(null!=e?e.model:e))?t:i)==l?t.call(r,{name:"model",hash:{},data:n}):t)+'"\r\n    style="background: '+s(typeof(t=null!=(t=a.bgColor||(null!=e?e.bgColor:e))?t:i)==l?t.call(r,{name:"bgColor",hash:{},data:n}):t)+"; border: "+s(typeof(t=null!=(t=a.border||(null!=e?e.border:e))?t:i)==l?t.call(r,{name:"border",hash:{},data:n}):t)+"px solid "+s(typeof(t=null!=(t=a.borderColor||(null!=e?e.borderColor:e))?t:i)==l?t.call(r,{name:"borderColor",hash:{},data:n}):t)+"; border-radius: "+s(typeof(t=null!=(t=a.rounding||(null!=e?e.rounding:e))?t:i)==l?t.call(r,{name:"rounding",hash:{},data:n}):t)+"px; width: "+s(typeof(t=null!=(t=a.width||(null!=e?e.width:e))?t:i)==l?t.call(r,{name:"width",hash:{},data:n}):t)+"; height: "+s(typeof(t=null!=(t=a.height||(null!=e?e.height:e))?t:i)==l?t.call(r,{name:"height",hash:{},data:n}):t)+"; display: inline-block; padding: "+s(typeof(t=null!=(t=a.padding||(null!=e?e.padding:e))?t:i)==l?t.call(r,{name:"padding",hash:{},data:n}):t)+"px; margin: "+s(typeof(t=null!=(t=a.margin||(null!=e?e.margin:e))?t:i)==l?t.call(r,{name:"margin",hash:{},data:n}):t)+'px;">\r\n\r\n    <div style="height: 100%; text-align: '+s(typeof(t=null!=(t=a.position||(null!=e?e.position:e))?t:i)==l?t.call(r,{name:"position",hash:{},data:n}):t)+'">\r\n        <div style="color: '+s(typeof(t=null!=(t=a.textColor||(null!=e?e.textColor:e))?t:i)==l?t.call(r,{name:"textColor",hash:{},data:n}):t)+"; display: inline-block; vertical-align: "+s(typeof(t=null!=(t=a.valign||(null!=e?e.valign:e))?t:i)==l?t.call(r,{name:"valign",hash:{},data:n}):t)+'">\r\n            <span class="span-header">&nbsp;'+s(typeof(t=null!=(t=a.text||(null!=e?e.text:e))?t:i)==l?t.call(r,{name:"text",hash:{},data:n}):t)+' </span>\r\n            <br />\r\n            <span class="span-body">&nbsp;'+s(typeof(t=null!=(t=a.textContent||(null!=e?e.textContent:e))?t:i)==l?t.call(r,{name:"textContent",hash:{},data:n}):t)+'</span>\r\n        </div>\r\n        <div style="display: inline-block;">\r\n            <div class="'+s(typeof(t=null!=(t=a.icontype||(null!=e?e.icontype:e))?t:i)==l?t.call(r,{name:"icontype",hash:{},data:n}):t)+" "+s(typeof(t=null!=(t=a.svg||(null!=e?e.svg:e))?t:i)==l?t.call(r,{name:"svg",hash:{},data:n}):t)+'" style="font-size: '+s(typeof(t=null!=(t=a.shapeSize||(null!=e?e.shapeSize:e))?t:i)==l?t.call(r,{name:"shapeSize",hash:{},data:n}):t)+"px; color: "+s(typeof(t=null!=(t=a.shapeColor||(null!=e?e.shapeColor:e))?t:i)==l?t.call(r,{name:"shapeColor",hash:{},data:n}):t)+"; margin: "+s(typeof(t=null!=(t=a.iconMargin||(null!=e?e.iconMargin:e))?t:i)==l?t.call(r,{name:"iconMargin",hash:{},data:n}):t)+'px;"></div>\r\n        </div>\r\n    </div>\r\n    <div class="tooltip"></div>\r\n</div>'},useData:!0}),i.chart=b.template({compiler:[7,">= 4.0.0"],main:function(t,e,a,o,n){return'<div class="crumbs">\r\n</div>\r\n<div class="graph">\r\n    <svg></svg>\r\n</div>'},useData:!0}),i.tooltip=b.template({compiler:[7,">= 4.0.0"],main:function(t,e,a,o,n){var r=null!=e?e:t.nullContext||{},i=a.helperMissing,l=t.escapeExpression,s="function";return"<fieldset><legend>"+l((a.t||e&&e.t||i).call(r,"preview",{name:"t",hash:{},data:n}))+'</legend>\r\n    <img src="'+l(typeof(t=null!=(t=a.img||(null!=e?e.img:e))?t:i)==s?t.call(r,{name:"img",hash:{},data:n}):t)+'" /></fieldset>\r\n'+l(typeof(t=null!=(t=a.svgDiv||(null!=e?e.svgDiv:e))?t:i)==s?t.call(r,{name:"svgDiv",hash:{},data:n}):t)},useData:!0}),i);function i(){}var l=(s.getComponentDefinition=function(t){if(0<_.keys(t.settingsModel.attributes).length)for(var e=_.find(s.upgrades,{version:t.settingsModel.get("version")}),a=_.isNil(e)?1:s.upgrades.indexOf(e)+1;a<s.upgrades.length;a+=1){var o=s.upgrades[a];o.fn(t.settingsModel),t.settingsModel.set("version",o.version)}return{id:51,componentName:"ContextMenu",componentDescription:"This element displays Context Menu.",appKey:"ContextMenu",ghostViewThumb:null,buildViewThumb:null,appArgs:{json:{version:"4.0.0d2",possibleValues:[""],Basics:{Theme:"Dark",Selected:"",Columns:3,Overflow:"hidden",Data:"",UseData:!1,DataSourceMapping:{Icon:"",HeaderText:"",ContentText:"",TooltipText:"",TargetDashboardId:"",TargetScreensId:"",ButtonColor:"",IconColor:"",BorderColor:"",TextColor:""}},Data:[],Frame:{ShowFrame:!1,FramePercent:80},ViewState:{viewstates_mapping:[]},Style:{advanced:"",advancedTooltip:'<fieldset><legend>{{t "preview"}}</legend><img src="{{img}}" /></fieldset>{{svgDiv}}'},Buttons:{ButtonLayout:"East-West",ButtonAlign:"left",ButtonBackground:"#696669",ButtonGradient:"none",ButtonMargin:10,ButtonPadding:10,IconMargin:0,ButtonBorder:0,ButtonColor:"#ffffff",TextWidth:75,TextColor:"#ffffff",ShapeColor:"#ffdffff",ShapeSize:30,ShapePosition:"center",ButtonRounding:0,ButtonBorderRounding:0,ShowTooltip:!1,FixedSize:!0,FixedWidth:180,FixedHeight:40}},schema:{type:"object",title:"Properties",properties:{possible_screens:{type:"array",items:{type:"object",properties:{title:{type:"string"},value:{type:"string"}}},options:{hidden:!0}},possible_dashboards:{type:"array",items:{type:"object",properties:{title:{type:"string"},value:{type:"string"}}},options:{hidden:!0}},possibleValues:{type:"array",items:{type:"string"},default:[""],options:{collapsed:!0,hidden:!0}},Basics:{type:"object",title:"Basics",options:{collapsed:!1},properties:{Theme:{type:"string",title:"Theme",options:{hidden:!0},enum:["Light","Dark"]},DashboardTheme:{options:{hidden:!0}},Selected:{type:"viewstate",title:"Selected Value",default:""},Rows:{type:"number"},Columns:{type:"number"},Overflow:{type:"string",title:"Overflow",enum:["hidden","auto","scroll","overlay"]},Data:{type:"data",title:"Data Source",default:""},UseData:{type:"boolean",title:"Use Data Source",default:!1,format:"checkbox"},DataSourceMapping:{type:"object",title:"Data Source Mapping",options:{collapsed:!0},properties:{Icon:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},HeaderText:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},ContentText:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},TooltipText:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:"",options:{hidden:!0}},TargetDashboardId:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},TargetScreensId:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},ButtonColor:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},IconColor:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},BorderColor:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""},TextColor:{type:"string",format:"string",enumSource:"possibleValues",watch:{possibleValues:"root.possibleValues"},default:""}}}}},ViewState:{type:"object",title:"Action",options:{collapsed:!1},properties:{viewstates_mapping:{type:"array",title:"ViewState Mapping",format:"table",uniqueItems:!0,items:{type:"object",title:"Mapping",options:{disable_collapse:!0},properties:{Current:{type:"viewstate"},Target:{type:"string",default:""}}}},ViewStateParam:{type:"viewstate",title:"Linked Parameter",default:""},SetParamValue:{type:"string",title:"Set Value",format:"string",default:""}}},Buttons:{type:"object",title:"Button Defaults",options:{collapsed:!1},properties:{ButtonLayout:{type:"string",title:"Layout",propertyOrder:1,enum:["North-South","South-North","East-West","West-East"]},ButtonAlign:{type:"string",title:"Alignment",propertyOrder:1,enum:["left","right","center"]},ButtonBackground:{type:"string",format:"color",title:"Background Color",propertyOrder:2,default:"#ffa500",options:{hidden:!0}},ButtonGradient:{title:"Background",type:"gradient",propertyOrder:3,options:{gradient:!0}},ButtonMargin:{type:"number",format:"number",title:"Button Margin",propertyOrder:4,default:2},IconMargin:{type:"number",format:"number",title:"Icon Margin",propertyOrder:5,default:2},ButtonPadding:{type:"number",format:"number",title:"Button Padding",propertyOrder:6,default:2},ButtonRounding:{type:"number",format:"number",title:"Button Rounding",propertyOrder:7,default:0},ButtonBorder:{type:"number",format:"number",title:"Border Width (px)",propertyOrder:8,default:1},ButtonColor:{title:"Border Colour",propertyOrder:9,default:"#ffffff",type:"gradient",options:{gradient:!1}},ButtonBorderRounding:{type:"number",format:"number",title:"Border Rounding",propertyOrder:10,default:0,options:{hidden:!0}},TextWidth:{type:"number",format:"number",title:"Text  %",propertyOrder:11,default:50},TextColor:{title:"Text Color",propertyOrder:12,default:"#ffa500",type:"gradient",options:{gradient:!1}},ShapeColor:{title:"Icon Color",propertyOrder:13,default:"#ffa500",type:"gradient",options:{gradient:!1}},ShapeSize:{type:"number",format:"number",title:"Icon Size",propertyOrder:14,default:24},ShapePosition:{type:"string",enum:["left","right","center"],title:"Align Position",propertyOrder:15,default:"left"},VerticalPosition:{default:0,minimum:0,maximum:80,type:"number",step:1,format:"range",title:"Vert. Align Position",propertyOrder:16,options:{hidden:!0}},ShowTooltip:{title:"Show Tooltip",type:"boolean",propertyOrder:17,format:"checkbox"},FixedSize:{title:"Fixed Size",type:"boolean",propertyOrder:18,format:"checkbox"},FixedWidth:{type:"number",format:"number",title:"Fixed Width",propertyOrder:19,default:100},FixedHeight:{type:"number",format:"number",title:"Fixed Height",propertyOrder:20,default:100}}},Frame:{type:"object",title:"Frame Details",options:{collapsed:!0,hidden:!0},properties:{ShowFrame:{title:"Show Frame",type:"boolean",propertyOrder:1,format:"checkbox"},FramePercent:{type:"number",title:"Frame Percent",propertyOrder:2,default:80,minimum:0,maximum:100,step:1,format:"range"}}},Data:{type:"array",format:"object",title:"Buttons",uniqueItems:!1,options:{collapsed:!0},items:{type:"object",title:"Details",properties:{TargetScreens:{title:"Open Screen on Select",type:"string",data:"possible_screens",options:{hidden:!0}},TargetDashboard:{title:"Open Dashboard on Select",type:"string",data:"possible_dashboards",options:{hidden:!0}},TargetScreensId:{title:"ID",type:"string",data:"possible_screens",options:{hidden:!0}},TargetDashboardId:{title:"ID",type:"string",data:"possible_dashboards",options:{hidden:!0}},TargetDashboardScreen:{title:"Open Dashboard on Select",type:"nav",default:"",propertyOrder:1},Shape:{type:"icon",title:"Icon",default:"",propertyOrder:3},Display:{type:"string",title:"Header Text",default:"{{Button Text}}",propertyOrder:4},Content:{type:"string",title:"Content Text",default:"",propertyOrder:5},Info:{type:"string",title:"Dashboard Info",default:"",propertyOrder:6},Customise:{title:"Customise",type:"boolean",format:"checkbox",propertyOrder:7,default:!1},ButtonColor:{title:"Button Color",propertyOrder:8,default:"#ffa500",type:"gradient",options:{gradient:!0}},IconColor:{title:"Icon Color",propertyOrder:9,default:"#ffa500",type:"gradient",options:{gradient:!1}},BorderColor:{title:"Border Color",propertyOrder:10,default:"#ffa500",type:"gradient",options:{gradient:!1}},TextColor:{title:"Text Color",propertyOrder:11,default:"#ffa500",type:"gradient",options:{gradient:!1}}}}},Style:{type:"object",title:"Style",options:{collapsed:!0},properties:{advanced:{type:"css",title:"Advanced CSS",default:""},advancedTooltip:{type:"tooltipTemplate",title:"Custom tooltip",propertyOrder:3,data:["name","thumb","creationDate","svgDiv"],default:""}}}}}}}},s.upgrades=[{version:0,fn:function(){}},{version:"4.0.0d2",fn:function(t){t.set("Style.advanced","")}}],s);function s(){}var p,d=(u.expandNestedViewStates=function(t,e){var a,o=!1,n=Object.keys(t);if(o=1===n.length?(a=e.getPropertyMeta(n[0]))&&"viewstate"===a.type:o){o=/^((?:\w+\.)*)(\d+)/.exec(n[0]);if(o){n=o[1].slice(0,-1),o=e.getProperty(n),e={};return e[n]=o,e}}return t},u.replaceViewStatesWithValue=function(t,e,a){return u.replaceViewStates(t,e,function(t,e,a,o){return o.value},a)},u.replaceViewStatesWithModel=function(t,e,n){return u.replaceViewStates(t,e,function(t,e,a,o){if(a instanceof v.Model&&a.get("_viewType"))return a;e=n.getProperty(t)[e];return _.isUndefined(a)?void 0:(e.get("value")!==a&&e.set("value",a),e)},n)},u.pump=function(a){if(null!=a){if(!_.isObject(a))return a;var t=Object.getPrototypeOf(a);if(_.isObject(a)&&t!==Object.prototype&&t!==Array.prototype)return a;if(t===Array.prototype)return a.map(u.pump);var o=/^(\d+)((?:\.\w+)+)$/;if(Object.keys(a).every(function(t){return o.test(t)}))return Object.keys(a).map(function(t){var e=o.exec(t);return _.isNil(e)?{index:0,tail:"",value:0}:{index:Number(e[1]),tail:e[2].substring(1),value:a[t]}}).reduce(function(t,e){var a={};return a[e.index]={},a[e.index][e.tail]=e.value,$.extend(!0,t,u.pump(a))},[]);var n={greedy:/^(\w+)((?:\.\w+)*)$/,nonGreedy:/^(\w+)((?:\.\w+)+)$/};return Object.keys(a).some(function(t){return n.nonGreedy.test(t)})?Object.keys(a).map(function(t){var e=n.greedy.exec(t);return _.isNil(e)?{head:0,tail:null,value:0}:{head:e[1],tail:""!==e[2]?e[2].substring(1):null,value:a[t]}}).reduce(function(t,e){var a={};return null!==e.tail?(a[e.head]={},a[e.head][e.tail]=e.value):a[e.head]=e.value,$.extend(!0,t,u.pump(a))},{}):_.mapValues(a,u.pump)}},u.replaceViewStates=function(a,t,l,s){var p=function(t,e){return function a(t,e,o){o=o?o+".":"";e+="";var n=s.getPropertyMeta(o+e);{if(n&&"data"===n.type)return t;if(n&&"viewstate"===n.type){var r=(o+e).split("."),i=r.pop(),r=r.join(".");return l(r,i,t,n)}return!_.isArray(t)&&!_.isObject(t)||t.has&&t.has("_dataSource")&&t.has("_dataType")?t:(o+=e,p=function(t,e){return a(t,e,o)},(d=_.isArray(t)?_.map:_.mapValues)(t,p))}}(t,e,a||"")},d=_.isArray(t)?_.map:_.mapValues;return d(t,p)},u);function u(){}function h(t){var e=p.call(this,t)||this;return e.isPivot=!1,e.router={},e.level={},e.options=t,e.api=e.options.api,e.subscriptionKey=_.uniqueId("ContextMenus_"),e.primaryKey="_rowIndex",e.collection=new v.Collection([],{model:v.Model.extend({idAttribute:"id"})}),e.columnInfo=new v.Collection([],{model:v.Model.extend({idAttribute:"id"})}),e.columnInfo.id="id",e.collection.id=e.primaryKey,e.columnInfo.comparator="index",e.hideErrorMessage=t.api.hideErrorMessage,e.showErrorMessage=t.api.showErrorMessage,e.router={},e.level={},e.$el.html(x.app()),e.$root=e.$el.find(">.ContextMenu"),e.$frame=e.$el.find(".frame"),e.$title=e.$el.find(".title"),e.updateTheme(),e}return p=v.View,n(h,p),h.prototype.onSettingsChange=function(t){t=d.expandNestedViewStates(t,this.api),t=d.replaceViewStatesWithValue("",t,this.api),t=d.pump(t);this.onSettingsChangeProcessed.call(this,t)},h.prototype.onSettingsChangeProcessed=function(t){(_.get(t,"Basics.UseData")||_.get(t,"Basics.Data"))&&(this.onPropDataChange(this.api.getProperty("Basics").Data),_.get(t,"Basics.UseData")&&this.setButtonParams()),_.get(t,"Basics.DataSourceMapping")&&this.setButtonParams(),_.get(t,"notificationEvent")&&(this.api.setProperty("possibleColumns",[""]),this.onPropDataChange(this.api.getProperty("Basics").Data)),(_.get(t,"Data")||_.get(t,"ViewState")||_.get(t,"Style")||_.get(t,"format")||_.get(t,"Alignment")||_.get(t,"Buttons")||_.get(t,"Basics.SelectedObjectRouting"))&&this.applyContextMenu()},h.prototype.applyDataToContextMenu=function(){var t=this,e=[];_.defer(function(){t.api.getProperty("Basics.UseData")&&(e.push("none"),_.each(t.columnInfo.models,function(t){e.push(t.id)}),t.applyContextMenu())})},h.prototype.applyContextMenu=function(){var p,d,u,h,c=this,t=this.api.getProperty("Basics"),g=this.api.getProperty("Buttons"),e=this.api.getProperty("Data"),a=this.api.getProperty("Frame"),m=this.api.getProperty("Style"),o=this.collection.models.length-1,f="",n=this.$el.height(),n=_.isNil(n)?0:n,y=a.ShowFrame?n*((100-a.FramePercent)/100):n,n={left:"flex-start",center:"center",right:"flex-end"}[g.ButtonAlign];t&&g&&a&&m&&(y=parseFloat(g.FixedSize)?"object"==typeof g.FixedHeight?parseInt(g.FixedHeight.get("value")):parseInt(g.FixedHeight):y/(o/parseFloat(t.Columns)+1)-2*(g.ButtonMargin+g.ButtonPadding),h=g.FixedSize?"object"==typeof g.FixedWidth?parseInt(g.FixedWidth.get("value"))+"px":parseInt(g.FixedWidth)+"px":"calc("+100/parseFloat(t.Columns)+"% - "+(2.5*g.ButtonMargin+2*g.ButtonPadding)+"px)",this.$el.html(x.app()),this.$frame=this.$el.find(".frame"),this.$frame.css({overflow:t.Overflow}),e&&(this.$frame.css({"justify-content":n}),_.each(e,function(t,e){var a="",o=20,n=t.Customise,r=""+(t.Shape||"");r=0<=r.indexOf("mi-")||0<=r.indexOf("fa-")?r:"fa-"+r,!_.get(t,"TargetDashboardScreen")||_.get(t,"TargetDashboardScreen")instanceof v.Model?_.get(t,"TargetDashboardScreen")instanceof v.Model&&(a=JSON.stringify(_.extend(t.TargetDashboardScreen.toJSON(),{buttonId:e}))):(_.set(t,"TargetDashboardScreen.buttonId",e),a=JSON.stringify(t.TargetDashboardScreen));var i=n?"Data."+e+".ButtonColor":"Buttons.ButtonGradient",l=n?"Data."+e+".IconColor":"Buttons.ShapeColor",s=n?"Data."+e+".TextColor":"Buttons.TextColor",n=n?"Data."+e+".BorderColor":"Buttons.ButtonColor",t={iconMargin:g.IconMargin,svg:r,icontype:r.substring(0,2),bgColor:c.browserGradient(c.api.getProperty(i)),rounding:g.ButtonRounding,shapeColor:c.api.getProperty(l),width:h,height:y,shapeSize:g.ShapeSize,shapeScale:g.ShapeSize/24,textColor:c.api.getProperty(s),text:c.api.getProperty("Data."+e+".Display"),textContent:c.api.getProperty("Data."+e+".Content"),textPercent:g.TextWidth,imgPercent:100-g.TextWidth,border:g.ButtonBorder,borderColor:c.api.getProperty(n),valign:void 0===t.VerticalPosition?0:t.VerticalPosition,borderSpacing:2.5*g.ButtonMargin+2*g.ButtonPadding,padding:g.ButtonPadding,margin:g.ButtonMargin,model:a,position:g.ShapePosition,info:t.Info};(t="South-North"===g.ButtonLayout?$(x.buttonSN(t)):"East-West"===g.ButtonLayout?$(x.buttonEW(t)):"West-East"===g.ButtonLayout?$(x.buttonWE(t)):$(x.button(t))).mouseover(function(t){if($(t.currentTarget).css({opacity:.7}),g.Showtip){if(c.dialog||(c.dialog=$(c).find(".tooltip").dialog({height:20,autoOpen:!1})),c.dialog.dialog("option","title",$(c).attr("data")),u=(void 0).get("name"),d=(void 0).get("creationDate"),c.dialog.attr("data")&&(f="<div>"+void 0+$(c).attr("data")+"</div>"),""===m.advancedTooltip)p=x.tooltip({img:"",svgDiv:f,creationDate:d,dashboard:u});else{var e=b.compile(m.advancedTooltip),a={img:"",svgDiv:f,creationDate:d,dashboard:u};_.each(c.options.viewModel.attributes,function(t,e){void 0!==e&&0!==e.indexOf(".")&&(a[e]=c.options.viewModel.get(e).get("value"))});try{p=e(a)}catch(t){p=x.tooltip({img:"",svgDiv:f,creationDate:d,dashboard:u})}}c.dialog.html(p),c.dialog.dialog("open"),o=c.dialog.children().height(),o=isNaN(o)||0===o?20:o,$(document).find(".ui-dialog.ContextMenu").css({height:o+30}),$(document).find(".ContextMenu > .tooltip.ui-dialog-content").css({height:o+30}),c.dialog.dialog("option",{dialogClass:"quick-dash ContextMenu",position:{my:"left top",at:"left bottom",collision:"flip flip",of:c}})}}).mouseout(function(t){$(t.currentTarget).css({opacity:1}),c.dialog&&c.dialog.dialog("close")}).click(function(t){c.dialog&&c.dialog.dialog("close");var e=t.currentTarget.getAttribute("model"),t={viewstate:{},dashboard:"",screen:""};if(e)try{var a=JSON.parse(e);"dict"===a._type&&a.value&&a.value.screen&&a.value.dashboard?(t.screen=a.value.screen.value,t.dashboard=a.value.dashboard.value,t.buttonId=a.buttonId,t._dashboardsType="navigation"):t=a,t.viewstate=c.mapViewStates(),_.isNil(_.get(t,"buttonId"))||(c.api.setProperty("Basics.Selected",_.get(t,"buttonId")),c.api.navigate(t))}catch(t){console.log("invalid target",e)}}),c.$frame.append(t)}),this.$iframe=$(this.$frame.find(".frame"))))},h.prototype.browserGradient=function(t){var e=t;return 0!==t.trim().indexOf("#")&&(e=(e=e.replace("-moz-","")).replace("-webkit-",""),e=0<=navigator.userAgent.indexOf("Chrome")?"-webkit-"+e:0<=navigator.userAgent.indexOf("Firefox")?"-moz-"+e:e.replace("linear-gradient(","linear-gradient(to ")),e},h.prototype.initializeErrorHandler=function(t){var e=this;this.updateErrorMessage(),this.listenTo(t,"change:error",function(){e.updateErrorMessage()})},h.prototype.mapViewStates=function(){var n=this,r={},t=this.api.getProperty("ViewState.viewstates_mapping");return _.each(t,function(t,e){var a=n.api.getPropertyMeta("ViewState.viewstates_mapping."+e+".Current"),o=n.api.getPropertyMeta("ViewState.viewstates_mapping."+e+".Target");a&&(o&&"viewstate"===o.type&&o.path?n.api.setProperty("ViewState.viewstates_mapping."+e+".Target",a.value):r[t.Target]=a.value)}),r},h.prototype.navigate=function(t,e){this.router[t]=e},h.prototype.onData=function(e,t){var a=this,o=!1,n=e.columns;e.primaryKey!==this.primaryKey&&(this.primaryKey=e.primaryKey,this.collection.reset(),this.isPivot?this.collection=new(r.Tools.createPivotCollectionFunc(this.primaryKey)):this.collection=new v.Collection([],{model:v.Model.extend({idAttribute:this.primaryKey})}),o=!0),n.reset?this.columnInfo.reset(e.columns.reset):(this.columnInfo.remove(_.map(n.remove,function(t){return t[e.primaryKey]})),this.columnInfo.add(n.add),this.columnInfo.add(n.change,{merge:!0})),(o=o||_.some(["add","remove","reset","change"],function(t){return a.metaChange="reset",void 0!==n[t]}))&&this.api.setProperty("possibleValues",this.columnInfo.pluck("id")),this.columnInfo.sort(),o&&this.applyDataToContextMenu(),t.reset?(this.applyDataToContextMenu(),this.collection.reset(t.reset)):(this.collection.remove(_.map(t.remove,function(t){return t[e.primaryKey]})),this.collection.add(t.add),this.collection.add(t.change,{merge:!0})),this.setButtonParams()},h.prototype.onPropDataChange=function(e){this.api.getProperty("Basics.UseData")&&(this.model&&(this.stopListening(this.model),this.api.unsubscribe(this.model)),this.model=e,this.model&&this.model.attributes?(this.isPivot="pivot"===this.model.get("_dataType")||void 0===this.model.get("_dataType"),this.api.subscribe(this.model,this.onData.bind(this)),this.initializeErrorHandler(this.model)):this.showErrorMessage({error:t("Invalid Data Source")+': "'+e.path+'" '+t("selected"),type:"Warning"},this.model))},h.prototype.onResizeStop=function(){this.applyContextMenu()},h.prototype.setButtonParams=function(){var i,l=this,t=this.api.getProperty("Basics"),e=[];t.UseData&&this.api.getProperty("Data")&&_.defer(function(){var n=l.api.getProperty("Buttons"),r=_.extend({},l.api.getProperty("Basics.DataSourceMapping"));e.push("none"),_.each(l.columnInfo.models,function(t){e.push(t.id)}),l.api.setProperty("possibleValues",e),_.each(l.api.getProperty("Basics.DataSourceMapping"),function(t){void 0!==t&&""!==t||(t=e[0])}),i=[],_.each(l.collection.models,function(a,t){var o={},e=l.api.getProperty("Data")[t]||"";_.each(r,function(t,e){o[e]="none"!==t&&""!==t&&a.get(t)||""}),i.push({BorderColor:_.get(o,"BorderColor")||l.api.getProperty("Data."+t+".BorderColor")||n.ButtonColor||"#ffffff",ButtonColor:_.get(o,"ButtonColor")||l.api.getProperty("Data."+t+".ButtonColor")||n.ButtonBackground||"#ffffff",Content:_.get(o,"ContentText")||l.api.getProperty("Data."+t+".Content")||"",Customise:!0,Display:_.get(o,"HeaderText")||l.api.getProperty("Data."+t+".Display")||"",IconColor:_.get(o,"IconColor")||l.api.getProperty("Data."+t+".IconColor")||"",Info:_.get(o,"TooltipText")||l.api.getProperty("Data."+t+".Info")||"",Shape:_.get(o,"Icon")||l.api.getProperty("Data."+t+".Share")||"",TargetDashboardId:_.get(o,"TargetDashboardId")||e.TargetDashboardId||"",TargetScreensId:_.get(o,"TargetScreensId")||e.TargetScreensId||"",TargetDashboardScreen:{dashboard:_.find(l.api.getProperty("possible_dashboards"),{id:_.get(o,"TargetDashboardId")})||_.get(o,"TargetDashboardId")||e["TargetDashboardScreen.dashboard"]||{id:_.get(o,"TargetDashboardId")||e["TargetDashboardScreen.dashboard.id"],title:"<none>"},screen:_.find(l.api.getProperty("possible_screens"),{id:_.get(o,"TargetScreensId")})||_.get(o,"TargetScreensId")||e["TargetDashboardScreen.screen"]||{id:_.get(o,"TargetScreensId")||e["TargetDashboardScreen.screen.id"],title:"<none>"}},TextColor:_.get(o,"TextColor")||n.TextColor})}),l.api.setProperty("Data",i),l.applyContextMenu()})},h.prototype.setTheme=function(){this.updateTheme()},h.prototype.updateErrorMessage=function(){this.model.get("error")?this.showErrorMessage(this.model.get("error")):this.hideErrorMessage()},h.prototype.updatePadding=function(){var t=this.api.getProperty("Alignment");this.$root.css({left:t.paddingLeft+"px",right:t.paddingRight+"px",top:t.paddingTop+"px",bottom:t.paddingBottom+"px"})},h.prototype.updateTitle=function(){var t=this.api.getProperty("format"),e=t.widgetTitle;e&&0<e.length?(this.$title.text(e),this.$title.css({"font-size":t.titleFontSize,"text-align":t.titleHorizontal,"padding-left":t.titlePaddingLeft,"padding-right":t.titlePaddingRight,"padding-top":t.titlePaddingTop,"padding-bottom":t.titlePaddingBottom}),this.$frame.css("top",this.$title.outerHeight())):(this.$title.text(""),this.$frame.css("top",0))},h.prototype.updateTheme=function(){var t=this.api.getProperty("Basics.Theme").toLowerCase();this.options.dashboardViewModel.get("DashboardTheme")&&(t=this.options.dashboardViewModel.get("DashboardTheme").toLowerCase()),this.themeClass!==t&&(this.$root.removeClass(this.themeClass),this.themeClass=t,this.$root.addClass(this.themeClass))},h.getComponentDefinition=l.getComponentDefinition,h});
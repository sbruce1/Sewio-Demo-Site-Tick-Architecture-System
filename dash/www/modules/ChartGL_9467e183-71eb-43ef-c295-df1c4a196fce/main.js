define(["Handlebars","QuickBase","moment","css!./css/app.css"],function(e,w,m){"use strict";var n,i=this&&this.__extends||(n=function(t,e){return(n=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(t,e){t.__proto__=e}||function(t,e){for(var i in e)e.hasOwnProperty(i)&&(t[i]=e[i])})(t,e)},function(t,e){function i(){this.constructor=t}n(t,e),t.prototype=null===e?Object.create(e):(i.prototype=e.prototype,new i)}),o=this&&this.__spreadArrays||function(){for(var t=0,e=0,i=arguments.length;e<i;e++)t+=arguments[e].length;for(var n=Array(t),r=0,e=0;e<i;e++)for(var o=arguments[e],a=0,s=o.length;a<s;a++,r++)n[r]=o[a];return n},a=this&&this.__assign||function(){return(a=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var r in e=arguments[i])Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r]);return t}).apply(this,arguments)},r={Trigger:{default:"Click",enum:["Click","Hover"],propertyOrder:2,title:"Trigger Action",type:"string"}},s={RuleName:{default:"",propertyOrder:1,title:"Rule Name",type:"string"},RuleSource:{default:"",enumSource:"possible_columns",propertyOrder:3,title:"Rule Source",type:"string",watch:{possibleCols:"arrItem.possibleRulesColumns"}},RuleTarget:{enumSource:"possible_columns",default:"",propertyOrder:2,title:"Rule Target",type:"string",watch:{possibleCols:"arrItem.possibleYColumns"}},RuleType:{options:{hidden:!0},propertyOrder:4,title:"Rule Type",type:"string"},Show:{default:!1,format:"checkbox",propertyOrder:5,title:"Show Rule in Legend",type:"boolean"}},f=(l.getComponentDefinition=function(t){var e={id:667,componentName:"Editable Dropdown",componentDescription:"Editable dropdown",appKey:"EditableList",css:"EditableList",appArgs:{quickStart:[{path:"Layers.0.Data",message:"populate Data Source"}],json:{version:"4.6.1",Style:{advanced:""},Basics:{Hover:"",Selected:"",Duration:400,Easing:"easeOutQuart"},Layers:[{_Id:"L0",_Type:"Bubble",Data:"",XAxis:"",YAxis:"",XAxisId:"X-Axis 1",YAxisId:"Y-Axis 1",Color:_.clone(l.COLOR_DEFAULT),ColorData:"None",Opacity:80,Name:"",Enabled:!0,Legend:!0,Palette:_.cloneDeep(l.PALETTE_DEFAULT),Actions:[],RadiusData:"Fixed Size",RadiusScaling:4,ScaleOnZoom:!0,Icon:"",HighlightRules:[],possibleRadiusData:["Fixed Size"],possibleRulesColumns:[],possibleXColumns:[],possibleYColumns:[],possibleXAxes:["X-Axis 1"],possibleYAxes:["Y-Axis 1"]}],Xaxes:[{Bounds:"",Type:"Linear",Position:"Bottom",Width:0,Ticks:10,Title:{Display:!1,LabelString:"",FontSize:16},Format:{Display:!0,BeginAtZero:!1,Format:"Number",Precision:2,FontSize:12,Prefix:"",Suffix:"",HideTrailingZeroes:!1},Range:{UseMinMax:!1,Min:"",Max:"",SelectionMin:"",SelectionMax:""},Gridlines:{GridlinesOffset:!1,GridlinesColor:"",GridlinesOpacity:15}}],Yaxes:[{Bounds:"",Type:"Linear",Position:"Left",Width:0,Ticks:10,Title:{Display:!1,LabelString:"",FontSize:16},Format:{Display:!0,BeginAtZero:!1,Format:"Number",Precision:2,FontSize:12,Prefix:"",Suffix:"",HideTrailingZeroes:!1},Range:{UseMinMax:!1,Min:"",Max:"",SelectionMin:"",SelectionMax:""},Gridlines:{GridlinesOffset:!1,GridlinesColor:"",GridlinesOpacity:15}}],Overlay:{ShowCrosshairs:!0,ShowCoordinates:!0,SnapToPoint:!0,UseCustomTooltip:!1,CustomTooltip:l.CUSTOM_TOOLTIP_DEFAULT,ShowAllPoints:!1,GroupByLayer:!1}},schema:{type:"object",title:"Properties",properties:{possibleXColumns:{type:"readOnlyArray",items:{type:"string"},default:[],options:{collapsed:!0,hidden:!0}},possibleYColumns:{type:"readOnlyArray",items:{type:"string"},default:[],options:{collapsed:!0,hidden:!0}},Basics:{propertyOrder:0,type:"object",title:"Basics",options:{collapsed:!0},properties:{Hover:{title:"Hover",type:"string",default:""},Selected:{title:"Selected",type:"string",default:""},Duration:{title:"Animation Duration",type:"number",default:400},Easing:{title:"Animation Easing",type:"string",default:"easeOutQuart",enum:["swingFromTo","swingFrom","swingTo","easeFromTo","easeFrom","easeTo","easeInQuad","easeOutQuad","easeInOutQuad","easeInCubic","easeOutCubic","easeInOutCubic","easeInQuart","easeOutQuart","easeInOutQuart","easeInQuint","easeOutQuint","easeInOutQuint","easeInSine","easeOutSine","easeInOutSine","easeInExpo","easeOutExpo","easeInOutExpo","easeInCirc","easeOutCirc","easeInOutCirc","easeOutBounce","easeInBack","easeOutBack","easeInOutBack","bounce","bouncePast","elastic"]}}},Layers:{propertyOrder:1,type:"array",items:{type:"object",id:"arrItem",title:"Layer",options:{collapsed:!0},headerTemplate:"{{#if self.Name}}{{valueProp self.Name }}{{else}}Layer {{ i1 }}{{/if}}",oneOf:[{title:"Bubble",options:{linked_oneof_property:{property:"_Type",value:"Bubble"}},properties:_.extend({},l.LAYER_COMMON,{RadiusData:{title:"Radius Data",type:"",propertyOrder:7,default:"Fixed Size",enumSource:"possible_columns",watch:{possibleCols:"arrItem.possibleRadiusData"}},RadiusScaling:{title:"Radius Scaling",type:"number",propertyOrder:7,default:4},ScaleOnZoom:{title:"Scale on Zoom",type:"boolean",default:!0,propertyOrder:7},Icon:{type:"icon",title:"Icon",iconTypes:"fa",propertyOrder:8,default:""}})},{title:"Line",options:{linked_oneof_property:{property:"_Type",value:"Line"}},properties:_.extend({},l.LAYER_COMMON,{Fill:{title:"Fill",type:"dropdown",default:"No Fill",data:"possible_columns",watch:{possible_layers:"arrItem.possibleLayers"},propertyOrder:8},FillColor:{default:"#0061FF",options:{gradient:!1,noColor:!1},propertyOrder:8,title:"Fill Color",type:"gradient"},FillOpacity:{title:"Fill Opacity",type:"number",default:80,propertyOrder:8},FadeToTransparent:{title:"Fade to Transparent",type:"boolean",default:!1,propertyOrder:8}})},{title:"Bar",options:{linked_oneof_property:{property:"_Type",value:"Bar"}},properties:_.extend({},l.LAYER_COMMON,l.BAR_PROPERTIES)},{title:"Candlestick",options:{linked_oneof_property:{property:"_Type",value:"Candlestick"}},properties:_.extend({},l.LAYER_COMMON,{Open:{enumSource:"possible_columns",propertyOrder:3,title:"Open",type:"string",watch:{possibleColumns:"arrItem.possibleXColumns"}},High:{enumSource:"possible_columns",propertyOrder:3,title:"High",type:"string",watch:{possibleColumns:"arrItem.possibleXColumns"}},Low:{enumSource:"possible_columns",propertyOrder:3,title:"Low",type:"string",watch:{possibleColumns:"arrItem.possibleXColumns"}},Close:{enumSource:"possible_columns",propertyOrder:3,title:"Close",type:"string",watch:{possibleColumns:"arrItem.possibleXColumns"}},CandlestickFormat:{type:"object",title:"Candlestick Format",propertyOrder:9,options:{collapsed:!0},properties:_.extend({},l.BAR_PROPERTIES,{BearColor:{default:"#ff0000",options:{gradient:!1,noColor:!1},propertyOrder:5,title:"Bear Color",type:"gradient"},BullColor:{default:"#00ff00",options:{gradient:!1,noColor:!1},propertyOrder:5,title:"Bull Color",type:"gradient"},NeutralColor:{default:"#ffffff",options:{gradient:!1,noColor:!1},propertyOrder:5,title:"Neutral Color",type:"gradient"},WickColor:{default:"#7b8284",options:{gradient:!1,noColor:!1},propertyOrder:5,title:"Wick Color",type:"gradient"}})},YAxis:{options:{hidden:!0}}})}]}},Xaxes:{title:"X-Axes",type:"array",propertyOrder:2,options:{collapsed:!0},items:{title:"X-Axis",type:"object",options:{collapsed:!0},properties:{Bounds:{options:{hidden:!0}},Type:{title:"X-Axis Type",type:"string",propertyOrder:1,enum:["Linear","Category"],default:"Linear"},Position:{title:"Position",type:"string",enum:["Top","Bottom"],propertyOrder:2,default:"Bottom"},Width:{title:"Height",type:"number",propertyOrder:2,default:0},Ticks:{type:"number",title:"Number of Ticks",propertyOrder:2,default:10},Title:{type:"object",title:"Title",options:{collapsed:!0},properties:{Display:{title:"Display",type:"boolean",default:!1},LabelString:{title:"Label String",type:"string",default:""},FontSize:{title:"Font Size",type:"number",default:16}}},Range:{type:"object",title:"Range",propertyOrder:2,options:{collapsed:!0,hidden:!1},properties:{UseMinMax:{title:"Use min max",type:"boolean",default:!1},Min:{title:"Min",type:"string",default:""},Max:{title:"Max",type:"string",default:""},SelectionMin:{title:"Selection Min",type:"string",default:""},SelectionMax:{title:"Selection Max",type:"string",default:""}}},Gridlines:{type:"object",title:"Gridlines",propertyOrder:3,options:{collapsed:!0},properties:{GridlinesOffset:{title:"Offset Gridlines",type:"boolean",default:!1},GridlinesColor:{title:"Gridlines Color",type:"gradient",options:{noColor:!0,gradient:!1},default:""},GridlinesOpacity:{title:"Gridlines Opacity",type:"number",default:15}}},Format:{type:"object",title:"Format",propertyOrder:4,options:{collapsed:!0},properties:{Display:{title:"Display",type:"boolean",default:!0},BeginAtZero:{type:"boolean",title:"Begin at Zero",format:"checkbox",default:!1},Format:{title:"Numeric Format",type:"string",enum:["Number","Smart Number","Formatted Number"],default:"Number"},Precision:{title:"Decimal Places",type:"number",default:2},FontSize:{title:"Font Size",type:"number",format:"number",default:12},Prefix:{title:"Prefix",type:"string",default:""},Suffix:{title:"Suffix",type:"string",default:""},HideTrailingZeroes:{type:"boolean",propertyOrder:4,title:"Hide Trailing Zeroes",format:"checkbox",default:!1}}}}}},Yaxes:{title:"Y-Axes",type:"array",propertyOrder:2,options:{collapsed:!0},items:{title:"Y-Axis",type:"object",options:{collapsed:!0},properties:{Bounds:{options:{hidden:!0}},Type:{title:"Y-Axis Type",type:"string",propertyOrder:1,enum:["Linear","Category"],default:"Linear"},Position:{title:"Position",type:"string",enum:["Left","Right"],propertyOrder:2,default:"Left"},Width:{title:"Width",type:"number",propertyOrder:2,default:0},Ticks:{type:"number",title:"Number of Ticks",propertyOrder:2,default:10},Title:{type:"object",title:"Title",options:{collapsed:!0},properties:{Display:{title:"Display",type:"boolean",default:!1},LabelString:{title:"Label String",type:"string",default:""},FontSize:{title:"Font Size",type:"number",default:16}}},Range:{type:"object",title:"Range",propertyOrder:2,options:{collapsed:!0,hidden:!1},properties:{UseMinMax:{title:"Use min max",type:"boolean",default:!1},Min:{title:"Min",type:"string",default:""},Max:{title:"Max",type:"string",default:""},SelectionMin:{title:"Selection Min",type:"string",default:""},SelectionMax:{title:"Selection Max",type:"string",default:""}}},Gridlines:{type:"object",title:"Gridlines",propertyOrder:3,options:{collapsed:!0},properties:{GridlinesOffset:{title:"Offset Gridlines",type:"boolean",default:!1},GridlinesColor:{title:"Gridlines Color",type:"gradient",options:{noColor:!0,gradient:!1},default:""},GridlinesOpacity:{title:"Gridlines Opacity",type:"number",default:15}}},Format:{type:"object",title:"Format",propertyOrder:3,options:{collapsed:!0},properties:{Display:{title:"Display",type:"boolean",default:!0},BeginAtZero:{type:"boolean",title:"Begin at Zero",format:"checkbox",default:!1},Format:{title:"Numeric Format",type:"string",enum:["Number","Smart Number","Formatted Number"],default:"Number"},Precision:{title:"Decimal Places",type:"number",default:2},FontSize:{title:"Font Size",type:"number",format:"number",default:12},Prefix:{title:"Prefix",type:"string",default:""},Suffix:{title:"Suffix",type:"string",default:""},HideTrailingZeroes:{type:"boolean",propertyOrder:4,title:"Hide Trailing Zeroes",format:"checkbox",default:!1}}}}}},Overlay:{type:"object",title:"Overlay",options:{collapsed:!0},propertyOrder:209,properties:{ShowCrosshairs:{type:"boolean",title:"Show Crosshairs",default:!0},ShowCoordinates:{type:"boolean",title:"Show Coordinates",default:!0},SnapToPoint:{type:"boolean",title:"Snap Crosshair to Data",default:!0},UseCustomTooltip:{type:"boolean",title:"Use custom tooltip",default:!1},CustomTooltip:{type:"tooltipTemplate",title:"Custom tooltip",templateItems:{this:{type:"array",items:{color:"color",data:"data",icon:"icon",image:"image",name:"name",width:"width",xAxis:"xAxis",yAxis:"yAxis"}}},default:'<table><thead><tr><th>{{this.0.xAxis}}</th><th></th></tr></thead>{{#each this}}<tr><td width="{{width}}"><i class="{{icon}}" style="color:{{color}}; {{image}};"></i> {{name}}: </td><td>{{yAxis}}</td></tr>{{/each}}</table>'},ShowAllPoints:{type:"boolean",title:"Show all data points",default:!1},GroupByLayer:{type:"boolean",title:"Group tooltip by layer",default:!1}}},Style:{type:"object",title:"Style",options:{collapsed:!0},propertyOrder:211,properties:{advanced:{type:"css",title:"Advanced CSS",default:""}}}}}}};if(0<_.keys(t.settingsModel.attributes).length)for(var i=_.find(l.upgrades,{version:t.settingsModel.get("version")}),n=void 0===i?1:l.upgrades.indexOf(i)+1;n<l.upgrades.length;n+=1){var r=l.upgrades[n];r.fn(t.settingsModel,t),t.settingsModel.set("version",r.version)}return e},l.PALETTE_DEFAULT=[{type:"#0061FF"},{type:"#F23A66"},{type:"#009BAB"},{type:"#7647CC"},{type:"#FFC300"},{type:"#9FA3A6"},{type:"#003A99"},{type:"#A90B31"},{type:"#005D67"},{type:"#452481"}],l.COLOR_DEFAULT="#0061FF",l.TOOLTIP_DEFAULT='<table><thead><tr><th>{{this.0.xAxis}}</th><th></th></tr></thead>{{#each this}} {{#if open}}<tr><td width="{{width}}">Open: </td><td>{{open}} </td></tr><tr><td width="{{width}}">High: </td><td>{{high}} </td></tr><tr><td width="{{width}}">Low: </td><td>{{low}} </td></tr><tr><td width="{{width}}">Close: </td><td>{{close}} </td></tr>{{else}}<tr><td width="{{width}}"><i class="{{icon}}" style="color:{{color}};{{image}};"></i> {{name}}: </td><td>{{#if grouped}}{{#each grouped}}<td> {{this}} </td>{{/each}} {{else}} <td>{{yAxis}}</td> {{/if}}</td></tr>{{/if}}{{/each}}</table>',l.BAR_PROPERTIES={BarWidth:{title:"Bar Percentage",type:"number",default:95,propertyOrder:8},BarFixedWidth:{title:"Bar Fixed Width",type:"number",default:10,propertyOrder:8},BarWidthType:{title:"Bar Width Type",type:"string",default:"Percentage",enum:["Percentage","Fixed Width"],propertyOrder:8}},l.BASICS={Hover:"",Selected:"",Duration:400,Easing:"easeOutQuart"},l.CUSTOM_TOOLTIP_DEFAULT='<table><thead><tr><th>{{this.0.xAxis}}</th><th></th></tr></thead>{{#each this}}<tr><td width="{{width}}"><i class="{{icon}}" style="color:{{color}}; {{image}};"></i> {{name}}: </td><td>{{yAxis}}</td></tr>{{/each}}</table>',l.LAYER_COMMON={_Id:{type:"string",options:{hidden:!0}},_Type:{type:"string",options:{hidden:!0}},possibleColorColumns:{type:"array",options:{hidden:!0}},possibleRadiusData:{type:"array",options:{hidden:!0}},possibleLayers:{type:"array",options:{hidden:!0}},possibleRulesColumns:{type:"array",options:{hidden:!0}},possibleXColumns:{type:"array",options:{hidden:!0}},possibleYColumns:{type:"array",options:{hidden:!0}},possibleXAxes:{type:"array",options:{hidden:!0}},possibleYAxes:{type:"array",options:{hidden:!0}},Data:{title:"Data Source",type:"data",default:"",propertyOrder:1},Name:{title:"Name",type:"string",default:"",propertyOrder:2},XAxis:{title:"X-Axis Data",type:"dropdown",default:"",data:"possible_columns",watch:{possible_columns:"arrItem.possibleXColumns"},propertyOrder:3},XAxisId:{title:"X-Axis",default:"X-Axis 1",type:"string",enumSource:"possible_xaxis",watch:{possible_xaxis:"arrItem.possibleXAxes"},propertyOrder:3},YAxis:{title:"Y-Axis Data",type:"customDropdown",default:"",data:"possible_columns",watch:{possible_columns:"arrItem.possibleYColumns"},propertyOrder:3},YAxisId:{title:"Y-Axis",default:"Y-Axis 1",type:"string",enumSource:"possible_yaxis",watch:{possible_yaxis:"arrItem.possibleYAxes"},propertyOrder:3},Color:{title:"Color",type:"gradient",options:{gradient:!1},default:_.clone(l.COLOR_DEFAULT),propertyOrder:8},ColorData:{title:"Color Enumeration",type:"dropdown",default:"None",data:"possible_columns",watch:{possible_columns:"arrItem.possibleColorColumns"},propertyOrder:8},Opacity:{title:"Opacity",type:"number",default:80,propertyOrder:8},Enabled:{title:"Enabled",type:"boolean",default:!0,propertyOrder:9},Legend:{title:"Legend Enabled",type:"boolean",default:!0,propertyOrder:9},Palette:{type:"array",format:"table",title:"Color Palette",options:{collapsed:!0},uniqueItems:!1,items:{type:"object",title:"Palette Color",properties:{type:{type:"gradient",options:{gradient:!1},title:"color",default:"#ffa500"}}},default:_.cloneDeep(l.PALETTE_DEFAULT),propertyOrder:10},Actions:{title:"Actions",type:"actions",fields:{map:_.extend({Current:{enumSource:"possible_columns",propertyOrder:10,title:"Source Column",type:"string",watch:{possibleColumns:"arrItem.possibleColorColumns"}}},r),nav:r,query:r,url:r},options:{collapsed:!0}},HighlightRules:{title:"Highlight Rules",type:"array",options:{collapsed:!0},items:{title:"Highlight Rule",type:"object",oneOf:[{options:{linked_oneof_property:{property:"RuleType",value:"discrete"}},properties:Object.assign({},s,{RuleColor:{default:"#F8F8F8",options:{gradient:!1,noColor:!1},propertyOrder:11,title:"Rule Color",type:"gradient"},RuleOperation:{default:"",enum:["","search","regexp","contains","starts with","ends with","==","<",">","<=",">=","!=","in"],propertyOrder:9,title:"Rule Operation",type:"string"},RuleValue:{data:"possible_columns",default:"",propertyOrder:10,title:"Rule Value",type:"string"}}),title:"Discrete"},{options:{additionalProperties:!1,linked_oneof_property:{property:"RuleType",value:"gradient"}},properties:Object.assign({},s,{Palette:{default:[{type:"#b71c1c"},{type:"#F57F17"},{type:"#33691E"}],format:"table",items:{properties:{type:{default:"#ffa500",options:{gradient:!1},title:"color",type:"gradient"}},title:"Palette Color",type:"object"},options:{collapsed:!0},propertyOrder:8,title:"Color Palette",type:"array",uniqueItems:!1},RuleMax:{default:1,format:"number",propertyOrder:7,title:"Rule Max",type:"number"},RuleMin:{default:0,format:"number",propertyOrder:6,title:"Rule Min",type:"number"}}),title:"Gradient"}]}}},l.upgrades=[{version:"0",fn:function(t,e){}},{version:"4.5.0",fn:function(t){t.get("Basics")&&!t.get("Basics.Easing")&&t.unset("Basics")}},{version:"4.5.1.1",fn:function(r){r.get("Palette")||r.set("Palette",l.PALETTE_DEFAULT),_.each(r.get("Layers"),function(t,e){r.get("Layers."+e+".Name")||r.set("Layers."+e+".Name","Layer "+(e+1))}),r.get("Xaxis")&&!r.get("Xaxes.Range.SelectionMin")&&(r.set("Xaxis.Range.SelectionMin",""),r.set("Xaxis.Range.SelectionMax",""),r.set("Yaxis.Range.SelectionMin",""),r.set("Yaxis.Range.SelectionMax","")),r.get("Basics.Easing")||r.set("Basics",l.BASICS),r.get("Xaxes")&&r.get("Xaxes.0.Format")||(r.set("Xaxes",[_.extend({},r.get("Xaxis"),{Position:{title:"Position",type:"string",enum:["Top","Bottom"],default:"Bottom"}})]),r.set("Yaxes",[_.extend({},r.get("Yaxis"),{Position:{title:"Position",type:"string",enum:["Left","Right"],default:"Left"}})]),r.set("Yaxes.0.Position","Left"),r.set("Xaxes.0.Position","Bottom"),r.unset("Xaxis"),r.unset("Yaxis"),_.each(r.get("Layers"),function(t,e){r.set("Layers."+e+".XAxisId","X-Axis 1"),r.set("Layers."+e+".YAxisId","Y-Axis 1"),r.set("Layers."+e+".possibleXAxes",["X-Axis 1"]),r.set("Layers."+e+".possibleYAxes",["Y-Axis 1"])}));'<table>{{#each this}}{{#eq @index 0}}<thead><tr><th>{{xAxis}}</th><th></th></tr></thead>{{/eq}}<tr><td width="{{width}}"><i class="{{icon}}" style="color:{{color}}"></i> {{name}}: </td><td>{{yAxis}}</td></tr>{{/each}}</table>'===r.get("Overlay.CustomTooltip")&&r.set("Overlay.CustomTooltip",'<table><thead><tr><th>{{this.0.0.xAxis}}</th><th></th></tr></thead>{{#each this}}{{#each this}}<tr><td width="{{width}}"><i class="{{icon}}" style="color:{{color}}; {{image}};"></i> {{name}}: </td><td>{{yAxis}}</td></tr>{{/each}}{{/each}}</table>'),r.get("Overlay.ShowAllPoints")||r.set("Overlay.ShowAllPoints",!1),r.get("Overlay.GroupByLayer")||r.set("Overlay.GroupByLayer",!1),_.each(r.get("Layers"),function(t,e){r.get("Layers."+e+".Enabled")||r.set("Layers."+e+".Enabled",!0),r.get("Layers."+e+".Opacity")||r.set("Layers."+e+".Opacity",80);var i="Layers."+e+".BarWidth",n="Layers."+e+".BarFixedWidth",e="Layers."+e+".BarWidthType";r.get(i)&&!r.get(n)&&(r.set(i,100*r.get(i)),r.set(e,"Percentage"),r.set(n,10))})}},{version:"4.6.0a",fn:function(n){_.each(n.get("Layers"),function(t,e){var i;void 0===n.get("Layers."+e+".ScaleOnZoom")&&(i=n.get("Layers."+e+".PointSize"),n.set("Layers."+e+".ScaleOnZoom",!0),n.set("Layers."+e+".RadiusData","Fixed Size"),n.set("Layers."+e+".RadiusScaling",i),n.unset("Layers."+e+".PointSize"))});'<table><thead><tr><th>{{this.0.0.xAxis}}</th><th></th></tr></thead>{{#each this}}{{#each this}}<tr><td width="{{width}}"><i class="{{icon}}" style="color:{{color}}; {{image}};"></i> {{name}}: </td><td>{{yAxis}}</td></tr>{{/each}}{{/each}}</table>'===n.get("Overlay.CustomTooltip")&&n.set("Overlay.CustomTooltip",l.CUSTOM_TOOLTIP_DEFAULT),n.get("Layers").forEach(function(t,e){"Line"===n.get("Layers."+e+"._Type")&&(n.get("Layers."+e+".Fill")||(n.set("Layers."+e+".Fill","No Fill"),n.set("Layers."+e+".FillColor","#0061FF"),n.set("Layers."+e+".FillOpacity",80)),"Line"===n.get("Layers."+e+"._Type")&&void 0===n.get("Layers."+e+".FadeToTransparent")&&n.set("Layers."+e+".FadeToTransparent",!1))})}},{version:"4.6.0b",fn:function(t){void 0===t.get("Overlay.ShowCoordinates")&&t.set("Overlay.ShowCoordinates",!0),void 0===t.get("Overlay.SnapToPoint")&&t.set("Overlay.SnapToPoint",!0)}},{version:"4.6.0c",fn:function(i){i.get("Layers").forEach(function(t,e){void 0===t.ColorData&&(i.set("Layers."+e+".possibleColorColumns",["None"]),i.set("Layers."+e+".ColorData","None")),void 0===t.Palette&&(t=i.get("Palette")||l.PALETTE_DEFAULT,i.set("Layers."+e+".Palette",t))}),i.get("Xaxes").forEach(function(t,e){void 0===t.Format.BeginAtZero&&i.set("Xaxes."+e+".Format.BeginAtZero",!1)}),i.get("Yaxes").forEach(function(t,e){void 0===t.Format.BeginAtZero&&i.set("Yaxes."+e+".Format.BeginAtZero",!1)})}},{version:"4.6.0d",fn:function(i){i.get("Layers").forEach(function(t,e){e="Layers."+e;void 0===t.Palette&&(t=i.get("Palette")||l.PALETTE_DEFAULT,i.set(e+".Palette",t)),"No Fill"===i.get(e+".Fill")&&(i.set(e+".FillColor",void 0),i.set(e+".Fade",void 0),i.set(e+".FillOpacity",void 0))})}}],l);function l(){}var h=(u.app=e.template({compiler:[7,">= 4.0.0"],main:function(t,e,i,n,r){var o;return'<canvas class="axis"></canvas>\n<canvas id='+t.escapeExpression("function"==typeof(o=null!=(o=i.uid||(null!=e?e.uid:e))?o:i.helperMissing)?o.call(null!=e?e:t.nullContext||{},{name:"uid",hash:{},data:r}):o)+'></canvas>\n<div class="legend-div"></div>\n<svg class="overlay">\n    <defs>\n        <marker id="sArrow" markerWidth="9" markerHeight="6" orient="auto" refY="3" refX="0">\n            <path d="M7,0 L7,6 L0,3 z"></path>\n        </marker>\n        <marker id="eArrow" markerWidth="9" markerHeight="6" orient="auto" refY="3" refX="7">\n            <path d="M0,0 L0,6 L7,3 z"></path>\n        </marker>\n    </defs>\n</svg>\n<div class="GL-highlight-rule"></div>\n<img />'},useData:!0}),u.dualVertex=e.template({1:function(t,e,i,n,r){return"#version 300 es"},3:function(t,e,i,n,r,o,a){var s=null!=e?e:t.nullContext||{},l=i.helperMissing,h="function",u=t.escapeExpression;return(null!=(a=i.if.call(s,null!=a[1]?a[1].isWebGL2:a[1],{name:"if",hash:{},fn:t.program(4,r,0,o,a),inverse:t.program(6,r,0,o,a),data:r}))?a:"")+" "+u(typeof(a=null!=(a=i.vt||(null!=e?e.vt:e))?a:l)==h?a.call(s,{name:"vt",hash:{},data:r}):a)+" "+u(typeof(a=null!=(a=i.name||(null!=e?e.name:e))?a:l)==h?a.call(s,{name:"name",hash:{},data:r}):a)+"_position;\nuniform "+u(typeof(a=null!=(a=i.ut||(null!=e?e.ut:e))?a:l)==h?a.call(s,{name:"ut",hash:{},data:r}):a)+" "+u(typeof(a=null!=(a=i.name||(null!=e?e.name:e))?a:l)==h?a.call(s,{name:"name",hash:{},data:r}):a)+"_u_min;\nuniform "+u(typeof(a=null!=(a=i.ut||(null!=e?e.ut:e))?a:l)==h?a.call(s,{name:"ut",hash:{},data:r}):a)+" "+u(typeof(a=null!=(a=i.name||(null!=e?e.name:e))?a:l)==h?a.call(s,{name:"name",hash:{},data:r}):a)+"_u_max;\n"},4:function(t,e,i,n,r){return"in"},6:function(t,e,i,n,r){return"attribute"},8:function(t,e,i,n,r){var o,a=null!=e?e:t.nullContext||{};return(null!=(o=i.if.call(a,null!=e?e.isWebGL2:e,{name:"if",hash:{},fn:t.program(4,r,0),inverse:t.program(6,r,0),data:r}))?o:"")+" vec4 h_color;\n"+(null!=(o=i.if.call(a,null!=e?e.isWebGL2:e,{name:"if",hash:{},fn:t.program(9,r,0),inverse:t.program(11,r,0),data:r}))?o:"")+" lowp vec4 v_color;\n"},9:function(t,e,i,n,r){return"out"},11:function(t,e,i,n,r){return"varying"},13:function(t,e,i,n,r){return"vec2 ds_sub (vec2 dsa, vec2 dsb) {\n    vec2 dsc;\n    float e, t1, t2;\n    t1 = dsa.x - dsb.x;\n    e = t1 - dsa.x;\n    t2 = ((-dsb.x - e) + (dsa.x - (t1 - e))) + dsa.y - dsb.y;\n    dsc.x = t1 + t2;\n    dsc.y = t2 - (dsc.x - t1);\n    return dsc;\n}\n\nvec2 ds_div(vec2 dsa, vec2 dsb)\n{\n    vec2 dsc;\n    float c11, c21, c2, e, s1, s2, t1, t2, t11, t12, t21, t22;\n    float a1, a2, b1, b2, cona, conb, split = 8193.;\n\n    // Compute a DP approximation to the quotient.\n    s1 = dsa.x / dsb.x;\n\n    // On systems with a fused multiply add, such as IBM systems, it is faster to\n    // uncomment the next two lines and comment out the following lines until !>.\n    // On other systems, do the opposite.\n    //  c11 = s1 * dsb(1)\n    // c21 = s1 * dsb(1) - c11\n    cona = s1 * split;\n    conb = dsb.x * split;\n    a1 = cona - (cona - s1);\n    b1 = conb - (conb - dsb.x);\n    a2 = s1 - a1;\n    b2 = dsb.x - b1;\n\n    // Multiply s1 * dsb.x using Dekker's method.\n    c11 = s1 * dsb.x;\n    c21 = (((a1 * b1 - c11) + a1 * b2) + a2 * b1) + a2 * b2;\n\n    // Compute s1 * dsb.y (only high-order word is needed).\n    c2 = s1 * dsb.y;\n    \n    // Compute (c11, c21) + c2 using Knuth's trick.\n    t1 = c11 + c2;\n    e = t1 - c11;\n    t2 = ((c2 - e) + (c11 - (t1 - e))) + c21;\n\n    // The result is t1 + t2, after normalization.\n    t12 = t1 + t2;\n    t22 = t2 - (t12 - t1);\n\n    // Compute dsa - (t12, t22) using Knuth's trick.\n    t11 = dsa.x - t12;\n    e = t11 - dsa.x;\n    t21 = ((-t12 - e) + (dsa.x - (t11 - e))) + dsa.y - t22;\n\n    // Compute high-order word of (t11, t21) and divide by dsb(1).\n    s2 = (t11 + t21) / dsb.x;\n    \n    // The result is s1 + s2, after normalization.\n    dsc.x = s1 + s2;\n    dsc.y = s2 - (dsc.x - s1);\n\n    return dsc;\n}\n"},15:function(t,e,i,n,r){var o,a=null!=e?e:t.nullContext||{},s=i.helperMissing;return(null!=(o=(i.eq||e&&e.eq||s).call(a,null!=e?e.vt:e,"uint",{name:"eq",hash:{},fn:t.program(16,r,0),inverse:t.noop,data:r}))?o:"")+(null!=(o=(i.eq||e&&e.eq||s).call(a,null!=e?e.vt:e,"int",{name:"eq",hash:{},fn:t.program(18,r,0),inverse:t.noop,data:r}))?o:"")+(null!=(o=(i.eq||e&&e.eq||s).call(a,null!=e?e.vt:e,"float",{name:"eq",hash:{},fn:t.program(20,r,0),inverse:t.noop,data:r}))?o:"")+(null!=(o=(i.eq||e&&e.eq||s).call(a,null!=e?e.vt:e,"vec2",{name:"eq",hash:{},fn:t.program(22,r,0),inverse:t.noop,data:r}))?o:"")},16:function(t,e,i,n,r){var o=null!=e?e:t.nullContext||{},a=i.helperMissing,s="function",l=t.escapeExpression;return"    float "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_range = float(int("+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_max) - int("+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_min));\n    float "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"a = float(int("+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_position) - "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_min);\n    zeroToOne."+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+" = "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"a / "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_range;\n"},18:function(t,e,i,n,r){var o=null!=e?e:t.nullContext||{},a=i.helperMissing,s="function",l=t.escapeExpression;return"    float "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_range = float(int("+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_max) - int("+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_min));\n    float "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"a = float("+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_position - "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_min);\n    zeroToOne."+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+" = "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"a / "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_range;\n"},20:function(t,e,i,n,r){var o=null!=e?e:t.nullContext||{},a=i.helperMissing,s="function",l=t.escapeExpression;return"    float "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_range = float("+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_max - "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_min);\n    zeroToOne."+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+" = ("+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_position - "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_min) / "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_range;\n"},22:function(t,e,i,n,r){var o=null!=e?e:t.nullContext||{},a=i.helperMissing,s="function",l=t.escapeExpression;return"    vec2 "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_range = ds_sub("+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_max, "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_min);  \n    vec2 "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_position2 = ds_sub("+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_position, "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_min);             \n    vec2 "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_zeroToOne = ds_div("+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_position2,"+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_u_range);\n    zeroToOne."+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+" = "+l(typeof(t=null!=(t=i.name||(null!=e?e.name:e))?t:a)==s?t.call(o,{name:"name",hash:{},data:r}):t)+"_zeroToOne.x;\n"},24:function(t,e,i,n,r){return"    gl_PointSize = pointSize;\n    "},26:function(t,e,i,n,r){return" gl_PointSize = u_point_size;\n"},28:function(t,e,i,n,r){return"    v_color = h_color;\n"},compiler:[7,">= 4.0.0"],main:function(t,e,i,n,r,o,a){var s,l=null!=e?e:t.nullContext||{};return(null!=(s=i.if.call(l,null!=e?e.isWebGL2:e,{name:"if",hash:{},fn:t.program(1,r,0,o,a),inverse:t.noop,data:r}))?s:"")+"\n\n"+(null!=(s=i.each.call(l,null!=e?e.axis:e,{name:"each",hash:{},fn:t.program(3,r,0,o,a),inverse:t.noop,data:r}))?s:"")+"\n"+(null!=(s=i.if.call(l,null!=e?e.isColored:e,{name:"if",hash:{},fn:t.program(8,r,0,o,a),inverse:t.noop,data:r}))?s:"")+"\nuniform float u_point_size;\n"+(null!=(s=i.if.call(l,null!=e?e.isWebGL2:e,{name:"if",hash:{},fn:t.program(4,r,0,o,a),inverse:t.program(6,r,0,o,a),data:r}))?s:"")+" float pointSize;\n\n"+(null!=(s=i.if.call(l,null!=e?e.math:e,{name:"if",hash:{},fn:t.program(13,r,0,o,a),inverse:t.noop,data:r}))?s:"")+"\nvoid main() {\n    vec2 zeroToOne;\n"+(null!=(s=i.each.call(l,null!=e?e.axis:e,{name:"each",hash:{},fn:t.program(15,r,0,o,a),inverse:t.noop,data:r}))?s:"")+"\n    // 32-bit below here                \n    // convert from 0->1 to 0->2\n    vec2 zeroToTwo = zeroToOne * 2.0;\n\n    // convert from 0->2 to -1->+1 (clip space)\n    vec2 clipSpace = zeroToTwo - 1.0;\n\n    gl_Position = vec4(clipSpace, 0, 1);\n\n"+(null!=(s=i.if.call(l,null!=e?e.isSize:e,{name:"if",hash:{},fn:t.program(24,r,0,o,a),inverse:t.program(26,r,0,o,a),data:r}))?s:"")+"\n"+(null!=(s=i.if.call(l,null!=e?e.isColored:e,{name:"if",hash:{},fn:t.program(28,r,0,o,a),inverse:t.noop,data:r}))?s:"")+"}\n"},useData:!0,useDepths:!0}),u.fragment=e.template({1:function(t,e,i,n,r){return"#version 300 es"},3:function(t,e,i,n,r){return(null!=(r=i.if.call(null!=e?e:t.nullContext||{},null!=e?e.isWebGL2:e,{name:"if",hash:{},fn:t.program(4,r,0),inverse:t.program(6,r,0),data:r}))?r:"")+" vec4 v_color;\n"},4:function(t,e,i,n,r){return"in"},6:function(t,e,i,n,r){return"varying"},8:function(t,e,i,n,r){return"uniform vec4 a_color; \n"},10:function(t,e,i,n,r){return"out vec4 outColor;\n"},12:function(t,e,i,n,r){return"uniform sampler2D spriteTexture;\n"},14:function(t,e,i,n,r){return"outColor"},16:function(t,e,i,n,r){return"gl_FragColor"},18:function(t,e,i,n,r){return"texture"+(null!=(r=i.unless.call(null!=e?e:t.nullContext||{},null!=e?e.isWebGL2:e,{name:"unless",hash:{},fn:t.program(19,r,0),inverse:t.noop,data:r}))?r:"")+"(spriteTexture, gl_PointCoord) * "},19:function(t,e,i,n,r){return"2D"},21:function(t,e,i,n,r){return"v_color"},23:function(t,e,i,n,r){return"a_color"},compiler:[7,">= 4.0.0"],main:function(t,e,i,n,r){var o,a=null!=e?e:t.nullContext||{};return(null!=(o=i.if.call(a,null!=e?e.isWebGL2:e,{name:"if",hash:{},fn:t.program(1,r,0),inverse:t.noop,data:r}))?o:"")+"\n\n// fragment shaders don't have a default precision so we need\n// to pick one. mediump is a good default\n\nprecision mediump float;\n\n"+(null!=(o=i.if.call(a,null!=e?e.isColored:e,{name:"if",hash:{},fn:t.program(3,r,0),inverse:t.program(8,r,0),data:r}))?o:"")+"\n"+(null!=(o=i.if.call(a,null!=e?e.isWebGL2:e,{name:"if",hash:{},fn:t.program(10,r,0),inverse:t.noop,data:r}))?o:"")+"\n"+(null!=(o=i.if.call(a,null!=e?e.isTextured:e,{name:"if",hash:{},fn:t.program(12,r,0),inverse:t.noop,data:r}))?o:"")+"\nvoid main() {\n    "+(null!=(o=i.if.call(a,null!=e?e.isWebGL2:e,{name:"if",hash:{},fn:t.program(14,r,0),inverse:t.program(16,r,0),data:r}))?o:"")+" = "+(null!=(o=i.if.call(a,null!=e?e.isTextured:e,{name:"if",hash:{},fn:t.program(18,r,0),inverse:t.noop,data:r}))?o:"")+(null!=(o=i.if.call(a,null!=e?e.isColored:e,{name:"if",hash:{},fn:t.program(21,r,0),inverse:t.program(23,r,0),data:r}))?o:"")+";\n}\n"},useData:!0}),u.highlightRule=e.template({1:function(t,e,i,n,r){var o=null!=e?e:t.nullContext||{},a=i.helperMissing,s="function",l=t.escapeExpression;return'    <li><svg style="background:'+l(typeof(t=null!=(t=i.ruleColor||(null!=e?e.ruleColor:e))?t:a)==s?t.call(o,{name:"ruleColor",hash:{},data:r}):t)+'; margin-right:4px;" width="15" height="16"></svg>\n    <span style="color:'+l(typeof(t=null!=(t=i.color||(null!=e?e.color:e))?t:a)==s?t.call(o,{name:"color",hash:{},data:r}):t)+'">'+l(typeof(t=null!=(t=i.ruleName||(null!=e?e.ruleName:e))?t:a)==s?t.call(o,{name:"ruleName",hash:{},data:r}):t)+"</span></li>\n"},compiler:[7,">= 4.0.0"],main:function(t,e,i,n,r){return'<ul class="chartgl-highlight-rule">\n'+(null!=(r=i.each.call(null!=e?e:t.nullContext||{},e,{name:"each",hash:{},fn:t.program(1,r,0),inverse:t.noop,data:r}))?r:"")+"</ul>"},useData:!0}),u.legend=e.template({1:function(t,e,i,n,r){var o=null!=e?e:t.nullContext||{},a=i.helperMissing,s="function",l=t.escapeExpression;return"    <li>"+(null!=(t=i.if.call(o,null!=e?e.icon:e,{name:"if",hash:{},fn:t.program(2,r,0),inverse:t.program(4,r,0),data:r}))?t:"")+'      <span style="color:'+l(typeof(t=null!=(t=i.color||(null!=e?e.color:e))?t:a)==s?t.call(o,{name:"color",hash:{},data:r}):t)+"; text-decoration:"+l(typeof(t=null!=(t=i.strike||(null!=e?e.strike:e))?t:a)==s?t.call(o,{name:"strike",hash:{},data:r}):t)+'">'+l(typeof(t=null!=(t=i.text||(null!=e?e.text:e))?t:a)==s?t.call(o,{name:"text",hash:{},data:r}):t)+"</span>\n    </li>\n"},2:function(t,e,i,n,r){var o=null!=e?e:t.nullContext||{},a=i.helperMissing,s="function",l=t.escapeExpression;return'\n            <svg width="'+l(typeof(t=null!=(t=i.width||(null!=e?e.width:e))?t:a)==s?t.call(o,{name:"width",hash:{},data:r}):t)+'" height="'+l(typeof(t=null!=(t=i.width||(null!=e?e.width:e))?t:a)==s?t.call(o,{name:"width",hash:{},data:r}):t)+'" style="padding:2px">\n              <i style="height:'+l(typeof(t=null!=(t=i.width||(null!=e?e.width:e))?t:a)==s?t.call(o,{name:"width",hash:{},data:r}):t)+"px;color:"+l(typeof(t=null!=(t=i.fillStyle||(null!=e?e.fillStyle:e))?t:a)==s?t.call(o,{name:"fillStyle",hash:{},data:r}):t)+";margin-top:2.5px;margin-right:5px;"+l(typeof(t=null!=(t=i.image||(null!=e?e.image:e))?t:a)==s?t.call(o,{name:"image",hash:{},data:r}):t)+'"class="fa '+l(typeof(t=null!=(t=i.icon||(null!=e?e.icon:e))?t:a)==s?t.call(o,{name:"icon",hash:{},data:r}):t)+'"></i>\n            </svg>\n'},4:function(t,e,i,n,r){return'            <svg width="10" height="10"  style="margin-left:14.5px;margin-right:2.8px;margin-top: 2px;padding:2px">\n'+(null!=(r=i.if.call(null!=e?e:t.nullContext||{},null!=e?e.bullColor:e,{name:"if",hash:{},fn:t.program(5,r,0),inverse:t.program(7,r,0),data:r}))?r:"")+"              </svg>\n"},5:function(t,e,i,n,r){var o=null!=e?e:t.nullContext||{},a=i.helperMissing,s="function",l=t.escapeExpression;return'                <rect height="10" width="1.5" x="6.8" fill="'+l(typeof(t=null!=(t=i.fillStyle||(null!=e?e.fillStyle:e))?t:a)==s?t.call(o,{name:"fillStyle",hash:{},data:r}):t)+'" />\n                <rect height="5" width="5" x="5" y="2.5" fill="'+l(typeof(t=null!=(t=i.bullColor||(null!=e?e.bullColor:e))?t:a)==s?t.call(o,{name:"bullColor",hash:{},data:r}):t)+'" />\n'},7:function(t,e,i,n,r){var o=null!=e?e:t.nullContext||{},a=i.helperMissing,s="function",l=t.escapeExpression;return'                <rect height="'+l(typeof(t=null!=(t=i.width||(null!=e?e.width:e))?t:a)==s?t.call(o,{name:"width",hash:{},data:r}):t)+'" width="'+l(typeof(t=null!=(t=i.width||(null!=e?e.width:e))?t:a)==s?t.call(o,{name:"width",hash:{},data:r}):t)+'" fill="'+l(typeof(t=null!=(t=i.fillStyle||(null!=e?e.fillStyle:e))?t:a)==s?t.call(o,{name:"fillStyle",hash:{},data:r}):t)+'" />\n'},compiler:[7,">= 4.0.0"],main:function(t,e,i,n,r){return'<ul class="chartgl-legend">\n'+(null!=(r=i.each.call(null!=e?e:t.nullContext||{},e,{name:"each",hash:{},fn:t.program(1,r,0),inverse:t.noop,data:r}))?r:"")+"</ul>"},useData:!0}),u);function u(){}var g=(c.prototype.getBarWidth=function(){return this.barWidth},c.prototype.getXBarPoints=function(i,t,e,n,r){var o=this,a=[],s=n.z-n.x;s||(l=.01*n.x,s=n.z+l-(n.x-l));var n=i.slice(1).map(function(t,e){return t-i[e]}),l=n.length?0:.01*s,n=n.length?G.getDistance(n,i):l,r=t/r*100;s=s?Math.abs(s+l+l):10;var h="Percentage"===e?n/2*t:s/100*r;return _.each(i,function(t,e){var i=t-h,t=t+h;a.push(i,i,t,i,t,t),e===Number(0)&&(i=G.convertJSToNumber(G.convertToJsScalar(o.tx,i)),t=G.convertJSToNumber(G.convertToJsScalar(o.tx,t)),o.barWidth=Math.abs(i-t))}),a},c.prototype.getYBarPoints=function(t){var e=[];return _.each(t,function(t){return e.push(0,t,0,t,0,t)}),e},c.prototype.getCandlesticks=function(r,o,a){var s=[],l=[];return r[0].forEach(function(t,e){var i=r[1][e],n=t===i&&a;n&&(t+=.002*o,i-=.002*o),s.push(t,i,t,i,t,i),a&&(e=Number(a[4]),i=n?a[2]:t<i?a[1]:a[0],e=ct.hexColorToVec4(i,e),l.push(Object.values(e)))}),[s,l]},c);function c(t,e){this.tx=t,this.tys=e,this.barWidth=0}var p=(d.prototype.getXLineFill=function(t){for(var e=[],i=0;i<t.length;i++){var n=t[i],r=t[i+1];e.push(n,n,r,n,r,r)}return e},d.prototype.getYLineFill=function(t,e){var i=[],n=e.fromBounds?Number(e.fromBounds.y):0,r=e.fromBounds?Number(e.fromBounds.w):0,o=e.toBounds?Number(e.toBounds.y):0,a=e.toBounds?Number(e.toBounds.w):0,s=_.min(t)||0,l=_.max(t)||0,h=n;s<0&&0<l||s<0&&l<0&&0<r?h=0:s<0&&l<0&&(h=r);for(var u=0;u<t.length;u++){var c,p=h,d=h;"Origin"!==e.fill&&(p=(y=e.cols[0])[u],d=y[u+1],c=new k(o,a),y=new k(n,r),_.isEqual(c,y)||(p=(r-n)*((p-o)/(f=a-o))+n,d=(r-n)*((d-o)/f)+n));var y=t[u],f=t[u+1];i.push(y,p,d,y,d,f)}return i},d);function d(){}var y,e=function(t,e,i){if(!(e=t.getUniformLocation(e,i)))throw new Error(i+" failed getUniformLocation");this.location=e},P=(i(x,y=e),x.prototype.set=function(t,e){t.uniform1f(this.location,e)},x);function x(){return null!==y&&y.apply(this,arguments)||this}var v,O=(i(S,v=e),S.prototype.set=function(t,e){t.uniform4f(this.location,e.x,e.y,e.z,e.w)},S);function S(){return null!==v&&v.apply(this,arguments)||this}R.MIN_KEY="_u_min",R.MAX_KEY="_u_max",e=R;function R(t,e,i){var n=t.getUniformLocation(e,i+R.MIN_KEY),e=t.getUniformLocation(e,i+R.MAX_KEY);if(!n||!e)throw new Error(i+" axis failed getUniformLocation");this.min=n,this.max=e}var b,T=(i(C,b=e),C.prototype.set=function(t,e){t.uniform1i(this.min,e.x),t.uniform1i(this.max,e.y)},C);function C(){return null!==b&&b.apply(this,arguments)||this}var L,A=(i(I,L=e),I.prototype.set=function(t,e){t.uniform1f(this.min,e.x),t.uniform1f(this.max,e.y)},I);function I(){return null!==L&&L.apply(this,arguments)||this}var E,D=(i(N,E=e),N.prototype.set=function(t,e){t.uniform2f(this.min,e.x,e.x-Math.fround(e.x)),t.uniform2f(this.max,e.y,e.y-Math.fround(e.y))},N);function N(){return null!==E&&E.apply(this,arguments)||this}var M=(F.prototype.apply=function(t,e){t.bindBuffer(t.ARRAY_BUFFER,e),t.enableVertexAttribArray(this.location),this.glType===WebGLRenderingContext.FLOAT?t.vertexAttribPointer(this.location,this.size,this.glType,!1,this.stride||0,this.offset||0):t.vertexAttribIPointer(this.location,this.size,this.glType,this.stride||0,this.offset||0)},F);function F(t,e,i,n,r){this.location=t,this.glType=e,this.size=i,this.stride=n,this.offset=r}var B,Y=(Object.defineProperty(X.prototype,"Program",{get:function(){return this.program},enumerable:!1,configurable:!0}),X.createBuffer=function(t,e){var i=t.createBuffer();if(!i)throw new Error("gl error creating buffer");return t.bindBuffer(t.ARRAY_BUFFER,i),t.bufferData(t.ARRAY_BUFFER,e,t.STATIC_DRAW),i},X.createTexture=function(t,e,i){var n=t.createTexture();if(!n)throw new Error("gl error creating texture");return t.activeTexture(t.TEXTURE0+i),t.bindTexture(t.TEXTURE_2D,n),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_S,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_WRAP_T,t.CLAMP_TO_EDGE),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MIN_FILTER,t.LINEAR_MIPMAP_LINEAR),t.texParameteri(t.TEXTURE_2D,t.TEXTURE_MAG_FILTER,t.LINEAR),t.texImage2D(t.TEXTURE_2D,0,t.RGBA,t.RGBA,t.UNSIGNED_BYTE,e),t.generateMipmap(t.TEXTURE_2D),n},X.getShader=function(t,e,i,n,r,o,a){var s=[i,n,r,o,a,t.canvas.id].join(":");return X.shaders[s]||(X.shaders[s]=new X(t,i,n,e,r,o,a)),this.shaders[s]},X.composeFragment=function(t,e,i,n){return h.fragment({isWebGL2:t,isTextured:e,isColored:i,isSize:n})},X.composeVertex=function(t,e,i,n,r){e={x:t,y:e};return h.dualVertex({isWebGL2:i,isColored:n,isSize:r,math:_.some(_.values(e),function(t){return G.isLong(t)||G.isDouble(t)}),axis:_.map(e,function(t,e){return _.extend(X.getShaderConfig(t),{name:e})})})},X.createProgram=function(t,e,i){var n=t.createProgram();if(!n)throw new Error("gl error creating program");if(t.attachShader(n,e),t.attachShader(n,i),t.linkProgram(n),t.getProgramParameter(n,t.LINK_STATUS))return n;i=t.getProgramInfoLog(n);throw t.deleteProgram(n),new Error("gl error linking program: "+i)},X.createShader=function(t,e,i){e=t.createShader(e);if(!e)throw new Error("gl error creating shader");if(t.shaderSource(e,i),t.compileShader(e),t.getShaderParameter(e,t.COMPILE_STATUS))return e;i=t.getShaderInfoLog(e);throw t.deleteShader(e),new Error("gl error compiling shader: "+i)},X.getShaderConfig=function(t){switch(t){case Z.Byte:case Z.Char:return{vt:"uint",ut:"int"};case Z.Short:case Z.Int:case Z.Month:case Z.Date:case Z.Minute:case Z.Second:case Z.Time:return{vt:"int",ut:"int"};case Z.Float:return{vt:"float",ut:"float"};case Z.Long:case Z.Double:case Z.Timestamp:case Z.DateTime:case Z.Timespan:return{vt:"vec2",ut:"vec2"};default:throw"Not implemented"}},X.prototype.remove=function(t){t.deleteProgram(this.program),t.deleteShader(this.vertexShader),t.deleteShader(this.fragmentShader)},X.prototype.setTexture=function(t,e){t.uniform1i(this.textureLocation,e)},X.prototype.createRange=function(t,e,i){return new(G.isDouble(t)||G.isLong(t)?D:G.isFloat(t)?A:T)(e,this.program,i)},X.prototype.getVertexBinding=function(t,e,i){var n=t.getAttribLocation(this.Program,i+"_position");switch(e){case Z.Byte:case Z.Char:return new M(n,t.UNSIGNED_BYTE,1);case Z.Short:return new M(n,t.SHORT,1);case Z.Int:case Z.Month:case Z.Date:case Z.Minute:case Z.Second:case Z.Time:return new M(n,t.INT,1);case Z.Float:return new M(n,t.FLOAT,1);case Z.Long:case Z.Double:case Z.Timestamp:case Z.DateTime:case Z.Timespan:return new M(n,t.FLOAT,2);default:throw"Not implemented"}},X.shaders={},X);function X(t,e,i,n,r,o,a){this.textureLocation=null;var s,l=X.composeVertex(e,i,n,o,a),n=X.composeFragment(n,r,o,a);this.vertexShader=X.createShader(t,t.VERTEX_SHADER,l),this.fragmentShader=X.createShader(t,t.FRAGMENT_SHADER,n),this.program=X.createProgram(t,this.vertexShader,this.fragmentShader),this.xRange=this.createRange(e,t,"x"),this.yRange=this.createRange(i,t,"y"),this.xBinding=this.getVertexBinding(t,e,"x"),this.yBinding=this.getVertexBinding(t,i,"y"),r&&(this.textureLocation=t.getUniformLocation(this.Program,"spriteTexture")),o?(s=t.getAttribLocation(this.Program,"h_color"),this.colorLocation=new M(s,t.FLOAT,4)):this.color=new O(t,this.Program,"a_color"),a?(s=t.getAttribLocation(this.Program,"pointSize"),this.sizeLocation=new M(s,t.FLOAT,1)):this.pointSize=new P(t,this.Program,"u_point_size")}Math.fround=Math.fround||(B=new Float32Array(1),function(t){return B[0]=t,B[0]});var k=(z.prototype.applyFn=function(t){return new z(t(this.x),t(this.y))},z);function z(t,e){this.x=t,this.y=e}var H=(W.fromVec2=function(t,e){return new W(t.x,e.x,t.y,e.y)},W.prototype.toString=function(){return _.map([this.x,this.y,this.z,this.w],function(t){return""+t}).join(",")},W.prototype.applyFn=function(t){return new W(t(this.x),t(this.y),t(this.z),t(this.w))},W);function W(t,e,i,n){this.x=t,this.y=e,this.z=i,this.w=n}var V,Z=w.ipc.TypeNum,G=(U.calculateCroppedBounds=function(t,e,i,n){function r(t,e,i){return e+(i-e)*t}var o=new k(r(t.x,e.x,e.z),r(t.z,e.x,e.z)),t=new k(r(t.y,e.y,e.w),r(t.w,e.y,e.w)),e=function(t){return new k(Math.floor(t.x),Math.ceil(t.y))};return i&&(U.isInt(i)||U.isLong(i))&&(o=e(o)),n&&(U.isInt(n)||U.isLong(n))&&(t=e(t)),new H(o.x,t.x,o.y,t.y)},U.calculateCroppedJsBounds=function(t,e,i,n){var r=U.scaleJs(t.x,e.x,e.z),o=U.scaleJs(t.z,e.x,e.z),a=U.scaleJs(t.y,e.y,e.w),e=U.scaleJs(t.w,e.y,e.w),o=U.calculatePrecision(i,new k(r,o)),e=U.calculatePrecision(n,new k(a,e));return new H(o.x,e.x,o.y,e.y)},U.calculatePrecision=function(e,t){var i,n;return e&&(U.isInt(e)||U.isLong(e))&&(i=t.applyFn(function(t){return U.convertJSToScalar(e,t)}),n=i,i=new k(Math.floor(Number(n.x)),Math.ceil(Number(n.y))),t=new k(U.convertToJsScalar(e,i.x),U.convertToJsScalar(e,i.y))),t},U.calculateCroppedJs2=function(t,e,i){var n=U.scaleJs(t.x,e.x,e.y),e=U.scaleJs(t.y,e.x,e.y),e=new k(n,e);return i?U.calculatePrecision(i,e):e},U.calculateCrop=function(t,e){e=new k(U.calcCrop(t.x,e.x,e.y),U.calcCrop(t.y,e.x,e.y));return new k(isNaN(e.x)?0:e.x,isNaN(e.y)?1:e.y)},U.calcCrop=function(t,e,i){return t=U.convertJSToNumber(t),e=U.convertJSToNumber(e),1-(t-(i=U.convertJSToNumber(i)))/(e-i)},U.calculateBoundsDiagonal=function(t){var e=t.z-t.x,t=t.w-t.y;return Math.sqrt(e*e+t*t)},U.calculateInset=function(t,e){var i=t.z-t.x,n=t.w-t.y,r=2*e;return new H(r<=n?t.x+e:t.x,r<=i?t.y+e:t.y,r<=n?t.z-e:t.z,r<=i?t.w-e:t.w)},U.calculateMergedRange=function(t){if(0===t.length)return null;if(1===t.length)return t[0];for(var e=t[0].x,i=t[0].y,n=1;n<t.length;n++)var r=t[n],e=U.min(e,r.x),i=U.max(i,r.y);return new k(e,i)},U.convertStringToScalar=function(t,e){if(isNaN(Number(t))){if(e){var i=e.fromString(t);return e.toScalar(i)}return t}return Number(t)},U.convertJSToNumber=function(t){return m.isMoment(t)||m.isDuration(t)?t.valueOfNano()/1e6:t},U.convertJSToScalar=function(t,e){var i,n=w.ipc,t=((i={})[Z.Date]=n.QDate,i[Z.DateTime]=n.DateTime,i[Z.Minute]=n.Minute,i[Z.Month]=n.Month,i[Z.Second]=n.Second,i[Z.Time]=n.Time,i[Z.Timespan]=n.Timespan,i[Z.Timestamp]=n.Timestamp,i)[t];if(t)return t.toScalar(t.fromMoment(e));if(m.isMoment(e)||m.isDuration(e))throw"Invalid Type Conversion";return e},U.convertStringToJsScalar=function(t,e){t=U.convertStringToScalar(t,U.ipcTemp(e));return U.convertToJsScalar(e,t)},U.convertToJsScalar=function(t,e,i){var n=w.ipc,r=((r={})[Z.Date]=n.QDate,r[Z.DateTime]=n.DateTime,r[Z.Minute]=n.Minute,r[Z.Month]=n.Month,r[Z.Second]=n.Second,r[Z.Time]=n.Time,r[Z.Timespan]=n.Timespan,r[Z.Timestamp]=n.Timestamp,r)[t];if(r){t===Z.Timespan&&(e=Number(e));t=U.isLong(t)&&w.Long.isLong(e)?w.Long.fromString(e.toString()):e;return i?r.fromScalar(t):w.Tools.convertKDBTemporalToMoment(r.fromScalar(t))}return Number(e)},U.convertVec2ToJsScalar=function(t,e,i){return new k(U.convertToJsScalar(e,t.x),U.convertToJsScalar(i,t.y))},U.convertVec4ToJsScalar=function(t,e,i){return new H(U.convertToJsScalar(e,t.x),U.convertToJsScalar(i,t.y),U.convertToJsScalar(e,t.z),U.convertToJsScalar(i,t.w))},U.convertVec4ToScalar=function(t,e,i){return new H(U.convertJSToScalar(e,t.x),U.convertJSToScalar(i,t.y),U.convertJSToScalar(e,t.z),U.convertJSToScalar(i,t.w))},U.dist=function(t,e){var i=t.x-e.x,e=t.y-e.y;return Math.sqrt(i*i+e*e)},U.expandNestedViewStates=function(t,e){var i=/([a-zA-Z]+)\.[0-9]+\./,n=Object.keys(t),r=[];if((r=_.every(function(t){t=e.getPropertyMeta(t[0]);return t&&"viewstate"===t.type})?_.uniq(_.filter(_.map(n,function(t){t=i.exec(t);return t?t[1]:null}))):r).length){var o={};return _.each(r,function(t){return o[t]=e.getProperty(t)}),o}return t},U.floatToEmulateDoubleArray=function(t){for(var e=2*t.length,i=new Float32Array(e),n=0,r=0;r<e;r+=2){var o=t.getScalar(n++);i[r]=o,i[r+1]=o-Math.fround(o)}return i},U.getDistance=function(t,e){for(var i=e[e.length-1]-e[0],n=t.length,r=1/0,o=1/0;n--;)r=t[n]<r&&0<t[n]?t[n]:r,o=Math.abs(t[n]<o&&t[n]<0?t[n]:o);var a=r<o?r:o;return a>i/e.length?a:i/e.length},U.getFormatter=function(i,n,r){return"Number"===i||"Formatted Number"===i||"Smart Number"===i?function(t){var e;if("Smart Number"!==i&&"Formatted Number"!==i||"string"==typeof t&&(t=/^(\-|\+)?([0-9]+(\.[0-9]+)?|Infinity)$/.test(t)?parseFloat(t):t),null==t)return"";if(e="Smart Number"===i?_.isNumber(t)?w.Tools.smartFormatNumber(t,n):_.escape(t):"number"==typeof t?"Formatted Number"===i?w.Tools.formatNumber(t,n):t.toFixed(n):_.escape(t),r&&0<=e.toString().indexOf(".")){for(;"0"===e[e.length-1];)e=e.slice(0,-1);e.indexOf(".")===e.length-1&&(e=e.slice(0,-1))}return e}:"General"===i?function(t){return m.isMoment(t)||m.isDuration(t)?t.format():_.escape(t)}:"Boolean"===i?function(t){return _.escape(t)}:function(t){return _.escape(t)}},U.getMajorPerformanceCaveat=function(t){var e=document.createElement("canvas");e.setAttribute("width","1"),e.setAttribute("height","1");var i=document.getElementsByTagName("body")[0];i.appendChild(e);t=e.getContext(t,{failIfMajorPerformanceCaveat:!0});return i.removeChild(e),!t},U.getValueFromObject=function(t){for(var e="",i=0;i<t.length;i++)e+=t.getValue(i);return e},U.ipcTemp=function(t){switch(t){case 12:return w.ipc.Timestamp;case 13:return w.ipc.Month;case 14:return w.ipc.QDate;case 15:return w.ipc.DateTime;case 16:return w.ipc.Timespan;case 17:return w.ipc.Minute;case 18:return w.ipc.Second;case 19:return w.ipc.Time}},U.isDouble=function(t){return-1!==U.DOUBLE_TYPES.indexOf(t)},U.isFloat=function(t){return t===Z.Float},U.isInt=function(t){return-1!==U.INT_TYPES.indexOf(t)},U.isLong=function(t){return-1!==U.LONG_TYPES.indexOf(t)},U.isRegexOrWild=function(t){t="object"==typeof t&&t.attributes?t.attributes.value:t;return!!t&&(0===t.indexOf("/")||-1!==t.indexOf("*"))},U.limitWithin=function(t,e,i){return t=U.toNumber(t),e=U.toNumber(e),i=U.toNumber(i),t<e?e:i<t?i:t},U.log10=function(t){return Math.log10?Math.log10(t):Math.log(t)/Math.LN10},U.longToEmulateDoubleArray=function(e){for(var t=2*e.length,i=new Float32Array(t),n=0,r="undefined"!=typeof BigInt?e.getScalar.bind(e):function(t){return e.getLegacyScalar(t).toString()},o=0;o<t;o+=2){var a=Number(r(n++));i[o]=a,i[o+1]=a-Math.fround(a)}return i},U.mergeRange=function(t){if(0<t.length){for(var e=t[0],i=1;i<t.length;i++)e=new k(U.minJs(e.x,t[i].x),U.maxJs(e.y,t[i].y));return e}},U.max=function(t,e){if(w.Long.isLong(t)){if(w.Long.isLong(e))return t.gt(e)?t:e;t=t.toNumber()}else w.Long.isLong(e)&&(e=e.toNumber());return e<t?t:e},U.maxJs=function(t,e){return m.isMoment(t)&&m.isMoment(e)?t.valueOfNano()>e.valueOfNano()?t:e:e<t?t:e},U.min=function(t,e){if(w.Long.isLong(t)){if(w.Long.isLong(e))return t.gt(e)?e:t;t=t.toNumber()}else w.Long.isLong(e)&&(e=e.toNumber());return e<t?e:t},U.minJs=function(t,e){return m.isMoment(t)&&m.isMoment(e)||m.isDuration(t)&&m.isDuration(e)?t.valueOfNano()>e.valueOfNano()?e:t:e<t?e:t},U.replaceViewStates=function(i,t,l,h){var u=function(t,e){return function i(t,e,n){n=n?n+".":"";e+="";var r=h.getPropertyMeta(n+e);var o=t&&t.has&&t.has("_dataSource")&&t.has("_dataType");var a=(_.isArray(t)||_.isObject(t))&&!o;{if(r&&"data"===r.type)return t;if(r&&"viewstate"===r.type){var s=(n+e).split("."),o=s.pop(),s=s.join(".");return l(s,void 0===o?"":o,t,r)}return a?(n+=e,u=function(t,e){return i(t,e,n)},(c=_.isArray(t)?_.map:_.mapValues)(t,u)):t}}(t,e,i||"")},c=_.isArray(t)?_.map:_.mapValues;return c(t,u)},U.replaceViewStatesWithValue=function(t,e,i){return U.replaceViewStates(t,e,function(t,e,i,n){return n.value,n.value},i)},U.intToFloat=function(t){for(var e=0,i=new Float32Array(t.length),n=0;n<t.length;n++){var r=t.getScalar(e++);i[n]=r}return i},U.toLong=function(t){return U.isIE11?w.Long.isLong(t)?t:new w.Long(Math.round(Number(t))):"bigint"==typeof t?t:BigInt(Math.round(t))},U.toNumber=function(t){return w.Long.isLong(t)?t.toNumber():"bigint"==typeof t?Number(t):t},U.calculateRelativePoint=function(t,e){return new k(U.calculateRelativeValue(t.x,e.x,e.z),U.calculateRelativeValue(t.y,e.y,e.w))},U.calculateRelativeValue=function(t,e,i){if(U.isIE11){var n=w.Long.isLong(t)?t.toNumber():Number(t),r=w.Long.isLong(e)?e.toNumber():Number(e);return(n-r)/((w.Long.isLong(i)?i.toNumber():Number(i))-r)}return(Number(t)-Number(e))/(Number(i)-Number(e))},U.scale=function(t,e,i){return e+t*(i-e)},U.scale2=function(t,e,i){return new k(e.x+t*(i.x-e.x),e.y+t*(i.y-e.y))},U.scale4=function(t,e,i){return new H(e.x+t*(i.x-e.x),e.y+t*(i.y-e.y),e.z+t*(i.z-e.z),e.w+t*(i.w-e.w))},U.scaleJs=function(t,e,i){if(m.isMoment(e)&&m.isMoment(i)){var n=e.valueOfNano()+t*(i.valueOfNano()-e.valueOfNano());return(r=m(n/1e6)).nanoseconds(n%1e6),r}if(m.isDuration(e)&&m.isDuration(i)){var r,n=e.valueOfNano()+t*(i.valueOfNano()-e.valueOfNano());return(r=m.duration(n/1e6)).nanoseconds(n%1e6),r}return Number(e)+t*(Number(i)-Number(e))},U.toS=function(t){return"number"!=typeof t&&t.toDashString?t.toDashString():t.toString?t.toString():""},U.xPart=function(t){return new k(t.x,t.z)},U.yPart=function(t){return new k(t.y,t.w)},U.isIE11=/Trident\/.*rv:11/.test(navigator.userAgent),U.isWebGL2="undefined"!=typeof WebGL2RenderingContext,U.glContext=U.isWebGL2?"webgl2":U.isIE11?"experimental-webgl":"webgl",U.isWebGLHWAcclEnabled=!U.getMajorPerformanceCaveat("webgl"),U.DOUBLE_TYPES=[Z.Double,Z.DateTime],U.INT_TYPES=[Z.Byte,Z.Short,Z.Int,Z.Char,Z.Month,Z.Date,Z.Minute,Z.Second],U.LONG_TYPES=[Z.Long,Z.Timespan,Z.Timestamp],U);function U(){}(e=V=V||{})[e.Nanosecond=0]="Nanosecond",e[e.Millisecond=1]="Millisecond",e[e.Second=2]="Second",e[e.Minute=3]="Minute",e[e.Hour=4]="Hour",e[e.Day=5]="Day",e[e.Month=6]="Month",e[e.Year=7]="Year";var J=(q.prototype.getBaseSize=function(t){return this.displayTitle?t+q.TICKSIZE+1.8*this.titleFontSize:(t+=2*q.TICKSIZE,this.width?t-(t-this.width):t)},q.prototype.getGridlines=function(){return{color:this.gridlinesColor,offset:this.gridlinesOffset,opacity:this.gridlinesOpacity}},q.prototype.getSimpleTicks=function(){var t=m.isMoment(this.bounds.x),e=m.isDuration(this.bounds.x),i=G.convertJSToNumber(this.bounds.x),n=G.convertJSToNumber(this.bounds.y);if(t||e){var r=[],o=this.determineUnitForAutoTicks(i,n,this.ticks),a=q.INTERVALS[o],s=o===V.Month||o===V.Year,l=s||o===V.Year;i/=a.size;for(var h,u,c=(n/=a.size)-i,t=this.niceNum(n-i,!1),o=t&&t<this.ticks-1?t:this.ticks-1,p=this.niceNum(t/o,!0),d=Math.floor(i/p)*p;d<=n;d+=p)i<=d&&(u=void 0,u=e?w.Tools.convertValueToDuration(d*a.size).format(l?"":a.format):(h=(s?d+1:d)*a.size,(this.type===Z.Date?m(h):w.Tools.convertValueToMoment(h)).format(a.format)),r.push({pos:(d-i)/c,label:this.prefix+u+this.suffix}));return r}return this.niceScale(i,n)},q.prototype.measureText=function(t,e){return t.font=this.fontSize+"px "+q.FONTFACE,t.measureText(e)},q.prototype.setRangeViewstate=function(t,e,i){var n=t?G.toS(t.x):"",t=t?G.toS(t.y):"";this.api.getPropertyMeta(e+"."+i+q.PROP_SEL_MIN).viewstateType&&this.api.setProperty(e+"."+i+q.PROP_SEL_MIN,n),this.api.getPropertyMeta(e+"."+i+q.PROP_SEL_MAX).viewstateType&&this.api.setProperty(e+"."+i+q.PROP_SEL_MAX,t)},q.prototype.updateBounds=function(t,e){_.isEqual(t,this.bounds)||(this.bounds=t,this.type=_.min(e))},q.prototype.niceNum=function(t,e){var i=Math.floor(G.log10(t)),t=t/Math.pow(10,i),t=e?t<1.5?1:t<3?2:t<7?5:10:t<=1?1:t<=2?2:t<=5?5:10;return t*Math.pow(10,i)},q.prototype.determineUnitForAutoTicks=function(t,e,i){var n,r=Number.MAX_SAFE_INTEGER||9007199254740991,o=this.getUnitFromLayer(this.type);for(n in V){var a=isNaN(Number(n))?V[n]:Number(n),s=q.INTERVALS[a],l=s.steps||r,s=Math.ceil((e-t)/(l*s.size)),l=Math.ceil((e-t)/(l*q.INTERVALS[o].size));if(s<=i){if(l<s)return o;if(Number(a)>=o)return a}}return V.Year},q.prototype.getUnitFromLayer=function(t){switch(t){case Z.Date:return V.Day;case Z.Month:return V.Month;case Z.Minute:return V.Minute;case Z.Second:return V.Second;case Z.Timespan:case Z.Timestamp:return V.Nanosecond;case Z.DateTime:case Z.Time:return V.Millisecond;default:return V.Year}},q.prototype.niceScale=function(t,e){for(var i=[],n=e-t,r=this.niceNum(e-t,!1),o=this.niceNum(r/(this.ticks-1),!0),a=Math.floor(t/o)*o,r=Math.max(-Math.floor(G.log10(o)),0),s=G.getFormatter(this.format,Math.max(r,this.decPlaces),this.hideTrailingZeroes),l=a;l<=e;l+=o)t<=l&&i.push({pos:(l-t)/n,label:this.prefix+s(l)+this.suffix});return i},q.FONTFACE="Segoe UI,Helvetica,Arial,sans-serif",q.PROP_BEGIN_ZERO=".Format.BeginAtZero",q.PROP_MIN=".Range.Min",q.PROP_MAX=".Range.Max",q.PROP_SEL_MIN=".Range.SelectionMin",q.PROP_SEL_MAX=".Range.SelectionMax",q.TICKSIZE=7,q.PROP_USE_MIN_MAX=".Range.UseMinMax",q.PROP_DISPLAY=".Format.Display",q.PROP_FONTSIZE=".Format.FontSize",q.PROP_FORMAT=".Format.Format",q.PROP_GRIDLINESCOLOR=".Gridlines.GridlinesColor",q.PROP_GRIDLINESOFFSET=".Gridlines.GridlinesOffset",q.PROP_GRIDLINESOPACITY=".Gridlines.GridlinesOpacity",q.PROP_HIDETRAIL=".Format.HideTrailingZeroes",q.PROP_POSITION=".Position",q.PROP_PRECISION=".Format.Precision",q.PROP_PREFIX=".Format.Prefix",q.PROP_SUFFIX=".Format.Suffix",q.PROP_TICKS=".Ticks",q.PROP_TITLEDISPLAY=".Title.Display",q.PROP_TITLESTRING=".Title.LabelString",q.PROP_TITLEFONTSIZE=".Title.FontSize",q.PROP_WIDTH=".Width",q.INTERVALS=[{common:!0,size:1e-6,steps:1e6,format:"H:mm:ss.SSSSSSSSS"},{common:!0,size:1,steps:1e3,format:"H:mm:ss.SSS"},{common:!0,size:1e3,steps:60,format:"H:mm:ss"},{common:!0,size:6e4,steps:60,format:"H:mm"},{common:!0,size:36e5,steps:24,format:"HH:mm"},{common:!0,size:864e5,steps:30,format:"YYYY-MM-DD"},{common:!0,size:2628e6,steps:12,format:"MMM YY"},{common:!0,size:3154e7,format:"Y"}],q);function q(t,e){this.bounds=new k(0,1),this.type=0,this.api=t,this.width=t.getProperty(e+q.PROP_WIDTH),this.displayTitle=t.getProperty(e+q.PROP_TITLEDISPLAY),this.display=t.getProperty(e+q.PROP_DISPLAY),this.gridlinesOpacity=t.getProperty(e+q.PROP_GRIDLINESOPACITY),this.gridlinesOffset=t.getProperty(e+q.PROP_GRIDLINESOFFSET),this.gridlinesColor=t.getProperty(e+q.PROP_GRIDLINESCOLOR),this.title=t.getProperty(e+q.PROP_TITLESTRING),this.titleFontSize=t.getProperty(e+q.PROP_TITLEFONTSIZE),this.ticks=t.getProperty(e+q.PROP_TICKS),this.fontSize=t.getProperty(e+q.PROP_FONTSIZE),this.position=t.getProperty(e+q.PROP_POSITION),this.prefix=t.getProperty(e+q.PROP_PREFIX),this.suffix=t.getProperty(e+q.PROP_SUFFIX),this.format=t.getProperty(e+q.PROP_FORMAT),this.decPlaces=t.getProperty(e+q.PROP_PRECISION),this.hideTrailingZeroes=t.getProperty(e+q.PROP_HIDETRAIL)}var j=function(t,e,i,n,r){this.layer=t,this.index=e,this.overpoint=i,this.yAxis=n,this.yIndex=r},K=(Q.prototype.drawCoordinates=function(t,e,i,n,r,o){var a=n.getElementsByClassName("xCoord")[0],s=n.getElementsByClassName("yCoord")[0];a||s||(a=this.setUpCoordinate(!0,n),s=this.setUpCoordinate(!1,n));var l,h,u=t.width*e.x,c=t.height*e.y;r&&(a.innerText===(h=this.formatData("Xaxis",r.val))&&"none"!==a.style.display||(a.style.display="block",l=a.offsetHeight,e=a.offsetWidth,r="Top"===r.position?i.y-l-3:t.height+i.y+3,t=u+i.x,u=e/2,a.style.top=(r+l>n.offsetHeight?r-l:r)+"px",a.style.left=(t-u<0?0:t+u>n.offsetWidth?n.offsetWidth-e:t-u)+"px",a.innerText=h)),o&&(s.innerText===(h=this.formatData("Yaxis",o.val))&&"none"!==s.style.display||(s.style.display="block",o="Right"===o.position?n.offsetWidth-i.z+3:i.x-s.offsetWidth-3,n=s.offsetHeight,s.style.top=c+i.y-n/2+"px",s.style.left=(o<0?0:o)+"px",s.innerText=h))},Q.prototype.hideCoordinates=function(t,e){var i=t.getElementsByClassName("yCoord")[0],t=t.getElementsByClassName("xCoord")[0];"x"===e&&t?t.style.display="none":"y"===e&&i?i.style.display="none":t&&i&&(i.style.display="none",t.style.display="none")},Q.prototype.updateTheme=function(t,e){var i=e.getElementsByClassName("xCoord")[0],n=e.getElementsByClassName("yCoord")[0];this.theme=t,i&&n&&(i.style.backgroundColor=t=(e="Light"===t)?"rgba(48, 48, 48, 0.9)":"rgba(248, 248, 248, 0.9)",i.style.color=e?"white":"black",n.style.backgroundColor=t,n.style.color=e?"white":"black")},Q.prototype.updateTooltipPalette=function(t){this.palette=t},Q.prototype.hideTooltip=function(){this.api.removeTooltip(),delete this.tooltip},Q.prototype.render=function(t,e,i,n){var r=this,o=t.width*e.overpoint.x+6,a=t.height*(1-e.overpoint.y)+6,s=this.api.getProperty(Q.PROP_GROUPBYLAYER),l=this.api.getProperty(Q.PROP_SHOWALLPOINTS),h=this.api.getProperty(Q.PROP_USECUSTOMTOOLTIP),u=this.api.getProperty(e.layer.indexProp(xt.PROP_XAXIS)),c=e;this.closestPointInfo=this.getRowData(c.layer,c.index,c.yAxis,c.yIndex);var c=e.layer.getRowData(c.index),p=c?c[u]:null,d=[],y=[];_.each(i,function(t){var e=r.api.getProperty(t.layer.indexProp(xt.PROP_XAXIS)),i=t.layer.getRowData(t.index),i=i?i[e]:null;null!==i&&(e=function(t){return t.i+""+(t.n||0===t.n?t.n:"")},(i="object"==typeof i&&i.i?e(i):i)===(p="object"==typeof p&&p.i?e(p):p)&&(s&&l&&!h?y.push(t):d.push(r.getRowData(t.layer,t.index,t.yAxis,t.yIndex))))}),s&&l&&!h&&(d=this.groupedLayers(n,y));t={text:h?this.api.getProperty(Q.PROP_CUSTOMTOOLTIP):f.TOOLTIP_DEFAULT,data:d,position:{top:a,left:o},anchorEl:t};return this.tooltip=this.api.setTooltip(t),c},Q.prototype.returnPointInfo=function(){return this.closestPointInfo},Q.prototype.formatData=function(t,e){var i=this.api.getProperty((t="Xaxis"===t?"Xaxes.0":"Yaxes.0")+Q.PROP_FORMAT),n=this.api.getProperty(t+Q.PROP_PRECISION),t=this.api.getProperty(t+Q.PROP_HIDETRAIL);return G.getFormatter(i,n,t)(e)},Q.prototype.formattedData=function(t,e){var n=t.getRowData(e);return n&&_.each(n,function(t,e){var i;w.Tools.isKDBTemporal(t)&&(i=w.Tools.convertKDBTemporalToMoment(t),n[e]=i.format(Q.FORMATS[t.class]))}),n},Q.prototype.getRowData=function(i,t,e,n,r){var o,a=this,s=this.api.getProperty(i.indexProp(xt.PROP_XAXIS)),l=this.api.getProperty(i.indexProp(xt.PROP_HIGHLIGHTRULES));i.isRegexOrWild()?(o=this.palette[i.index][n],(l&&l.length||i.hasColorData())&&(o=i.getColorArr(t,n))):(o=this.api.getProperty(i.indexProp(xt.PROP_COLOR)),(l&&l.length||i.hasColorData())&&(o=i.getColorArr(t)));var h=this.formattedData(i,t),u=i.getLayerName(),n=i.isRegexOrWild()?e:u,l=h?this.formatData("Xaxis",h[s]):"",t=h?this.formatData("Yaxis",h[e]):"",u=this.getWidth(n,12),s=this.getWidth(l,12),e=this.api.getProperty(i.indexProp(xt.PROP_ICON)),c={color:o,data:h,icon:e&&0===e.indexOf("fa")?"fa "+e:"fa fa-square",image:e&&0===e.indexOf("data:image/")?"width: 15px; content: url('"+e+"')":"",name:n,width:Math.max(u+30,s+30),xAxis:l,yAxis:t,grouped:r?_.map(r,function(t){return a.formatData("Yaxis",t)}):null};return i.isCandlestick()&&["Open","High","Low","Close"].forEach(function(t){var e=a.api.getProperty(i.indexProp(t));c[t.toLowerCase()]=h?a.formatData("Yaxis",h[e]):""}),c},Q.prototype.getWidth=function(t,e){var i=document.createElement("canvas").getContext("2d");if(!i)throw new Error("2d context not supported or canvas already initialized");return i.font=e+"px "+J.FONTFACE,i.measureText(t).width},Q.prototype.groupedLayers=function(n,o){var a=this,r=[],t=_.map(n,function(t){return t.layer.getAllCols()}),s=[];return _.each(t,function(t,e){var i=n[e];1===t.length?r.push(_.filter(o,function(t){return t.layer===i.layer&&t.yIndex===i.yIndex})):_.each(t,function(t,e){r.push(_.filter(o,function(t){return t.layer===i.layer&&t.yIndex===Number(e)}))})}),_.each(r,function(n,r){_.each(o,function(t){var e,i=n[0];i&&i.layer===t.layer&&(e=n[0].yAxis,t=_.map(n,function(t){t=a.formattedData(t.layer,t.index);return t?t[e]:null}),s[r]=a.getRowData(i.layer,i.index,i.yAxis,i.yIndex,t))})}),s.filter(function(t){return t})},Q.prototype.setUpCoordinate=function(t,e){var i=document.createElement("div");return i.className=t?"xCoord":"yCoord",i.style.borderRadius="3px",i.style.padding="3px",i.style.position="absolute",i.style.fontFamily="sans-serif",e.appendChild(i),this.updateTheme(this.theme,e),i},Q.PROP_CUSTOMTOOLTIP="Overlay.CustomTooltip",Q.PROP_USECUSTOMTOOLTIP="Overlay.UseCustomTooltip",Q.PROP_GROUPBYLAYER="Overlay.GroupByLayer",Q.PROP_SHOWALLPOINTS="Overlay.ShowAllPoints",Q.PROP_FORMAT=".Format.Format",Q.PROP_HIDETRAIL=".Format.HideTrailingZeroes",Q.PROP_PRECISION=".Format.Precision",Q.FORMATS={1212:"YYYY-MM-DD HH:mm:ss.SSSSSSSSS",1213:"YYYY-MM",1214:"YYYY-MM-DD",1215:"YYYY-MM-DD HH:mm:ss.SSS",1216:"YYYY-MM-DD HH:mm:ss.SSSSSSSSS",1217:"YYYY-MM-DD HH:mm",1218:"YYYY-MM-DD HH:mm:ss",1219:"YYYY-MM-DD HH:mm:ss.SSS"},Q);function Q(t){this.subscriptionKey="",this.palette=[],this.api=t}var $=(tt.prototype.hideCrosshair=function(t){var e=this.el.getElementsByClassName("crosshairX")[0],i=this.el.getElementsByClassName("crosshairY")[0],n=this.el.getElementsByClassName("crosshair-selected")[0];e&&this.el&&(e.setAttribute("visibility","hidden"),i.setAttribute("visibility","hidden"),"hide-both"===t&&n&&n.setAttribute("visibility","hidden"))},tt.prototype.render=function(t,e,i,n){this.margin=t,"click"===i&&(this.overpoint=e);var r=this.canvas.width*e.x,e=this.canvas.height*(1-e.y),n="Light"===n?"black":"white";this.api.getProperty(tt.PROP_CROSSHAIR)?(this.crosshairX?(this.crosshairX=this.el.getElementsByClassName("hover"===i?"crosshairX":"crosshair-selected")[0],this.crosshairY=this.el.getElementsByClassName("crosshairY")[0]):(this.crosshairX=document.createElementNS("http://www.w3.org/2000/svg","line"),this.crosshairY=document.createElementNS("http://www.w3.org/2000/svg","line"),"hover"===i?(this.crosshairX.setAttribute("class","crosshairX"),this.crosshairY.setAttribute("class","crosshairY")):this.crosshairX.setAttribute("class","crosshair-selected")),"number"==typeof r&&this.crosshairX&&isFinite(r)&&(this.setCrosshair(this.crosshairX,n,i),this.crosshairX.setAttribute("x1",r+""),this.crosshairX.setAttribute("y1","0"),this.crosshairX.setAttribute("x2",r+""),this.crosshairX.setAttribute("y2",this.canvas.height+t.y+"")),"number"==typeof e&&this.crosshairY&&isFinite(e)&&"hover"===i&&(this.setCrosshair(this.crosshairY,n),this.crosshairY.setAttribute("x1","0"),this.crosshairY.setAttribute("y1",e+""),this.crosshairY.setAttribute("x2",this.canvas.width+t.x+""),this.crosshairY.setAttribute("y2",e+""))):this.hideCrosshair("hide-both")},tt.prototype.onPan=function(t){var e;this.isSelected()&&this.crosshairX&&(e=Number(this.crosshairX.getAttribute("x1"))/this.canvas.width,this.setPosition(e+t),this.overpoint=new k(e+t,this.overpoint.y))},tt.prototype.updateSelected=function(t,e){var i;this.isSelected()&&(i=this.overpoint.x,e&&(e=t.y-t.x,i>t.x&&i<t.y?i=(i-t.x)/e:this.hideCrosshair("hide-both"),this.setPosition(i)))},tt.prototype.isSelected=function(){return this.crosshairX&&this.crosshairX===this.el.getElementsByClassName("crosshair-selected")[0]&&"visible"===this.crosshairX.getAttribute("visibility")},tt.prototype.setPosition=function(t){var e=this.canvas.width*t,i=this.canvas.height+this.margin.y+"";!isNaN(t)&&isFinite(e)&&this.crosshairX&&(this.crosshairX.setAttribute("x1",e+""),this.crosshairX.setAttribute("y1","0"),this.crosshairX.setAttribute("x2",e+""),this.crosshairX.setAttribute("y2",i))},tt.prototype.setCrosshair=function(t,e,i){t.setAttribute("visibility","visible"),t.setAttribute("opacity",.7),t.setAttribute("stroke",e),t.setAttribute("stroke-dasharray","click"===i?0:3),this.el.getElementsByClassName("overlay")[0].appendChild(t)},tt.SVG_NS="http://www.w3.org/2000/svg",tt.PROP_CROSSHAIR="Overlay.ShowCrosshairs",tt);function tt(t,e,i){this.el=t,this.api=e,this.canvas=i,this.crosshairX=null,this.crosshairY=null,this.overpoint=new k(0,1),this.margin=new H(0,0,1,1)}var et=(it.prototype.render=function(a){function s(t){return"object"==typeof t&&t.attributes?t.attributes.value:t}var l=[];_.each(this.api.getProperty("Layers"),function(t){_.each(_.filter(t.HighlightRules,function(t){return t.Show}),function(t){var e;if("gradient"===t.RuleType){if(!t.Palette.length)return;for(var i=t.Palette.map(function(t){return"object"==typeof t.type&&t.type.attributes?{type:t.type.attributes.value}:t}),n=new Array(i.length),r=0;r<i.length;r++){var o=(r/i.length*100).toFixed(2);n[r]=i[r].type+" "+o+"%"}e="linear-gradient(to right, "+n.join(", ")+")"}else e=s(t.RuleColor);l.push({ruleColor:e,ruleName:s(t.RuleName),color:a})})}),this.el.getElementsByClassName("GL-highlight-rule")[0].innerHTML=h.highlightRule(l)},it);function it(t,e){this.api=t,this.el=e}var nt=(rt.prototype.drawLegends=function(t){var u=this,c=[],p=this.color,d=o(this.layers);this.updatePalette(this.layers,!0),_.each(this.api.getProperty("Layers"),function(i,t){var n,r,e,o,a,s,l,h=d[t];u.disabledColumns[t]||(u.disabledColumns[t]=i.Enabled?[]:h.getAllCols()),u.api.getProperty("Layers."+t+".Legend")&&(n=u.api.getProperty("Layers."+t+".Icon"),r=h.isEnabled(),h.hasColorData()?(a=(e=h.getColorData())[0],o=e[1],a.forEach(function(t,e){c.push({fillStyle:o[e],icon:n,image:n&&0===n.indexOf("data:image/")?"content: url('"+n+"')":"",width:12,radius:6,text:t,color:p,strike:r?"":"line-through"})})):h.isRegexOrWild()?(a=h.getAllCols(),s=u.disabledColumns[t],l=h.getPaletteProperty(),_.each(a,function(t,e){c.push({fillStyle:l[e%l.length],icon:n,image:n&&0===n.indexOf("data:image/")?"content: url('"+n+"')":"",width:12,radius:6,text:t,color:p,strike:i.Enabled&&-1===s.indexOf(t)?"":"line-through"})})):c.push({fillStyle:u.api.getProperty("Layers."+t+(h.isCandlestick()?".CandlestickFormat.WickColor":".Color")),icon:n,image:n&&0===n.indexOf("data:image/")?"content: url('"+n+"')":"",width:12,radius:6,text:u.api.getProperty("Layers."+t+".Name"),color:p,strike:r?"":"line-through",bullColor:h.isCandlestick()?u.api.getProperty("Layers."+t+".CandlestickFormat.BullColor"):null}))});var e=this.el.getElementsByClassName("legend-div")[0];e.innerHTML=h.legend(c),t&&(this.onResize(t),e.style.top="5px",this.highlightRule.render(p),i=this.el.getElementsByClassName("chartgl-highlight-rule")[0].getBoundingClientRect().height,t.updateHeight(i));var r=[];_.each(d,function(t,e){var i=u.api.getProperty("Layers."+e+".Legend"),n=r.filter(function(t){return t}),n=n[n.length-1],t=t.isCandlestick()?1:t.getAllCols().length;r.push(i?t+(0<e&&n?n:0):0)});var i=this.el.getElementsByClassName("legend-div")[0].getElementsByTagName("li");_.each(i,function(t,e){return t.onclick=function(){return u.updateState(t,(i=e,n=0,_.each(r,function(t,e){if(i+1<=t)return n=e,!1}),n));var i,n}})},rt.prototype.getLayers=function(t){this.layers=t},rt.prototype.onResize=function(t){var e=this.api.getProperty("Layers").filter(function(t){return t.Legend}),i=this.el.getElementsByClassName("legend-div")[0];t.getLegend(e,i.getBoundingClientRect().height)},rt.prototype.updateTheme=function(t){this.color="Light"===t?"black":"white"},rt.prototype.updateWildcards=function(t,e,i,n){t&&(this.updatePalette([t]),this.disabledColumns[e]=i&&t.isEnabled()?[]:t.getAllCols(),t.updateColumns(this.disabledColumns[e],n))},rt.prototype.updatePalette=function(l,h){var u=this,c=[];_.each(this.api.getProperty("Layers"),function(e,i){e.Palette.forEach(function(t,e){""===t.type&&(t=(t=f.PALETTE_DEFAULT)[e%t.length],u.api.setProperty("Layers."+i+".Palette."+i,t))});var t=_.findIndex(l,function(t){return t.getId()===e._Id}),n=l[t],r=n?n.getPaletteProperty():[];if(n&&n.isRegexOrWild()){for(var o=[],a=n.getAllCols(),s=0;o.length<a.length;)o[s]=r[s%r.length],s++;t=u.disabledColumns[i];_.each(t,function(t){return o[a.indexOf(t)]=""}),o=o.filter(function(t){return 0<t.length}),n.updateLayerPalette(o,h),c[i]=o}else n&&(c[i]=[],u.disabledColumns[i]=[],n.updateLayerPalette(r),n.hasColorData()&&n.updateColumns([]))}),this.tooltips.updateTooltipPalette(c)},rt.prototype.updateState=function(t,e){var i=t.getElementsByTagName("span")[0],n=this.layers[e],r=n.isEnabled(),o=n.isRegexOrWild(),t=n.hasColorData();this.setIgnoreSettings(!0),""===i.style.textDecoration?(i.style.textDecoration="line-through",!o&&r&&this.api.setProperty("Layers."+e+".Enabled",!1),o&&(this.disabledColumns[e].length+1!==n.getAllCols().length&&!t||this.api.setProperty("Layers."+e+".Enabled",!1),t||this.disabledColumns[e].push(i.innerHTML))):(i.style.textDecoration="",r||this.api.setProperty("Layers."+e+".Enabled",!0),o&&(t?(this.api.setProperty("Layers."+e+".Enabled",!0),this.disabledColumns[e]=[]):this.disabledColumns[e].splice(this.disabledColumns[e].indexOf(i.innerHTML),1))),t&&this.drawLegends(),this.updateLayers(!0),o&&(this.updatePalette(this.layers),this.layers[e].updateColumns(this.disabledColumns[e])),this.setIgnoreSettings(!1),this.appInvalidate(Ot.Process)},rt);function rt(t,e,i,n,r,o){this.el=t,this.api=e,this.tooltips=i,this.appInvalidate=n,this.setIgnoreSettings=r,this.updateLayers=o,this.color="black",this.disabledColumns=[],this.layers=[],this.highlightRule=new et(this.api,this.el)}var ot=(at.prototype.onAxisPan=function(t,e){var i=t.clientX-e.left,n=t.clientY-e.top,r=e.right-t.clientX,o=e.bottom-t.clientY,a=this.axis.getMargin(),s=i<a.x,e=r<a.z,t=n<a.y,a=o<a.w,a=s?"Left":e?"Right":t?"Top":a?"Bottom":"";return[new H(i,n,r,o),a]},at.prototype.onPanning=function(t,e,i,n,r,o,a){var s="",l="Top"===e||"Bottom"===e,h="Left"===e||"Right"===e;this.activePan||(this.activePan=t),h?s=this.calculatePanDirection(t.y,"y",this.activePan):l&&(s=this.calculatePanDirection(t.x,"x",this.activePan)),s&&(e=l?a.offsetWidth:a.offsetHeight,a=this.pixelDiff/e,e=this.num-1,this.activePan=t,document.body.style.cursor=l?"e-resize":"n-resize",o=("Right"===s||"Left"===s?r:o)[e],i=i[e]||new k(0,1),n=n[e]||new k(0,1),i=(o.y-o.x)*(i.y-i.x)*a,n=(o.y-o.x)*(n.y-n.x)*a,i="Right"===s?-i:"Left"===s?i:0,n="Top"===s?-n:"Bottom"===s?n:0,n=new H(o.x+(l?i:0),o.x+(h?n:0),o.y+(l?i:0),o.y+(h?n:0)),this.onPan(n,"Right"===s?a:"Left"===s?-a:0,e,s))},at.prototype.onPointDown=function(t,e){this.activePan=t;var i="Top"===e||"Bottom"===e,n="Left"===e||"Right"===e,r=this.axis.getAxes("x"),o=this.axis.getAxes("y"),a=this.axis.getAxes("x","Top"),s=this.axis.getAxes("x","Bottom"),l=this.axis.getAxes("y","Left"),h=this.axis.getAxes("y","Right"),u=0,c=0,p=i?this.axis.getSize(e,"x"):n?this.axis.getSize(e,"y"):[];_.each(p,function(t,e){0<Number(e)&&(p[e]=p[Number(e)-1]+p[e])}),"Right"===e&&(u=t.z),"Left"===e&&(u=t.x),"Top"===e&&(u=t.y),"Bottom"===e&&(u=t.w),_.each(p,function(t,e){if(u<=t)return c=p.length-Number(e),!1}),"Right"===e&&(c=o.indexOf(h[c-1])+1),"Left"===e&&(c=o.indexOf(l[c-1])+1),"Top"===e&&(c=r.indexOf(a[c-1])+1),"Bottom"===e&&(c=r.indexOf(s[c-1])+1),this.num=c},at.prototype.calculatePanDirection=function(t,e,i){if("y"===e){if(this.pixelDiff=Math.abs(i.y-t),i.y<t)return"Bottom";if(i.y>t)return"Top"}else{if(this.pixelDiff=Math.abs(i.x-t),i.x<t)return"Right";if(i.x>t)return"Left"}return""},at);function at(t,e,i){this.api=t,this.axis=e,this.onPan=i,this.activePan=null,this.num=0,this.pixelDiff=0}var st=(lt.prototype.getAxes=function(t,i){return i?_.map(this[t],function(t,e){if(t.position===i)return Number(e)+1}).filter(function(t){return void 0!==t}):_.map(this[t],function(t,e){return Number(e)+1})},lt.prototype.getBounds=function(t,e,i,n){var r=this.api.getProperty(e+"."+i+J.PROP_BEGIN_ZERO),o=this.api.getProperty(e+"."+i+J.PROP_USE_MIN_MAX),a=this.api.getProperty(e+"."+i+J.PROP_MIN),i=this.api.getProperty(e+"."+i+J.PROP_MAX),a=/\S/.test(a)?a:t.x,i=/\S/.test(i)?i:t.y,n=o?new k(G.convertStringToJsScalar(a,n),G.convertStringToJsScalar(i,n)):t,t=t.y<0;return new k(r&&!t?0:n.x,r&&t?0:n.y)},lt.prototype.getLegend=function(t,e){_.some(t,function(t){return t})?this.legendHeight=e+5:this.legendHeight=0,this.renderAll=!0},lt.prototype.getMargin=function(){return this.margin},lt.prototype.getSelectionZoomBounds=function(t,e,i,n){var r=this.api.getProperty(e+"."+i+J.PROP_SEL_MIN),e=this.api.getProperty(e+"."+i+J.PROP_SEL_MAX),i=t?t.x:0,t=t?t.y:1,r=/\S/.test(r)?G.convertStringToScalar(r,G.ipcTemp(n)):"",e=/\S/.test(e)?G.convertStringToScalar(e,G.ipcTemp(n)):"";return"number"!=typeof r&&"bigint"!=typeof r||(i=G.convertToJsScalar(n,r)),"number"!=typeof e&&"bigint"!=typeof e||(t=G.convertToJsScalar(n,e)),new k(i,t)},lt.prototype.getSize=function(e,t){var n=this,i=("x"===t?this.x:this.y).filter(function(t){return t.position===e&&t.display});if("x"===t){var r="Top"===e?this.legendHeight+5:this.axisHeight;return _.map(i,function(t,e){return(t.display?t.getBaseSize(t.fontSize):0)+(0===e?r:0)})}var t=this.getWidth(i),o="Left"===e?0:this.margin.z-t;return _.map(i,function(t,e){var i=t.getSimpleTicks(),i=_.maxBy(i,function(t){return t.label.length}),i=t.measureText(n.ctx,(null==i?void 0:i.label)||"");return(t.display?t.getBaseSize(i.width):0)+(0===e?o:0)})},lt.prototype.onSettingsChange=function(t,e){"Xaxes"===t&&(this.x[e]=new J(this.api,"Xaxes."+e)),"Yaxes"===t&&(this.y[e]=new J(this.api,"Yaxes."+e)),this.renderAll=!0},lt.prototype.render=function(i,n,t,e){var r=this;this.x.length!==t.length&&(this.x=[],_.each(t,function(t,e){r.x[e]=new J(r.api,"Xaxes."+e)})),this.y.length!==e.length&&(this.y=[],_.each(e,function(t,e){r.y[e]=new J(r.api,"Yaxes."+e)}));var o=this.x.length&&_.some(this.x,function(t){return!0===t.display}),a=this.y.length&&_.some(this.y,function(t){return!0===t.display}),s=this.y.filter(function(t){return"Right"===t.position&&t.display}),l=i!==this.width||n!==this.height||this.renderAll;i!==this.width&&(this.width=i,this.canvas.width=i),n!==this.height&&(this.height=n,this.canvas.height=n),l&&(this.updateTheme(),this.ctx.clearRect(0,0,i,n));var h=_.some(this.x,function(t,e){return t.bounds&&r.xBounds[e]&&(t.bounds.x!==r.xBounds[e].x||t.bounds.y!==r.xBounds[e].y)}),u=_.some(this.y,function(t,e){return t.bounds&&r.yBounds[e]&&(t.bounds.x!==r.yBounds[e].x||t.bounds.y!==r.yBounds[e].y)});(l||u)&&a&&(f=this.margin,y=J.TICKSIZE,this.ctx.clearRect(0,f.y-y,f.x-J.TICKSIZE,n-f.y-f.w+2*y),this.ctx.clearRect(i-f.z+y,f.y-y,f.z+y,n-f.y-f.w+2*y),this.ctx.clearRect(f.x,f.y,i-f.z-f.x,n-f.y-f.w),this.ctx.clearRect(f.x-y,f.y-y,y+.5,n-f.y+2*y-f.w),this.ctx.clearRect(i-f.z-2,f.y-y-1,y+2,n-f.y+y-f.w+1),this.ctx.clearRect(i-f.z,f.y-1,y,n-f.y+J.TICKSIZE+1-f.w),_.each(e,function(t,e){r.api.getProperty("Yaxes."+e+J.PROP_DISPLAY)&&r.renderY(e,i,n)}));var c,p,d,y,f,g=this.m.x!==this.margin.x||this.m.z!==this.margin.z;(l||g||h)&&o&&(c=this.margin,p=J.TICKSIZE,d=this.calcTickWidth("Left"),u=this.calcTickWidth("Right"),a=_.some(this.y,function(t){return!0===t.display&&"Left"===t.position}),y=_.some(this.y,function(t){return!0===t.display&&"Right"===t.position}),f=_.some(this.x,function(t){return!0===t.display&&"Top"===t.position}),e=c.x-.5,o=c.z,d&&(d>c.x||!a)&&(e=d),u&&(u>c.z||!y)&&(o=d),this.ctx.clearRect(0,n-c.w+J.TICKSIZE,i,c.w-1+J.TICKSIZE),f&&this.ctx.clearRect(0,0,i,c.y-(!g||l||h?p:0)),this.ctx.clearRect(e,n-c.w,(o=y?i-e-o:i)+1,J.TICKSIZE),f&&this.ctx.clearRect(e,c.y-J.TICKSIZE,o+.5,J.TICKSIZE-1),_.each(t,function(t,e){r.api.getProperty("Xaxes."+e+J.PROP_DISPLAY)&&r.renderX(e,i,n)}));t=this.margin,s=s.length?i-t.x-t.z-2:i;return this.ctx.clearRect(t.x,t.y,s,n-t.w-t.y),this.drawXGridlines(i,n),this.drawYGridlines(i,n),this.ctx.globalAlpha=1,this.updateTheme(),_.each(this.x,function(t,e){return r.xBounds[e]=t.bounds}),_.each(this.y,function(t,e){return r.yBounds[e]=t.bounds}),this.m=this.margin,this.renderAll=!1,this.margin},lt.prototype.renderAxes=function(){this.renderAll=!0},lt.prototype.updateHeight=function(t){this.axisHeight=t},lt.prototype.updateTheme=function(t){this.theme=t||this.theme,"Light"===this.theme?(this.ctx.strokeStyle="#000000",this.ctx.fillStyle="#000000"):(this.ctx.strokeStyle="#ffffff",this.ctx.fillStyle="#ffffff")},lt.prototype.calcTickWidth=function(t){var i=this,e=0,t="Left"===t?_.map(this.x,function(t){return _.first(t.getSimpleTicks())}):_.map(this.x,function(t){return _.last(t.getSimpleTicks())});return t.length&&(t=_.map(t,function(t){return t?t.label:""}),(t=_.max(_.map(t,function(t,e){return i.x[e].measureText(i.ctx,t).width})))&&(e=Math.ceil(t/2)+1)),e},lt.prototype.drawXGridlines=function(h,u){var c=this;_.each(this.x,function(t){var e=t.getSimpleTicks(),i=h-c.margin.x-c.margin.z,n=t.getGridlines(),r=_.maxBy(e,function(t){return t.label.length}),r=t.measureText(c.ctx,(null==r?void 0:r.label)||"").width+12,r=0<Math.round(i/r)?Math.round(i/r):1,o=e.length>r?Math.round(e.length/r):1;c.ctx.beginPath(),c.ctx.strokeStyle=n.color,c.ctx.globalAlpha=void 0!==n.opacity?n.opacity/100:.15;for(var a=0;a<e.length;a+=o){var s=Math.round(c.margin.x+e[a].pos*i)+.5;0!==a||!n.offset||(l=s/2)>c.margin.x&&(c.ctx.moveTo(l,u-c.margin.w),c.ctx.lineTo(l,c.margin.y));var l=n.offset?a===e.length-1?c.canvas.width-c.margin.z:c.margin.x+e[a+1].pos*i:0,s=n.offset?s+Math.abs(s-l)/2:s;s<h-c.margin.z&&(c.ctx.moveTo(s,u-c.margin.w),c.ctx.lineTo(s,c.margin.y))}c.ctx.stroke(),c.ctx.closePath()})},lt.prototype.drawYGridlines=function(l,h){var u=this;_.each(this.y,function(t){var e=t.getSimpleTicks(),i=h-u.margin.w,n=i-u.margin.y,r=t.getGridlines();u.ctx.beginPath(),u.ctx.strokeStyle=r.color,u.ctx.globalAlpha=void 0!==r.opacity?r.opacity/100:.15;for(var o=0;o<e.length;o++){var a=Math.round(i-e[o].pos*n),s=r.offset?0===o?i:i-e[o-1].pos*n:0,a=r.offset?s-Math.abs(a-s)/2-.5:a+.5;u.ctx.moveTo(u.margin.x,a),u.ctx.lineTo(l-u.margin.z-2.5,a)}u.ctx.stroke(),u.ctx.closePath()})},lt.prototype.getHeight=function(t){return _.sumBy(t,function(t){return t.display?t.getBaseSize(t.fontSize):0})},lt.prototype.getWidth=function(t){var i=this;return _.sumBy(t,function(t){var e=t.getSimpleTicks(),e=_.maxBy(e,function(t){return t.label.length}),e=t.measureText(i.ctx,(null==e?void 0:e.label)||"");return t.display?t.getBaseSize(e.width):0})},lt.prototype.renderX=function(t,e,i){var n=this.x[t],r=n.getSimpleTicks(),o=_.some(this.y,function(t){return!0===t.display&&"Left"===t.position}),a=_.some(this.y,function(t){return!0===t.display&&"Right"===t.position}),s=o?this.margin.x:0,l="Top"===n.position,h=this.x.filter(function(t){return"Top"===t.position&&t.display}),u=this.x.filter(function(t){return"Bottom"===t.position&&t.display}),c=this.getHeight(h)+this.legendHeight+5,t=(t=this.getHeight(u)+this.axisHeight)||5,p=l?this.legendHeight+5+this.getHeight(h.slice(h.indexOf(n))):this.margin.y,d=l?0:this.getHeight(u.slice(u.indexOf(n)))+this.axisHeight,h=this.margin.z,u=function(t,e,i,n){return e<=t&&!i?t:e<=t&&i?n+(t-n):n},o=u(this.calcTickWidth("Left"),this.margin.x,o,s),a=u(this.calcTickWidth("Right"),this.margin.z,a,h),y=s=s<o?o:s,f=e-s-(h=h<a?a:h)-1,a=_.maxBy(r,function(t){return t.label.length}),a=n.measureText(this.ctx,(null==a?void 0:a.label)||"").width+12,a=0<Math.round(f/a)?Math.round(f/a):1,g=r.length>a?Math.ceil(r.length/a):1;this.ctx.beginPath(),this.ctx.moveTo(s-.5,l?p-.5:i-d+.5),this.ctx.lineTo(e-h-.5,l?p-.5:i-d+.5);for(var m=0;m<r.length;m+=g){var P=Math.round(y+r[m].pos*f)+.5;this.ctx.moveTo(P,.5+(l?p:i-d)),this.ctx.lineTo(P,.5+(l?p-J.TICKSIZE:i-d+J.TICKSIZE))}this.ctx.stroke(),this.ctx.closePath(),this.ctx.textBaseline=l?"bottom":"top",this.ctx.textAlign="center",this.ctx.font=n.fontSize+"px "+J.FONTFACE;for(m=0;m<r.length;m+=g)0===(P=y+r[m].pos*f)&&(P=10),this.ctx.fillText(r[m].label,P+.5,l?p-J.TICKSIZE-.5:i-d+J.TICKSIZE+.5);n.displayTitle&&(this.ctx.textBaseline="middle",this.ctx.font=n.titleFontSize+"px "+J.FONTFACE,this.ctx.fillText(n.title,(e+s-h)/2,l?p-n.titleFontSize-15:i-d+n.titleFontSize+15)),this.margin=new H(s,c,h,t)},lt.prototype.renderY=function(t,e,i){var n=this.y[t],r=this.x.length&&_.some(this.x,function(t){return t.display}),o="Left"===n.position,a=this.y.filter(function(t){return"Left"===t.position&&t.display}),s=this.y.filter(function(t){return"Right"===t.position&&t.display}),l=this.getWidth(a),h=this.getWidth(s),u=h,c=this.getHeight(this.x.filter(function(t){return"Bottom"===t.position})),p=this.getHeight(this.x.filter(function(t){return"Top"===t.position})),d=Math.round(r?c:5)+this.axisHeight,y=n.getSimpleTicks(),t=_.maxBy(y,function(t){return t.label.length}),r=n.measureText(this.ctx,(null==t?void 0:t.label)||""),c=p+(r.emHeightAscent||n.fontSize/2)+this.legendHeight,t=this.getWidth(a.slice(a.indexOf(n))),u=o?u:this.getWidth(s.slice(s.indexOf(n))),p=this.calcTickWidth("Left");p&&(a.length?l<p&&(l+=f=p-l,t+=f):l=p);var f,p=this.calcTickWidth("Right");p&&(s.length?h<p&&(h+=f=p-h,u+=f):h=p);var d=d||8,c=c||8,g=Math.floor(o?t:e-u)+.5,m=i-d,P=m-c;this.ctx.beginPath(),this.ctx.moveTo(g-1,c-2),this.ctx.lineTo(g-1,1+m);for(var x=0;x<y.length;x++){var v=Math.round(m-y[x].pos*P)+.5;this.ctx.moveTo(g-1,v),this.ctx.lineTo(o?g-J.TICKSIZE-1:g+J.TICKSIZE,v)}this.ctx.stroke(),this.ctx.closePath(),this.ctx.textBaseline="middle",this.ctx.textAlign="Left"===n.position?"right":"left",this.ctx.font=n.fontSize+"px "+J.FONTFACE;for(x=0;x<y.length;x++){v=m-y[x].pos*P+.5;this.ctx.fillText(y[x].label,o?g-J.TICKSIZE:g+J.TICKSIZE,v)}n.displayTitle&&(this.ctx.textAlign="center",this.ctx.textBaseline="bottom",this.ctx.font=n.titleFontSize+"px "+J.FONTFACE,this.ctx.save(),this.ctx.translate(o?Math.abs(n.titleFontSize-g-2)-r.width:g+n.titleFontSize+r.width-2,(i-d+c)/2),this.ctx.rotate(o?-Math.PI/2:Math.PI/2),this.ctx.fillText(n.title,0,0),this.ctx.restore()),this.margin=new H(l,c,h,d)},lt);function lt(t,e){this.api=t,this.canvas=e,this.x=[],this.y=[],this.margin=new H(0,0,0,0),this.legendHeight=0,this.axisHeight=0,this.m=new H(0,0,0,0),this.xBounds=[],this.yBounds=[],this.renderAll=!0;e=this.canvas.getContext("2d");if(!e)throw new Error("ChartGL: failed to get 2D context");this.ctx=e}var ht=(ut.prototype.getZoomDirection=function(){return this.direction},ut.prototype.isDragging=function(){return null!==this.dragBounds},ut.prototype.remove=function(){this.el.removeEventListener("mousedown",this.mouseDownHandler),document.removeEventListener("mousemove",this.mouseOverHandler,{capture:!0}),document.removeEventListener("mouseup",this.mouseUpHandler,{capture:!0}),document.removeEventListener("mousemove",this.mouseMoveHandler,{capture:!0})},ut.prototype.resize=function(t,e,i,n){this.el.style.left=t+"px",this.el.style.top=e+"px",this.el.style.width=i+"px",this.el.style.height=n+"px"},ut.prototype.createMask=function(){var t=document.createElementNS(ut.SVG_NS,"path");return this.el.append(t),t},ut.prototype.createDragLine=function(){var t=document.createElementNS(ut.SVG_NS,"line");return t.setAttribute("class","drag-line"),t.setAttribute("stroke-dasharray","8,4"),this.el.append(t),t},ut.prototype.createLines=function(){var e=this;return _.times(2,function(){var t=document.createElementNS(ut.SVG_NS,"line");return e.el.append(t),t})},ut.prototype.createRect=function(){var t=document.createElementNS(ut.SVG_NS,"rect");return t.style.fill="none",this.el.append(t),t},ut.prototype.onOverlayMouseDown=function(t){if(0!==t.button)return this.onOverlayMouseUp(t);if(this.clickTime){if(Date.now()-this.clickTime<325)return this.onOverlayMouseUp(t),this.onReset();this.clickTime=Date.now()}else this.clickTime=Date.now();this.bounds=this.el.getBoundingClientRect(),this.downPoint=new k(t.clientX-this.bounds.left,t.clientY-this.bounds.top),document.body.style["pointer-events"]="none",document.addEventListener("mouseup",this.mouseUpHandler,{capture:!0}),document.addEventListener("mousemove",this.mouseMoveHandler,{capture:!0}),t.preventDefault(),t.stopPropagation()},ut.prototype.onOverlayMouseMove=function(t){if(t.stopPropagation(),this.bounds&&this.downPoint){var e,i=this.bounds.right-this.bounds.left,n=this.bounds.bottom-this.bounds.top,r=G.limitWithin(t.clientX,this.bounds.left,this.bounds.right)-this.bounds.left,o=G.limitWithin(t.clientY,this.bounds.top,this.bounds.bottom)-this.bounds.top,a=Math.min(this.downPoint.x,r),s=Math.min(this.downPoint.y,o),l=Math.abs(this.downPoint.x-r),h=Math.abs(this.downPoint.y-o);(t=e=e||{})[t.XY=0]="XY",t[t.X=1]="X",t[t.Y=2]="Y";t=e.XY;switch(l<ut.SNAP_SZ&&h<ut.SNAP_SZ?((u=l/h)<ut.ASPECT_RATIO||1/ut.ASPECT_RATIO<u)&&(t=u<1?e.Y:e.X):l<ut.SNAP_SZ?t=e.Y:h<ut.SNAP_SZ&&(t=e.X),t){case e.X:s=0,h=n;break;case e.Y:a=0,l=i}this.dragBounds=new H(a,s,a+l,s+h);var u=G.calculateBoundsDiagonal(this.dragBounds);if(0<u?(this.mask=this.mask||this.createMask(),this.mask.setAttribute("d","M0,0H"+i+"V"+n+"H0V0M"+(Math.round(a)+.5)+","+(Math.round(s)+.5)+"v"+h+"h"+l+"v-"+h+"h-"+l+"Z")):this.removeMask(),15<u)switch(this.dragLine=this.dragLine||this.createDragLine(),t){case e.X:this.direction="x",this.lines=this.lines||this.createLines(),this.removeRect(),this.dragLine.x1.baseVal.value=this.downPoint.x+.5,this.dragLine.y1.baseVal.value=this.downPoint.y+.5,this.dragLine.x2.baseVal.value=.5+r,this.dragLine.y2.baseVal.value=this.downPoint.y+.5,this.lines[0].x1.baseVal.value=this.downPoint.x+.5,this.lines[0].y1.baseVal.value=0,this.lines[0].x2.baseVal.value=this.downPoint.x+.5,this.lines[0].y2.baseVal.value=n,this.lines[1].x1.baseVal.value=.5+r,this.lines[1].y1.baseVal.value=0,this.lines[1].x2.baseVal.value=.5+r,this.lines[1].y2.baseVal.value=n;break;case e.Y:this.direction="y",this.lines=this.lines||this.createLines(),this.removeRect(),this.dragLine.x1.baseVal.value=this.downPoint.x+.5,this.dragLine.y1.baseVal.value=this.downPoint.y+.5,this.dragLine.x2.baseVal.value=this.downPoint.x+.5,this.dragLine.y2.baseVal.value=.5+o,this.lines[0].x1.baseVal.value=0,this.lines[0].y1.baseVal.value=this.downPoint.y+.5,this.lines[0].x2.baseVal.value=i,this.lines[0].y2.baseVal.value=this.downPoint.y+.5,this.lines[1].x1.baseVal.value=0,this.lines[1].y1.baseVal.value=.5+o,this.lines[1].x2.baseVal.value=i,this.lines[1].y2.baseVal.value=.5+o;break;default:this.direction="xy",this.rectangle=this.rectangle||this.createRect(),this.removeLines(),this.dragLine.x1.baseVal.value=this.downPoint.x+.5,this.dragLine.y1.baseVal.value=this.downPoint.y+.5,this.dragLine.x2.baseVal.value=.5+r,this.dragLine.y2.baseVal.value=.5+o,this.rectangle.x.baseVal.value=this.downPoint.x<r?this.downPoint.x+.5:.5+r,this.rectangle.y.baseVal.value=this.downPoint.y<o?this.downPoint.y+.5:.5+o,this.rectangle.width.baseVal.value=l,this.rectangle.height.baseVal.value=h}else this.removeDragLine(),this.removeLines(),this.removeRect()}},ut.prototype.onOverlayMouseOver=function(t){var e=this.el.getBoundingClientRect();if(t.clientX<e.left||t.clientX>e.right||t.clientY<e.top||t.clientY>e.bottom)return this.onOver(null);var i=t.clientX-e.left,t=t.clientY-e.top;this.onOver(new k(i/(e.right-e.left),t/(e.top-e.bottom)))},ut.prototype.onOverlayMouseUp=function(t){var e;this.bounds&&(document.body.style["pointer-events"]="auto",document.removeEventListener("mouseup",this.mouseUpHandler,{capture:!0}),document.removeEventListener("mousemove",this.mouseMoveHandler,{capture:!0}),t.stopPropagation(),this.dragBounds&&G.calculateBoundsDiagonal(this.dragBounds)>ut.SNAP_SZ/3?(e=this.bounds.right-this.bounds.left,t=this.bounds.bottom-this.bounds.top,this.onZoom(new H(this.dragBounds.x/e,this.dragBounds.y/t,this.dragBounds.z/e,this.dragBounds.w/t))):this.onClick(),this.removeMask(),this.removeDragLine(),this.removeLines(),this.removeRect(),this.dragBounds=null)},ut.prototype.removeDragLine=function(){this.dragLine&&this.el.removeChild(this.dragLine),this.dragLine=void 0},ut.prototype.removeLines=function(){var e=this;this.lines&&this.lines.forEach(function(t){return e.el.removeChild(t)}),this.lines=void 0},ut.prototype.removeRect=function(){this.rectangle&&this.el.removeChild(this.rectangle),this.rectangle=void 0},ut.prototype.removeMask=function(){this.mask&&this.el.removeChild(this.mask),this.mask=void 0},ut.SVG_NS="http://www.w3.org/2000/svg",ut.SNAP_SZ=28,ut.ASPECT_RATIO=.45,ut);function ut(t,e,i,n,r){this.direction="",this.dragBounds=null,this.el=t,this.onOver=e,this.onZoom=i,this.onReset=n,this.onClick=r,this.mouseDownHandler=this.onOverlayMouseDown.bind(this),this.mouseUpHandler=this.onOverlayMouseUp.bind(this),this.mouseMoveHandler=this.onOverlayMouseMove.bind(this),this.mouseOverHandler=this.onOverlayMouseOver.bind(this),this.el.addEventListener("mousedown",this.mouseDownHandler),document.addEventListener("mousemove",this.mouseOverHandler,{capture:!0})}var ct=(pt.hexColorToVec4=function(t,e){t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return t&&4===t.length?new H(parseInt(t[1],16)/256,parseInt(t[2],16)/256,parseInt(t[3],16)/256,e/100):new H(.5,.5,.5,1)},pt.prototype.convertFillToLayerData=function(){var i=this,n=[],r={fill:"",cols:null,toBounds:null,fromBounds:null};return this.yCols.forEach(function(t,e){n[e]=i.convertData(G.isWebGL2,t,"y",void 0,void 0,r)}),n},pt.prototype.getBarWidth=function(){return this.barWidth},pt.prototype.remove=function(e){_.each(this.buffers,function(t){e.deleteBuffer(t)})},pt.prototype.render=function(a,e,i,n,s,l,h){var u=this,c="Bubble"===s||""===s?a.POINTS:"Line"===s?a.LINE_STRIP:a.TRIANGLES;this.shaders.forEach(function(r,o){void 0!==r&&(a.useProgram(r.Program),"Candlestick"===s?r.xBinding.apply(a,u.buffers[o]):r.xBinding.apply(a,u.buffers[0]),null!=h&&r.setTexture(a,h));var t="Candlestick"===s?u.colorBuffers[0]:u.colorBuffers[o];r.yBinding.apply(a,u.buffers[o+("Candlestick"===s?2:1)]),t&&r.colorLocation&&r.colorLocation.apply(a,t),u.sizeBuffer&&r.sizeLocation&&r.sizeLocation.apply(a,u.sizeBuffer),_.each([new k(e.x,e.z),new k(e.y,e.w)],function(t,e){var i=0===e?r.xRange:r.yRange,n=0===e?u.tx:u.tys[o],e=t.applyFn(function(t){return G.convertJSToScalar(n,t)});G.isLong(n)?(t=new k(w.Long.fromString(e.x.toString().split(".")[0]),w.Long.fromString(e.y.toString().split(".")[0])),i.set(a,t.applyFn(G.toNumber))):i.set(a,e.applyFn(G.toNumber))}),r.color&&(t=pt.hexColorToVec4(i[o%i.length],l),r.color.set(a,t)),r.pointSize&&r.pointSize.set(a,n),u.drawGL(a,c)})},pt.prototype.updatePointSizeOnZoom=function(i,t){var n=[];this.pointSizes&&(_.each(this.pointSizes,function(t){var e=t*(t*(2-i));n.push(e<t?t:e)}),this.sizeBuffer=Y.createBuffer(t,new Float32Array(n)))},pt.prototype.convertData=function(t,i,e,n,r,o,a,s){var l=i.qtype;if(!t&&G.isInt(l)&&(h=G.intToFloat(i),l=Z.Float),void 0!==n||o||"Candlestick"===e){t=void 0;if(h=G.isDouble(l)?this.calcBarData(i,function(t,e){return i.getScalar(e)}):G.isLong(l)?(t=new w.Long(0,2147483648),"undefined"!=typeof BigInt&&(t=BigInt(t)),this.calcBarData(i,function(t,e){return Number("bigint"==typeof t?i.getScalar(e):i.getLegacyScalar(e).toString())},t)):this.calcBarData(i,function(t,e){return i.getScalar(e)},t=5===l?-32768:-2147483648),"Candlestick"===e)return h;if(void 0===n&&null!=o&&o.fill)var t=new p,h="x"===e?t.getXLineFill(h):t.getYLineFill(h,o);else if(void 0!==n){o=new g(this.tx,this.tys);if("x"===e){if(!a)throw"Missing merged";if("Fixed Width"===r&&!s)throw"Missing width";a=G.convertVec4ToScalar(a,this.tx,this.tys[0]).applyFn(G.toNumber);h=o.getXBarPoints(h,n,r,a,s||0),this.barWidth=o.getBarWidth()}else h=o.getYBarPoints(h)}h="x"===e?this.getXBars(h):this.getYBars(h)}else h=G.isDouble(l)?G.floatToEmulateDoubleArray(i):G.isLong(l)?G.longToEmulateDoubleArray(i):h||i.toTypedArray();return h},pt.prototype.calcBarData=function(i,n,r){var o=[];return _.each(i,function(t,e){e=n(i,e);(isNaN(e)||r&&e===Number(r))&&(e=0),o.push(e)}),o},pt.prototype.drawGL=function(t,e){var i=this.count;e===t.TRIANGLES&&(i*=6),t.drawArrays(e,0,i)},pt.prototype.getPointSizes=function(i,n,r){var o=[],t=i.qtype,a=G.isLong(t)?function(t,e){return Number("bigint"==typeof t?i.getScalar(e):i.getLegacyScalar(e).toString())}:function(t,e){return i.getScalar(e)};return _.each(i,function(t,e){e=a(i,e);o.push(e*(n*(r?1.333:1)))}),o},pt.prototype.getXBars=function(t){if(this.tx!==Z.DateTime&&this.tx!==Z.Timestamp)return new Float32Array(t);for(var e=new Float32Array(2*t.length),i=0,n=0;n<e.length;n+=2){var r=t[i++];e[n]=r,e[n+1]=r-Math.fround(r)}return e},pt.prototype.getYBars=function(r){var o=new Float32Array(0);return _.each(this.tys,function(t){if(t===Z.DateTime||t===Z.Timestamp){o=new Float32Array(2*r.length);for(var e=0,i=0;i<o.length;i+=2){var n=r[e++];o[i]=n,o[i+1]=n-Math.fround(n)}}}),o.length?o:new Float32Array(r)},pt.prototype.processCandlesticks=function(t,i,s,e,l,h,u){var c=this,n=[];t.forEach(function(t,e){n[e]=c.convertData(i,t,"Candlestick")});var r=[n[1],n[2]],t=[n[0],n[3]],p=new g(this.tx,this.tys),d=this.convertData(i,e,"Candlestick"),y=[];[r,t].forEach(function(t,e){var i=0===e,n=i?l[3]/10:l[3],r=i?void 0:l,o=l[5],a=Math.abs(h.w-h.y)||0,r=p.getCandlesticks(t,a,r);i||(y=r[1]),c.buffers[e]=Y.createBuffer(s,c.getXBars(p.getXBarPoints(d,n,o,h,u))),c.buffers[e+2]=Y.createBuffer(s,new Float32Array(r[0]));r=p.getBarWidth();r>c.barWidth&&(c.barWidth=r)}),y.length&&this.setColorArray(!1,!0,[y],s,!1)},pt.prototype.setColorArray=function(o,i,t,n,a){var r=this,s=[];t&&t.length&&(t.forEach(function(t){var r,e;e=i?(r=[],_.each(t,function(t){for(var e=0;e<6;++e){var i,n=t;o&&a&&(i=1===e||2===e||4===e?0:t[3],n=[t[0],t[1],t[2],i]),r.push(Array.prototype.concat.apply([],n))}}),new Float32Array(Array.prototype.concat.apply([],r))):(e=Array.prototype.concat.apply([],t),new Float32Array(e)),s.push(e)}),s.forEach(function(t,e){r.colorBuffers[e]=Y.createBuffer(n,t)}))},pt);function pt(t,e,n,r,o,i,a,s,l,h,u,c,p,d,y){var f=this;this.barWidth=0,this.buffers=[],this.colorBuffers=[],this.pointSizes=[],this.yCols=[],this.count=Math.min(t.length,_.max(e.map(function(t){return t.length}))||0),this.tx=t.qtype,this.tys=e.map(function(t){return t.qtype}),this.yCols=e,!r&&G.isInt(this.tx)&&(this.tx=Z.Float),r||(this.tys=this.tys.map(function(t){return G.isInt(t)?Z.Float:t})),this.shaders=new Array(i.length?2:e.length),this.buffers=new Array(i.length?4:e.length+1);var g=u&&u[0],m=!(!g||!g.fill||"No Fill"===g.fill),P=void 0!==c||m||0<i.length,x=!!u&&u[1],a=u?h:l&&l.length?l:a&&a.length?a:null;a&&a.length&&this.setColorArray(m,P,a,n,x),s[0]&&(this.pointSizes=this.getPointSizes(s[0],s[1],o),this.sizeBuffer=Y.createBuffer(n,new Float32Array(this.pointSizes)));var v=this.tx===Z.DateTime||this.tx===Z.Timestamp;if(i.length&&d&&y){var O=e.map(function(t){return t.qtype}).map(function(t){return G.isInt(t)?Z.Float:t}),S=O[0]===Z.DateTime||O[0]===Z.Timestamp,s=G.convertVec4ToScalar(d,this.tx,this.tys[0]).applyFn(G.toNumber);this.processCandlesticks(e,r,n,t,i,s,y);for(var R=0;R<this.shaders.length;R++){var b=0===R?void 0:this.colorBuffers[0],b=Y.getShader(n,r,v?this.tx:Z.Float,S?O[0]:Z.Float,o,void 0!==b,void 0!==this.sizeBuffer);this.shaders[R]=b,n.useProgram(b.Program)}}else{var T=g,y=this.convertData(r,t,"x",c,p,T,d,y);this.buffers[0]=Y.createBuffer(n,y),e.forEach(function(t,e){var i=f.tys[e]===Z.DateTime||f.tys[e]===Z.Timestamp,i=Y.getShader(n,r,P&&!v?Z.Float:f.tx,P&&!i?Z.Float:f.tys[e],o,void 0!==f.colorBuffers[e],void 0!==f.sizeBuffer);f.shaders[e]=i,n.useProgram(i.Program);t=f.convertData(r,t,"y",c,p,T);f.buffers[e+1]=Y.createBuffer(n,t)})}}var dt=(yt.getConditionResult=function(t,e,i){var n,r,o=!1,a=isNaN(parseFloat(t))||_.isObject(t)?(""+t).toLowerCase():parseFloat(t),s=isNaN(parseFloat(e))||_.isObject(e)?(""+e).toLowerCase():parseFloat(e);switch(t&&t.class&&0<=["1212","1213","1214","1215"].indexOf(t.class)?(a=w.Tools.convertKDBTemporalToMoment(t).unix(),"in"===i?(n=[],_.each(e.toString().split(","),function(t){n.push(w.Tools.convertDateStringValueToMoment(t).unix()),s=n.toString()})):s=w.Tools.convertDateStringValueToMoment(e).unix()):t&&t.class&&0<=["1216","1217","1218","1219"].indexOf(t.class)&&(a=w.Tools.convertKDBTemporalToMoment(t).valueOfNano(),"in"===i?(r=[],_.each(e.toString().split(","),function(t){r.push(w.Tools.convertDateStringValueToMoment(t).valueOfNano()),s=r.toString()})):s=w.Tools.convertDateStringValueToMoment(e).valueOfNano()),i){case"contains":o=0<=a.toString().indexOf(s.toString());break;case"starts with":o=0===a.toString().indexOf(s.toString());break;case"ends with":o=-1!==a.toString().indexOf(s.toString(),a.toString().length-s.toString().length);break;case"==":o=a===s;break;case"<":o=a<s;break;case">":o=s<a;break;case"<=":o=a<=s;break;case">=":o=s<=a;break;case"!=":o=a!==s;break;case"in":o=0<=s.toString().split(",").indexOf(a.toString());break;case"search":o=!!a.toString().match(s.toString());break;case"regexp":o=new RegExp(e.toString()).test(t?t.toString():"")}return o},yt.getScalarResult=function(t,e,i,n){var r=t.getScalar(e);switch("bigint"==typeof r&&"bigint"!=typeof i&&(i=G.toLong(i)),n){case"==":return r===i;case"<":return r<i;case">":return i<r;case"<=":return r<=i;case">=":return i<=r;case"!=":return r!==i}},yt.interpolateColor=function(t,e,i,n){if(!t.length)return"";for(var i=(i-e)/(t.length-1),e=this.clamp((n-e)/i,0,t.length-1),e=_.isNaN(e)?0:e,i=t[Math.floor(e)].type,t=t[Math.ceil(e)].type,r=this.hex2RGB(i),o=this.hex2RGB(t),a=e-Math.floor(e),s=r.slice(),l=0;l<3;l++)s[l]=Math.round(s[l]+a*(o[l]-r[l]));return this.RGB2hex(s)},yt.clamp=function(t,e,i){return i<t?i:t<e?e:t},yt.hex2RGB=function(t){t=/^#?([a-f\d]{2})([a-f\d]{2})([a-f\d]{2})$/i.exec(t);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:[255,255,255]},yt.RGB2hex=function(t){return"#"+((1<<24)+(t[0]<<16)+(t[1]<<8)+t[2]).toString(16).slice(1)},yt);function yt(){}var ft=(gt.prototype.computeHighlightRules=function(r,t,e,i,o,n,a,s,l){var h=this;if(!o)return[""];var u={};_.each(_.keys(o),function(t){u[t]=o[t]});var c=[],p=[],d=i.length?i:e,y=t;if(r||a){var f,g=r.map(function(t){return new RegExp((t.RuleTarget||"*").replace(/\*/g,"(.*)$"))});if(u[d]){for(var m=0;m<u[d].length;m++){l&&l.length&&(y=l[m]);var P=r.length?this.computeColorInternal(d,m,r,g,u):s;c.push(P||y)}p.push(c)}else G.isRegexOrWild(i)&&(delete n[e],f=0,_.each(n,function(t,e){c=[];for(var i=0;i<t.length;i++){var n=r.length?h.computeColorInternal(e,i,r,g,o):s[f];c.push(n||(l&&l.length&&l[f]?l[f][i]:y[f]))}f++,p.push(c)}));return p}return[y]},gt.prototype.getColorArray=function(t,i,n,r){var o,e=[];return _.each(t,function(t){o=[],_.each(t,function(t){var e=ct.hexColorToVec4(t,n?r:i);o.push(Object.keys(e).map(function(t){return e[t]}))}),e.push(o)}),e},gt.prototype.computeColorInternal=function(h,u,t,c,p){var d,y={};return t.forEach(function(t,e){if(c[e].test(h)&&t.RuleSource){var i=p[t.RuleSource],e=p[t.RuleSource].qtype;if((3<e&&e<11||11<e&&e<20)&&{"==":!0,"<":!0,">":!0,"<=":!0,">=":!0,"!=":!0}[t.RuleOperation]&&!G.isIE11){var n=G.convertStringToScalar(t.RuleValue,G.ipcTemp(e));dt.getScalarResult(i,u,n,t.RuleOperation)&&(d=t.RuleColor)}else{_.each(_.keys(p),function(t){y[t]=p[t].getValue(u)});var r,o,n=t.RuleSource,a=y[n];if(a&&"object"==typeof a&&!a.i){for(var s="",l=0;l<a.length;l++)s+=""+a.getValue(l);a=s}"gradient"===t.RuleType?(n=t.Palette,r=t.RuleMin,o=t.RuleMax,d=dt.interpolateColor(n,r,o,a)):t.RuleOperation&&(r=t.RuleOperation,o=t.RuleValue,dt.getConditionResult(a,o,r)&&(d=t.RuleColor))}}}),d},gt);function gt(){}var mt=(Pt.prototype.getJSDataBounds=function(t){var e=this.xCol.qtype,i=this.yCols[0]?this.yCols[0].qtype:e;return G.convertVec4ToJsScalar(t,e,i)},Pt.prototype.createRenderer=function(t,e,i,n,r,o,a,s){return new ct(this.xCol,this.yCols,t,e,i,n,r,this.radiusInfo,this.highlightRules,this.lineFillColors,o,this.barWidth,this.barType,a,s)},Pt.prototype.getPoint=function(e){function t(t){return G.isIE11&&G.isLong(t.qtype)?t.getLegacyScalar(e):t.getScalar(e)}return[t(this.xCol)].concat(this.yCols.map(t))},Pt);function Pt(t,e,i,n,r,o,a,s){this.xCol=t,this.yCols=e,this.yColNames=i,this.barWidth=n,this.barType=r,this.radiusInfo=o,this.highlightRules=a,this.lineFillColors=s}var xt=(Object.defineProperty(vt.prototype,"RenderState",{get:function(){return this.renderState},enumerable:!1,configurable:!0}),Object.defineProperty(vt.prototype,"Config",{get:function(){return this.config},enumerable:!1,configurable:!0}),Object.defineProperty(vt.prototype,"Renderer",{get:function(){return this.renderer},enumerable:!1,configurable:!0}),Object.defineProperty(vt.prototype,"XType",{get:function(){return this.config?this.config.xCol.qtype:null},enumerable:!1,configurable:!0}),Object.defineProperty(vt.prototype,"YType",{get:function(){return this.config&&this.config.yCols.length?this.config.yCols[0].qtype:null},enumerable:!1,configurable:!0}),Object.defineProperty(vt.prototype,"datasourceError",{get:function(){var t;return null===(t=null===(t=this.datasource)||void 0===t?void 0:t.attributes)||void 0===t?void 0:t.error},enumerable:!1,configurable:!0}),vt.prototype.getAllPointsFromRelativeX=function(){return this.points},vt.prototype.getAxisId=function(t){return this.api.getProperty(this.indexProp(t+"AxisId")).replace(/.*?(\d+)$/,"$1")-1},vt.prototype.getClosestPointFromRelativeX=function(n,e,t,r){var o=this;if(!this.config)return null;var a=this.config,i=a.xCol;if(i.hasIndex())s=i.length,h=function(t){return i.getIndexFromSortedIndex(t)};else{if(!this.workerIndex.length)return null;var s=this.workerIndex.length,l=this.workerIndex,h=function(t){return l[t]}}var u,c=G.isLong(i.qtype);function p(t){return"bigint"==typeof t?t:BigInt(Math.round(t))}u=c?(m=Math.round(n*t),G.isIE11?(r=r.applyFn(G.toLong)).x.add(new w.Long(m).mul(r.z.sub(r.x)).div(new w.Long(t))):p(r.x)+p(m)*(p(r.z)-p(r.x))/p(t)):Number(r.x)+n*(Number(r.z)-Number(r.x));function d(t){for(var e=a.getPoint(h(t)),i=1;i<e.length;i++){var n=G.calculateRelativeValue(e[i],r.y,r.w);if(0<=n&&n<=1)return 1}}function y(t){var t=(e=a.getPoint(h(t)))[0],e=e.slice(1);return isNaN(Number(t))||_.every(e,function(t){return isNaN(Number(t))})}var f,g=0<=(P=i.hasIndex()?i.findIndex(u):c&&G.isIE11?w.Tools.binarySearch2(u,this.workerIndex,function(t,e){e=i.getLegacyScalar(e);return t.compare(e)}):w.Tools.binarySearch2(u,this.workerIndex,function(t,e){e=i.getScalar(e);return e<t?1:t<e?-1:0}))?f=P:(f=-P-2)+1,m=function(t,e){for(var i=[];e?0<=t:t<s;)y(t)||i.push(t),e?t--:t++;return i.length?o.getClosestXPoint(i,r,a,h,n):t},t=a.getPoint(h(f)),P=a.getPoint(h(g)),t=isNaN(Number(t[0])),P=isNaN(Number(P[0]));if(t)f=m(f,!0);else if(y(f))for(;0<=f&&y(f);)f--;if(P)g=m(g,!1);else if(y(g))for(;g<s&&y(g);)g++;(t||P)&&(f=g=this.getClosestXPoint([f,g],r,a,h,n));for(var x=[],v=[],O=a.getPoint(h(f)),S=a.getPoint(h(g));0<=f&&a.getPoint(h(f))[0]===O[0];)d(f)&&x.push(f),f--;for(;g<s&&a.getPoint(h(g))[0]===S[0];)d(g)&&v.push(g),g++;f=x.length?this.getY(x,r,a,h,e):f,g=v.length?this.getY(v,r,a,h,e):g;var R,P=_.union(x,v);if(this.api.getProperty("Overlay.ShowAllPoints")&&(R=[],_.each(P,function(t){R.push(o.isRegexOrWild()?o.getAllWildcards(t,r,a,h):[o.getClosestPoint(t,r,a,h,e)])}),this.points=R),f<0&&s<=g)return null;if(f<0)return this.getClosestPoint(g,r,a,h,e);if(s<=g)return this.getClosestPoint(f,r,a,h,e);var b,T,P=this.getY(P,r,a,h,e);return T=G.isIE11&&c?(b=u.sub(i.getLegacyScalar(h(f))),T=i.getLegacyScalar(h(g)).sub(u),b.equals(T)?P:b.lt(T)?f:g):(b=Number(u)-Number(i.getScalar(h(f))))===(T=Number(i.getScalar(h(g)))-Number(u))?P:b<T?f:g,this.getClosestPoint(T,r,a,h,e)},vt.prototype.getColorArr=function(t,e){return(e||0===e?this.colorArr[e]:this.colorArr)[t]},vt.prototype.getColorData=function(){return this.colorDataInfo},vt.prototype.getAllCols=function(){return _.union(this.yAxes,this.disabledColumns)},vt.prototype.getFillToLayerData=function(){return this.renderer?this.renderer.convertFillToLayerData():[]},vt.prototype.getFillType=function(){return"Line"===this.propertyCache[vt.PROP_TYPE]?this.propertyCache[vt.PROP_FILL]:""},vt.prototype.getId=function(){return this.uid},vt.prototype.getLayerName=function(){return this.api.getProperty(this.indexProp("Name"))},vt.prototype.hasColorData=function(){var t=this.api.getProperty(this.indexProp(vt.PROP_COLORDATA));return!this.isCandlestick()&&t&&"None"!==t},vt.prototype.hasPadding=function(){return"Line"!==this.propertyCache[vt.PROP_TYPE]},vt.prototype.hasTexture=function(){return!(!this.icon||!this.texture)},vt.prototype.isBubble=function(){return"Bubble"===this.api.getProperty(this.indexProp(vt.PROP_TYPE))},vt.prototype.isCandlestick=function(){return"Candlestick"===this.api.getProperty(this.indexProp(vt.PROP_TYPE))},vt.prototype.isEnabled=function(){return!0===this.api.getProperty(this.indexProp(vt.PROP_ENABLED))},vt.prototype.hasFixedWidth=function(){var t=this.api.getProperty(this.indexProp(vt.PROP_TYPE)),e=this.api.getProperty(this.indexProp(vt.PROP_BARWIDTHTYPE));return"Bar"===t&&"Fixed Width"===e},vt.prototype.updateLayerPalette=function(t,e){this.palette=t;t=!1;this.hasColorData()&&this.cols&&(i=this.propertyCache[vt.PROP_COLORDATA],i=this.calculateColorData(i),this.setColorData(i),t=!0);var i=this.propertyCache[vt.PROP_HIGHLIGHTRULES];i&&i.length&&(this.onHighlightRuleChange(i),t=!0);i=this.propertyCache[vt.PROP_FILL];i&&"No Fill"!==i&&(t=!0),e&&t&&this.configure()},vt.prototype.getRowData=function(e){if(!this.cols)return null;var i=this.cols,n={};return _.each(_.keys(i),function(t){n[t]=i[t].getValue(e),n[t]&&"object"==typeof n[t]&&!w.Tools.isKDBTemporal(n[t])&&(n[t]=G.getValueFromObject(n[t]))}),n},vt.prototype.getColumnKeysFromAxisString=function(t){var e,i=/\/[gimsuy]*$/,n="";0===t.indexOf("/")?(e=t.substring(1).replace(i,""),n=(i=t.match(i))?i[0].substring(1):""):e="^"+(t=t.replace(/[\-\[\]\/\{\}\(\)\+\?\.\\\^\$\|]/g,"\\$&")).replace(/\*/g,"(.*)")+"$";var r=new RegExp(e,n);return this.scalarColumns.filter(function(t){return t.match(r)})},vt.prototype.getDataRangeX=function(){if(this.cols&&this.hasData()){var t=this.cols[this.api.getProperty(this.indexProp(vt.PROP_XAXIS))],e=t.length?t.calcRange():[0,1];return G.convertVec2ToJsScalar(new k(e[0],e[1]),t.qtype,t.qtype)}return new k(0,1)},vt.prototype.getDataRangeY=function(){if(this.cols&&this.hasData()){var t=_.difference(this.yAxes,this.disabledColumns),e=this.cols,t=t.map(function(t){return e[t]}).filter(function(t){return t}).map(function(t){var e=t.calcRange();return G.convertVec2ToJsScalar(new k(e[0],e[1]),t.qtype,t.qtype)});return G.mergeRange(t)||new k(0,1)}return new k(0,1)},vt.prototype.getPaddedRange=function(t,e){var i,n,r,o,a,s,l=t.applyFn(m.isMoment),h=t.applyFn(m.isDuration),u=t.applyFn(G.convertJSToNumber),c=this.propertyCache[vt.PROP_TYPE],p="Bar"===c,d=u.x,y=u.z,f=u.y,g=u.w;return u.y===u.w&&(g+=i=.01*f,f-=i),u.x===u.z&&(y+=i=.01*d,d-=i),p||this.isCandlestick()?(r=(null===(s=this.renderer)||void 0===s?void 0:s.getBarWidth())||0,n=(g-f)*vt.BAR_MIN_RELATIVE_SZ,a=p&&0<g&&0<f?Math.max(0,f-n):f,s=p&&g<0?Math.min(0,g+n):g,u=new H(d-r,a,y+r,s)):"Bubble"===c&&(p=this.propertyCache[vt.PROP_RADIUS_DATA],r=n=Number(this.propertyCache[vt.PROP_RADIUS_SCALE])/2,s=a=0,"Fixed Size"!==p&&this.cols&&(o=(o=this.cols[p]).length?o.calcRange():[0,1],r=n*Number(o[1])),o=r/e.x,e=r/e.y,u=new H(d-(a=o*(y-d)),f-(s=e*(g-f)),y+a,g+s)),"Line"!==c?(["x","y","z","w"].forEach(function(t){l[t]?u[t]=m(u[t]):h[t]&&(u[t]=m.duration(u[t]))}),u):t},vt.prototype.getPaletteProperty=function(){return this.api.getProperty(this.indexProp(vt.PROP_PALETTE)).map(function(t){return"object"==typeof t.type&&t.type.attributes?t.type.attributes.value:t.type})},vt.prototype.hasData=function(){if(this.datasource){var t=this.datasource.attributes,e=t.queryStatus;if(t.error)return!1;if(e){if("Loading"===e.type)return!1;if("NoResults"===e.type)return}return!0}},vt.prototype.indexProp=function(t){return vt.PROP_PREFIX+this.index+"."+t},vt.prototype.isRegexOrWild=function(){return G.isRegexOrWild(this.api.getProperty(this.indexProp(vt.PROP_YAXIS)))},vt.prototype.onData=function(t,i,e){this.renderState=Ot.Loaded,e&&this.appInvalidate(this.renderState);var n=_.find(this.cols,function(t,e){return!i.cols||t!==i.cols[e]});this.cols=_.clone(i.cols);e=_.filter(t.columns.collection.models,function(t){t=Number(t.get("kdbType"));return 3<t&&t<11||11<t&&t<20}).map(function(t){return t.id}),t=!_.isEqual(e,this.scalarColumns);if(n||t){this.scalarColumns=e;try{this.setIgnoreSettings(!0),this.api.setProperty(this.indexProp("possibleXColumns"),this.scalarColumns),this.api.setProperty(this.indexProp("possibleYColumns"),["*"].concat(this.scalarColumns)),this.api.setProperty(this.indexProp("possibleColorColumns"),["None"].concat(this.cols?Object.keys(this.cols):[]));var r,o=this.api.getProperty(this.indexProp(vt.PROP_COLORDATA));!o||i.cols&&!i.cols[o]?(this.api.setProperty(this.indexProp(vt.PROP_COLORDATA),"None"),this.colorData=[],this.colorDataArr=[]):this.hasColorData()&&this.cols&&(r=this.calculateColorData(o),this.setColorData(r));var a,s=this.propertyCache[vt.PROP_HIGHLIGHTRULES]||this.api.getProperty(this.indexProp(vt.PROP_HIGHLIGHTRULES)),l=s&&s.length;l&&(a=this.cols?Object.keys(this.cols):[],this.api.setProperty(this.indexProp("possibleRulesColumns"),a),this.onHighlightRuleChange(s));var h=this.propertyCache[vt.PROP_FILL],u=this.propertyCache[vt.PROP_FADE];h&&"No Fill"!==h&&(u||l)&&this.onLineFillChange(s);var c=this.indexProp(vt.PROP_XAXIS),p=this.api.getProperty(c);(i.cols&&!i.cols[p]||!p)&&this.scalarColumns[0]&&this.api.setProperty(c,this.scalarColumns[0]);var d=this.indexProp(vt.PROP_YAXIS),y=this.api.getProperty(d);this.isCandlestick()?(this.setCandlestickProperties(),y&&this.api.setProperty(d,void 0)):(!i.cols||i.cols[y]||this.isRegexOrWild())&&y||!this.scalarColumns[1]||(this.api.setProperty(d,"*"),this.setColorProperties())}catch(t){}this.setIgnoreSettings(!1),this.configure()}else this.config?this.onConfigComplete():this.appInvalidate(this.renderState)},vt.prototype.onResize=function(){this.invalidate(Ot.Process)},vt.prototype.onSettingsChange=function(t){var e=[vt.PROP_TYPE,vt.PROP_XAXIS,vt.PROP_YAXIS,vt.PROP_BARWIDTHTYPE,vt.PROP_BARPERCENT,vt.PROP_BARFIXED,vt.PROP_FILL,vt.PROP_FADE,vt.PROP_RADIUS_DATA,vt.PROP_RADIUS_SCALE,vt.PROP_COLORDATA,vt.PROP_HIGHLIGHTRULES],i=t[vt.PROP_DATA];void 0!==i&&i!==this.datasource&&(this.propertyCache[vt.PROP_DATA]=i,this.onDataSourceChange(i));var n=t[vt.PROP_COLOR];""!==n&&n||this.setColorProperties();var r=t[vt.PROP_HIGHLIGHTRULES],o=r&&r.length;r&&!r.length&&this.highlightRules&&this.highlightRules.length&&(this.highlightRules=void 0),o&&this.cols&&e.push(vt.PROP_COLOR,vt.PROP_OPACITY),this.hasColorData()&&this.cols?e.push(vt.PROP_OPACITY):(this.colorData=[],this.colorDataArr=[]);i=t[vt.PROP_ICON];void 0!==i&&i!==this.icon&&(this.propertyCache[vt.PROP_ICON]=i,this.onIconChange(i)),this.isCandlestick()&&e.push(vt.PROP_OPEN,vt.PROP_HIGH,vt.PROP_LOW,vt.PROP_CLOSE,vt.PROP_BEARCOLOR,vt.PROP_BULLCOLOR,vt.PROP_NEUTRALCOLOR,vt.PROP_CANDLEWIDTHTYPE,vt.PROP_CANDLEPERCENT,vt.PROP_CANDLEFIXED,vt.PROP_OPACITY);n=t[vt.PROP_ENABLED];n!==this.propertyCache[vt.PROP_ENABLED]&&(this.propertyCache[vt.PROP_ENABLED]=n,this.invalidate(Ot.Process));i=t[vt.PROP_FADE],n=t[vt.PROP_FILL];this.cols&&n&&"No Fill"!==n&&(i||o?this.onLineFillChange(r):this.lineFillColors=void 0,e.push(vt.PROP_FILLCOLOR,vt.PROP_FILLOPACITY)),this.configureIfDiff(t,e),this.invalidateIfDiff(t,vt.PROP_COLOR,Ot.Uniforms),this.invalidateIfDiff(t,vt.PROP_WICKCOLOR,Ot.Uniforms),this.invalidateIfDiff(t,vt.PROP_OPACITY,Ot.Uniforms),this.invalidateIfDiff(t,vt.PROP_FILLCOLOR,Ot.Uniforms),this.invalidateIfDiff(t,vt.PROP_FILLOPACITY,Ot.Uniforms)},vt.prototype.processData=function(t,e,i){var n,r,o,a,s,l,h,u,c,p=this;this.renderState===Ot.Process&&this.config&&(n=(l=this.config).xCol,r=l.yCols,n&&n.length&&(this.renderer&&this.renderer.remove(t),this.rendererFill&&this.rendererFill.remove(t),this.propertyCache[vt.PROP_ICON]&&this.image&&this.image.height&&(this.texture=Y.createTexture(t,this.image,this.index)),h=[],this.isCandlestick()&&(o=this.api.getProperty(this.indexProp(vt.PROP_BEARCOLOR)),a=this.api.getProperty(this.indexProp(vt.PROP_BULLCOLOR)),s=this.api.getProperty(this.indexProp(vt.PROP_NEUTRALCOLOR)),c=this.api.getProperty(this.indexProp(vt.PROP_CANDLEWIDTHTYPE)),l=this.api.getProperty(this.indexProp(vt.PROP_CANDLEPERCENT))/100,u=this.api.getProperty(this.indexProp(vt.PROP_CANDLEFIXED)),h=[o,a,s,"Percentage"===c?l:u,this.api.getProperty(this.indexProp(vt.PROP_OPACITY)),c]),u=this.propertyCache[vt.PROP_TYPE],c=null!==this.texture,this.renderer=this.config.createRenderer(t,this.isWebGL2,c,h,this.colorData,void 0,"Bar"===u||this.isCandlestick()?i:void 0,!this.hasFixedWidth()&&!this.isCandlestick()||null==e?void 0:e.x)),i="Line"===this.propertyCache[vt.PROP_TYPE],e=this.propertyCache[vt.PROP_FILL],(!i||i&&"No Fill"===e)&&(this.renderState=Ot.Uniforms),this.workerIndex=[],!n.hasIndex()&&r.length?(this.worker||(e=requirejs.toUrl("ChartGL").slice(0,-4)+"worker.js",this.worker=new Worker(e),this.worker.onmessage=function(t){"ready"!==t.data||p.workerQueued?(p.workerIndex=t.data,p.invalidate(Ot.Tooltip)):(p.workerQueued=!0,window.requestAnimationFrame(function(){var t;p.Config&&p.Config.xCol&&(t=p.Config.xCol,p.workerQueued=!1,p.worker&&p.worker.postMessage([t.qtype,t.toTypedArray()]))}))},this.worker.onerror=function(t){return w.Log.Error(t)}),n&&r.length&&this.worker.postMessage("queue")):this.worker&&(this.worker.terminate(),this.worker=null))},vt.prototype.processLineFillData=function(t,e){var i,n,r;this.config&&(i=this.api.getProperty(this.indexProp(vt.PROP_COLORDATA)),n=[],this.hasColorData()&&this.cols&&(r=this.calculateColorData(i),n=this.setColorData(r,!0)),r=null!==this.texture,this.rendererFill=this.config.createRenderer(t,this.isWebGL2,r,[],n,[e,this.propertyCache[vt.PROP_FADE]])),this.renderState=Ot.Uniforms},vt.prototype.remove=function(t,e){e&&(this.renderer&&this.renderer.remove(t),this.texture&&t.deleteTexture(this.texture)),this.datasource&&(this.datasource.unsubscribe(this.subId),this.datasource.off("change:queryStatus",this.datasourceStatusFn)),this.renderer&&this.renderer.remove(t),this.rendererFill&&this.rendererFill.remove(t),this.texture&&(t.deleteTexture(this.texture),this.texture=null),this.worker&&this.worker.terminate()},vt.prototype.render=function(t,e,i,n){var r,o=this.propertyCache[n?vt.PROP_FILL:vt.PROP_TYPE],a=this.propertyCache[vt.PROP_WICKCOLOR],s=this.propertyCache[n?vt.PROP_FILLCOLOR:vt.PROP_COLOR],l=this.propertyCache[vt.PROP_RADIUS_DATA],h=this.propertyCache[n?vt.PROP_FILLOPACITY:vt.PROP_OPACITY],u=this.texture?1.333*Number(this.propertyCache[vt.PROP_RADIUS_SCALE]):Number(this.propertyCache[vt.PROP_RADIUS_SCALE]),c=u*(u*(2-i));i&&"Bubble"===o&&"Fixed Size"!==l&&null!==(r=this.renderer)&&void 0!==r&&r.updatePointSizeOnZoom(i,t);n=n?this.rendererFill:this.renderer;n&&n.render(t,e,this.isRegexOrWild()?this.palette:this.isCandlestick()?[a]:[s],i&&u<=c?c:u,o,h,this.texture?this.index:void 0)},vt.prototype.getDataSource=function(){return this.datasource},vt.prototype.updateAxisId=function(t,i){var n=[];_.each(t,function(t,e){n.push(i+"-Axis "+(e+1))}),this.api.setProperty(this.indexProp("possible"+i+"Axes"),n);t=this.api.getProperty(this.indexProp(i+"AxisId"));n.length&&-1===n.indexOf(t)&&this.api.setProperty(this.indexProp(i+"AxisId"),i+"-Axis 1")},vt.prototype.updateColumns=function(t,e){this.disabledColumns=t,e||this.configure()},vt.prototype.updateLayer=function(t,e,i){var n=this;this.api.setProperty(this.indexProp(vt.PROP_DATA),t),_.each(e,function(t,e){n.api.setProperty(n.indexProp(i[e]),t)})},vt.prototype.wildcardDataChanged=function(t){return this.isRegexOrWild()&&this.propertyCache[vt.PROP_DATA]!==t},vt.prototype.calculateColorData=function(t){var e=[];if(this.cols&&this.cols[t]){for(var i,n=this.cols,r=[],o=[],a=function(t){return null===t?null:w.Tools.isKDBTemporal(t)?w.Tools.convertKDBTemporalToMoment(t).toDashString():G.getValueFromObject(t)},s=0,l=0;l<n[t].length;l++)"object"==typeof(h=n[t].getValue(l))&&(h=a(h)),-1===r.indexOf(h)&&(r.push(h),i=this.getPaletteProperty(),o.push(i[s%i.length]),s++);this.colorDataInfo=[r,o];for(var h,l=0;l<n[t].length;l++)"object"==typeof(h=n[t].getValue(l))&&(h=a(h)),e.push(o[r.indexOf(h)])}else this.colorDataInfo=[[],[]],this.colorData=[],this.colorDataArr=[];return e},vt.prototype.configure=function(){var e=this;if(this.config=null,this.cols){var i=this.cols,n=this.indexProp(vt.PROP_XAXIS),r=this.api.getProperty(n),o=this.indexProp(vt.PROP_YAXIS),a=this.api.getProperty(o),s=this.cols[r];this.isCandlestick()||a||(this.setIgnoreSettings(!0),this.api.setProperty(this.indexProp(vt.PROP_YAXIS),"*"),this.setIgnoreSettings(!1));n=this.isRegexOrWild()?this.getColumnKeysFromAxisString(a):[a];if(a&&-1!==a.indexOf("*")&&(c=_.maxBy(_.values(_.groupBy(n,function(t){return i[t].qtype})),function(t){return t.length}),n=_.without(c,r)),this.isRegexOrWild()&&-1===a.indexOf("*")){var l=_.keys(_.groupBy(n,function(t){return i[t].qtype})),h=[Z.Byte,Z.Short,Z.Int,Z.Long,Z.Double,Z.Float,Z.Char],u=[Z.Timestamp,Z.Month,Z.Date,Z.DateTime,Z.Timespan,Z.Minute,Z.Second,Z.Time];if(l.some(function(t){return 0<=u.indexOf(Number(t))})&&l.some(function(t){return 0<=h.indexOf(Number(t))}))return void this.api.showErrorMessage({error:t("Can't mix date types with number types on ")+"<b>"+t("Properties > Layer > Y-Axis Data")+"</b>",type:"Error"})}this.isCandlestick()&&(this.setCandlestickProperties(),n=[vt.PROP_OPEN,vt.PROP_HIGH,vt.PROP_LOW,vt.PROP_CLOSE].map(function(t){return e.api.getProperty(e.indexProp(t))})),_.isEqual(this.yAxes,n)||(this.disabledColumns=[]),this.yAxes=n;o=_.difference(n,this.disabledColumns);this.setColorProperties(),this.setIgnoreSettings(!0);var c=this.propertyCache[vt.PROP_TYPE],r=["Fixed Size"].concat(this.scalarColumns),a=this.api.getProperty(this.indexProp("possibleRadiusData"));"Bubble"!==c||_.isEqual(r,a)||this.api.setProperty(this.indexProp("possibleRadiusData"),r),"Line"===c&&this.setLineFillProperties(),this.setIgnoreSettings(!1);l=o.map(function(t){return i[t]}),n=this.api.getProperty(this.indexProp(vt.PROP_BARWIDTHTYPE)),a=this.api.getProperty(this.indexProp(vt.PROP_BARPERCENT))/100,r=this.api.getProperty(this.indexProp(vt.PROP_BARFIXED)),c="Percentage"===n?a:r,a=this.api.getProperty(this.indexProp(vt.PROP_RADIUS_DATA)),r=this.api.getProperty(this.indexProp(vt.PROP_RADIUS_SCALE)),a="Fixed Size"===a?"":this.cols[a];s&&l&&l.length&&(this.config=new mt(s,l,o,c,n,[a,r],this.highlightRules,this.lineFillColors),this.onConfigComplete())}},vt.prototype.configureIfDiff=function(i,t){var n=this,r=!1,e=this.propertyCache[vt.PROP_HIGHLIGHTRULES],o=e&&e.length,a=this.propertyCache[vt.PROP_COLORDATA],s=!1,l=!1;t.forEach(function(t){var e=i.hasOwnProperty(t)&&!n.propertyCache.hasOwnProperty(t)||!_.isEqual(i[t],n.propertyCache[t]);!e||"Opacity"!==t&&"Color"!==t&&"YAxis"!==t&&"ColorData"!==t&&"HighlightRules"!==t||(o&&(l=!0),a&&(s=!0)),e&&(r=r||e,n.propertyCache[t]=i[t])}),s&&(t=this.api.getProperty(this.indexProp(vt.PROP_COLORDATA)),this.hasColorData()&&(t=this.calculateColorData(t),this.setColorData(t))),l&&this.onHighlightRuleChange(this.propertyCache[vt.PROP_HIGHLIGHTRULES]),r&&this.configure()},vt.prototype.getAllWildcards=function(t,e,i,n){t=n(t);for(var r=i.getPoint(t),o=[],a=1;a<r.length;a++)o.push([t,G.calculateRelativePoint(new k(r[0],r[a]),e),i.yColNames[a-1],a-1]);return o},vt.prototype.getClosestPoint=function(t,e,i,n,r){var o=1;t=n(t);for(var a=i.getPoint(t),s=Math.abs(r-G.calculateRelativeValue(a[1],e.y,e.w)),l=2;l<a.length;l++){var h=G.calculateRelativeValue(a[l],e.y,e.w),h=Math.abs(h-r);(h<s||isNaN(Number(a[o])))&&(s=h,o=l)}return[t,G.calculateRelativePoint(new k(a[0],a[o]),e),i.yColNames[o-1],o-1]},vt.prototype.getClosestXPoint=function(i,n,e,r,o){var a=i[0],t=i.map(function(t){return e.getPoint(r(t))[0]}),s=Math.abs(o-G.calculateRelativeValue(t[0],n.x,n.z));return _.each(t,function(t,e){"number"!=typeof t&&"bigint"!=typeof t||(t=G.calculateRelativeValue(t,n.x,n.z),(t=Math.abs(t-o))<s&&(s=t,a=i[e]))}),a},vt.prototype.getY=function(i,n,e,r,o){var a,s,l,h=i[0],u=[];if(_.each(i,function(t){t=r(t),(a=e.getPoint(t))&&(2<a.length?u.push(a.slice(1)):u.push(a[1]))}),!u.length)return null;var t=(2<a.length?u[0]:u)[0],c=Math.abs(o-G.calculateRelativeValue(t,n.y,n.w));return _.each(u,function(t,e){2<a.length&&Array.isArray(t)?_.each(t,function(t){s=G.calculateRelativeValue(t,n.y,n.w),(l=Math.abs(s-o))<c&&(c=l,h=i[e])}):"number"!=typeof t&&"bigint"!=typeof t||(s=G.calculateRelativeValue(t,n.y,n.w),(l=Math.abs(s-o))<c&&(c=l,h=i[e]))}),h},vt.prototype.invalidate=function(t){t<this.renderState&&(this.renderState=t),this.appInvalidate(this.renderState)},vt.prototype.invalidateIfDiff=function(t,e,i){void 0!==t[e]&&t[e]!==this.propertyCache[e]&&(this.propertyCache[e]=t[e],this.invalidate(i))},vt.prototype.onDataSourceChange=function(t){var i=this;this.datasource&&(this.datasource.unsubscribe(this.subId),this.datasource.off("change:queryStatus",this.datasourceStatusFn)),this.datasource=t,this.datasource?(this.cols=void 0,this.scalarColumns=[],this.renderState=Ot.Data,this.datasource.subscribe(this.subId,this,!0),this.datasourceStatusFn=function(t,e){e&&"Loading"===e.type&&i.invalidate(Ot.Data)},this.datasource.on("change:queryStatus",this.datasourceStatusFn)):this.renderState=Ot.Init,this.appInvalidate(this.renderState)},vt.prototype.onConfigComplete=function(){this.renderState=Ot.Process,this.appInvalidate(this.renderState)},vt.prototype.onLineFillChange=function(t){var e=this,i=this.api.getProperty(this.indexProp(vt.PROP_FILL)),n=this.api.getProperty(this.indexProp(vt.PROP_FADE)),r=this.api.getProperty(this.indexProp(vt.PROP_FILLCOLOR)),o=this.api.getProperty(this.indexProp(vt.PROP_FILLOPACITY)),a=this.api.getProperty(this.indexProp(vt.PROP_YAXIS)),s=new ft,r=this.isRegexOrWild()?this.palette.length?this.palette:this.getPaletteProperty():r,l=this.getColumnKeysFromAxisString(a),h={};_.keys(this.cols).forEach(function(t){-1!==l.indexOf(t)&&e.cols&&(h[t]=e.cols[t])});r=s.computeHighlightRules(t,r,this.propertyCache[vt.PROP_XAXIS],a,this.cols,h,n,r,this.colorDataArr);this.lineFillColors=s.getColorArray(r,0,i&&"No Fill"!==i,o)},vt.prototype.onHighlightRuleChange=function(t){var e=this,i=this.api.getProperty(this.indexProp(vt.PROP_YAXIS)),n=this.api.getProperty(this.indexProp(vt.PROP_COLOR)),r=this.api.getProperty(this.indexProp(vt.PROP_OPACITY)),o=new ft,a=this.getColumnKeysFromAxisString(i),s={};_.keys(this.cols).forEach(function(t){-1!==a.indexOf(t)&&e.cols&&(s[t]=e.cols[t])});n=o.computeHighlightRules(t,this.isRegexOrWild()?this.palette.length?this.palette:this.getPaletteProperty():n,this.api.getProperty(this.indexProp(vt.PROP_XAXIS)),i,this.cols,s,!1,"",this.colorDataArr),i=this.cols?Object.keys(this.cols):[];this.api.setProperty(this.indexProp("possibleRulesColumns"),i),this.highlightRules=o.getColorArray(n,r),this.isRegexOrWild()?this.colorArr=n:this.colorArr=Array.prototype.concat.apply([],n)},vt.prototype.onIconChange=function(t){var e,i=this;if(!(this.icon=t))return this.texture=null,void this.invalidate(Ot.Process);if(0===t.indexOf("fa-"))e=requirejs.toUrl("QuickBase").replace(/main$/,"")+"images/white/"+t.replace(/^fa-/,"")+".png";else{if(0!==t.indexOf("data:image/"))throw Error("Unsupported icon scheme!");e=t}this.image||(this.image=document.createElement("img")),this.el.append(this.image),this.image.height=1,this.image.style.visibility="hidden",this.image.src=e,this.image.onload=function(){i.image&&i.el.removeChild(i.image),i.invalidate(Ot.Process)}},vt.prototype.setCandlestickProperties=function(){var n=this,r=this.scalarColumns,o=this.api.getProperty(this.indexProp(vt.PROP_XAXIS)),t=[vt.PROP_OPEN,vt.PROP_HIGH,vt.PROP_LOW,vt.PROP_CLOSE],a=[vt.PROP_YAXIS,vt.PROP_COLORDATA,vt.PROP_COLOR];this.setIgnoreSettings(!0),t.forEach(function(t,e){var i=n.indexProp(t);n.api.getProperty(i)||n.api.setProperty(i,-1!==r.indexOf(t)?t:o),a[e]&&(e=n.indexProp(a[e]),n.api.getProperty(e)&&n.api.setProperty(e,void 0))}),this.setIgnoreSettings(!1)},vt.prototype.setColorData=function(e,t){var i=[],n=t?this.propertyCache[vt.PROP_FILLOPACITY]:this.propertyCache[vt.PROP_OPACITY];_.each(e,function(t){t=ct.hexColorToVec4(t,n);i.push(Object.values(t))});var r=this.api.getProperty(this.indexProp(vt.PROP_XAXIS)),r=this.yAxes.length?this.yAxes:_.without(this.scalarColumns,r);this.colorDataArr=this.isRegexOrWild()?r.map(function(t){return e}):e;r=this.isRegexOrWild()?r.map(function(t){return i}):[i];return t||(this.colorArr=this.colorDataArr,this.colorData=r),r},vt.prototype.setColorProperties=function(){this.setIgnoreSettings(!0);var t=this.indexProp(vt.PROP_COLOR),e=this.api.getProperty(t);this.isRegexOrWild()||this.isCandlestick()?(void 0!==e&&(this.colorCache=e),this.api.setProperty(t,void 0)):void 0!==e&&""!==e||this.api.setProperty(t,this.colorCache||f.COLOR_DEFAULT),this.setIgnoreSettings(!1)},vt.prototype.setLineFillProperties=function(){var t=this.api.getProperty(this.indexProp(vt.PROP_FILLCOLOR)),e=this.api.getProperty(this.indexProp(vt.PROP_FILLOPACITY)),i=this.api.getProperty(this.indexProp(vt.PROP_FADE));"No Fill"===this.api.getProperty(this.indexProp(vt.PROP_FILL))?(this.fillCache=[t||this.fillCache[0],e||this.fillCache[1],i||this.fillCache[2]],this.api.setProperty(this.indexProp(vt.PROP_FILLCOLOR),void 0),this.api.setProperty(this.indexProp(vt.PROP_FILLOPACITY),void 0),this.api.setProperty(this.indexProp(vt.PROP_FADE),void 0)):(void 0===t&&this.api.setProperty(this.indexProp(vt.PROP_FILLCOLOR),this.fillCache[0]||this.propertyCache[vt.PROP_COLOR]),void 0===e&&this.api.setProperty(this.indexProp(vt.PROP_FILLOPACITY),this.fillCache[1]||80),void 0===i&&this.api.setProperty(this.indexProp(vt.PROP_FADE),this.fillCache[2]||!1))},vt.PROP_DATA="Data",vt.PROP_TYPE="_Type",vt.PROP_XAXIS="XAxis",vt.PROP_YAXIS="YAxis",vt.PROP_COLOR="Color",vt.PROP_BARPERCENT="BarWidth",vt.PROP_BARFIXED="BarFixedWidth",vt.PROP_BARWIDTHTYPE="BarWidthType",vt.PROP_BEARCOLOR="CandlestickFormat.BearColor",vt.PROP_CANDLEPERCENT="CandlestickFormat.BarWidth",vt.PROP_CANDLEFIXED="CandlestickFormat.BarFixedWidth",vt.PROP_CANDLEWIDTHTYPE="CandlestickFormat.BarWidthType",vt.PROP_BULLCOLOR="CandlestickFormat.BullColor",vt.PROP_NEUTRALCOLOR="CandlestickFormat.NeutralColor",vt.PROP_FILL="Fill",vt.PROP_FILLCOLOR="FillColor",vt.PROP_FILLOPACITY="FillOpacity",vt.PROP_ICON="Icon",vt.PROP_PALETTE="Palette",vt.PROP_WICKCOLOR="CandlestickFormat.WickColor",vt.PROP_ACTIONS="Actions",vt.PROP_HIGHLIGHTRULES="HighlightRules",vt.PROP_XAXISID="XAxisId",vt.PROP_YAXISID="YAxisId",vt.BAR_MIN_RELATIVE_SZ=.02,vt.PROP_COLORDATA="ColorData",vt.PROP_ENABLED="Enabled",vt.PROP_FADE="FadeToTransparent",vt.PROP_OPACITY="Opacity",vt.PROP_PREFIX="Layers.",vt.PROP_RADIUS_SCALE="RadiusScaling",vt.PROP_RADIUS_DATA="RadiusData",vt.PROP_OPEN="Open",vt.PROP_HIGH="High",vt.PROP_LOW="Low",vt.PROP_CLOSE="Close",vt);function vt(t,e,i,n,r,o){this.index=t,this.uid=e,this.api=i,this.appInvalidate=n,this.setIgnoreSettings=r,this.el=o,this.config=null,this.colorArr=[],this.colorCache=null,this.colorData=[],this.colorDataArr=[],this.colorDataInfo=null,this.datasource=null,this.disabledColumns=[],this.fillCache=[],this.icon=null,this.image=null,this.isWebGL2="undefined"!=typeof WebGL2RenderingContext,this.palette=[],this.points=[],this.propertyCache={},this.renderer=null,this.rendererFill=null,this.texture=null,this.subId=_.uniqueId("glLayer"),this.renderState=Ot.Init,this.scalarColumns=[],this.workerIndex=[],this.worker=null,this.workerQueued=!1,this.yAxes=[]}var Ot,_t=(St.easeInQuad=function(t){return Math.pow(t,2)},St.easeOutQuad=function(t){return-(Math.pow(t-1,2)-1)},St.easeInOutQuad=function(t){return(t/=.5)<1?.5*Math.pow(t,2):-.5*((t-=2)*t-2)},St.easeInCubic=function(t){return Math.pow(t,3)},St.easeOutCubic=function(t){return Math.pow(t-1,3)+1},St.easeInOutCubic=function(t){return(t/=.5)<1?.5*Math.pow(t,3):.5*(Math.pow(t-2,3)+2)},St.easeInQuart=function(t){return Math.pow(t,4)},St.easeOutQuart=function(t){return-(Math.pow(t-1,4)-1)},St.easeInOutQuart=function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},St.easeInQuint=function(t){return Math.pow(t,5)},St.easeOutQuint=function(t){return Math.pow(t-1,5)+1},St.easeInOutQuint=function(t){return(t/=.5)<1?.5*Math.pow(t,5):.5*(Math.pow(t-2,5)+2)},St.easeInSine=function(t){return 1-Math.cos(t*(Math.PI/2))},St.easeOutSine=function(t){return Math.sin(t*(Math.PI/2))},St.easeInOutSine=function(t){return-.5*(Math.cos(Math.PI*t)-1)},St.easeInExpo=function(t){return 0===t?0:Math.pow(2,10*(t-1))},St.easeOutExpo=function(t){return 1===t?1:1-Math.pow(2,-10*t)},St.easeInOutExpo=function(t){return 0===t?0:1===t?1:(t/=.5)<1?.5*Math.pow(2,10*(t-1)):.5*(2-Math.pow(2,-10*--t))},St.easeInCirc=function(t){return-(Math.sqrt(1-t*t)-1)},St.easeOutCirc=function(t){return Math.sqrt(1-Math.pow(t-1,2))},St.easeInOutCirc=function(t){return(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1)},St.easeOutBounce=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},St.easeInBack=function(t){return t*t*(2.70158*t-1.70158)},St.easeOutBack=function(t){return(t-=1)*t*(2.70158*t+1.70158)+1},St.easeInOutBack=function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},St.elastic=function(t){return-1*Math.pow(4,-8*t)*Math.sin((6*t-1)*(2*Math.PI)/2)+1},St.swingFromTo=function(t){var e=1.70158;return(t/=.5)<1?t*t*((1+(e*=1.525))*t-e)*.5:.5*((t-=2)*t*((1+(e*=1.525))*t+e)+2)},St.swingFrom=function(t){return t*t*(2.70158*t-1.70158)},St.swingTo=function(t){return--t*t*(2.70158*t+1.70158)+1},St.bounce=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},St.bouncePast=function(t){return t<1/2.75?7.5625*t*t:t<2/2.75?2-(7.5625*(t-=1.5/2.75)*t+.75):t<2.5/2.75?2-(7.5625*(t-=2.25/2.75)*t+.9375):2-(7.5625*(t-=2.625/2.75)*t+.984375)},St.easeFromTo=function(t){return(t/=.5)<1?.5*Math.pow(t,4):-.5*((t-=2)*Math.pow(t,3)-2)},St.easeFrom=function(t){return Math.pow(t,4)},St.easeTo=function(t){return Math.pow(t,.25)},St);function St(){}function Rt(t){this.ignoreSettingsChange=!1,this.layers=[],this.isLoading=!1,this.xAxisLayer={},this.yAxisLayer={},this.layerXAxis={},this.layerYAxis={},this.xAxisDataBounds=[],this.yAxisDataBounds=[],this.xAxisViewBounds=[],this.yAxisViewBounds=[],this.activeZoom=new H(0,0,1,1),this.animateZoom=!1,this.selZoom=!1,this.lastXZoom=[],this.lastYZoom=[],this.xAxisZoom=[],this.yAxisZoom=[],this.onXZoom=!1,this.onYZoom=!1,this.zoomTime=0,this.resetZoom=!1,this.activeBounds=[],this.activeXPan=[],this.activeYPan=[],this.expressTime=Date.now()-Rt.REST_MS,this.overPoint=null,this.size=new k(1,1),this.renderedMargin=new H(0,0,0,0),this.renderedSize=new k(1,1),this.updateLegend=!1,this.click=!1,this.hover=!1,this.settingsSelected=!1,this.settingsHovered=!1,this.renderState=Ot.Valid,this.panning=!1,this.options=t,this.api=t.api,this.el=t.el,this.el.className+=" ChartGL",this.uid=_.uniqueId("ChartGL"),this.el.innerHTML=h.app({uid:this.uid}),this.axis=new st(this.api,this.el.getElementsByClassName("axis")[0]),this.tooltips=new K(this.api),this.pan=new ot(this.api,this.axis,this.onPan.bind(this)),this.legend=new nt(this.el,this.api,this.tooltips,this.invalidate.bind(this),this.setIgnoreSettings.bind(this),this.updateWildcardLayers.bind(this)),this.canvas=this.el.getElementsByTagName("canvas")[1],this.image=document.createElement("img"),this.image.style.opacity="0",this.crosshairHover=new $(this.el,this.api,this.canvas),this.crosshairSelected=new $(this.el,this.api,this.canvas),this.overlay=new ht(this.el.getElementsByClassName("overlay")[0],this.onOverlayOver.bind(this),this.onOverlayZoom.bind(this),this.onOverlayReset.bind(this),this.onOverlayClick.bind(this)),G.isWebGLHWAcclEnabled||w.Log.Warn("ChartGL: Hardware Acceleration not enabled"),this.gl=this.canvas.getContext(G.glContext,{premultipliedAlpha:G.isWebGLHWAcclEnabled,preserveDrawingBuffer:!0}),this.gl?(this.setTheme(t.dashboardViewModel.get(Rt.APP_THEME)),this.onResize(),this.initializeEventListeners()):w.Log.Error("ChartGL: Context Not Initialized")}return(e=Ot=Ot||{})[e.Init=0]="Init",e[e.Data=1]="Data",e[e.Loaded=2]="Loaded",e[e.Process=3]="Process",e[e.Axis=4]="Axis",e[e.Uniforms=5]="Uniforms",e[e.Tooltip=6]="Tooltip",e[e.Valid=7]="Valid",Rt.getNewLayerId=function(t){for(var e=0;t["L"+e];)e++;return"L"+e},Rt.prototype.onOverlayOver=function(t){var e;(null==t?void 0:t.x)===(null===(e=this.overPoint)||void 0===e?void 0:e.x)&&(null==t?void 0:t.y)===(null===(e=this.overPoint)||void 0===e?void 0:e.y)||(!t&&this.overPoint&&this.api.setProperty(Rt.PROP_HOVER,""),this.overPoint=t,this.invalidate(Ot.Tooltip),t&&(this.hover=!0))},Rt.prototype.onOverlayZoom=function(t){var i=this;w.Log.Log("Region: "+t);var n=new H(t.x,1-t.w,t.z,1-t.y),e=new k(this.activeZoom.x,this.activeZoom.z),r=new k(this.activeZoom.y,this.activeZoom.w),o=G.calculateCroppedJs2(new k(n.x,n.z),e),t=G.calculateCroppedJs2(new k(n.y,n.w),r);this.onXZoom=!_.isEqual(e,o),this.onYZoom=!_.isEqual(r,t),this.activeZoom=this.activeZoom?G.calculateCroppedBounds(n,this.activeZoom):n,this.zoomTime=Date.now(),this.onXZoom&&this.xAxisZoom.forEach(function(t,e){return i.xAxisZoom[e]=t?G.calculateCroppedJs2(new k(n.x,n.z),t).applyFn(G.convertJSToNumber):new k(i.activeZoom.x,i.activeZoom.z)}),this.onYZoom&&this.yAxisZoom.forEach(function(t,e){return i.yAxisZoom[e]=t?G.calculateCroppedJs2(new k(n.y,n.w),t).applyFn(G.convertJSToNumber):new k(i.activeZoom.y,i.activeZoom.w)}),this.invalidate(Ot.Process)},Rt.prototype.onOverlayReset=function(){var i=this;this.zoomTime=Date.now(),this.activeZoom=new H(0,0,1,1),this.resetZoom=!0,this.activeXPan.forEach(function(t,e){return i.activeXPan[e]=new k(0,1)}),this.activeYPan.forEach(function(t,e){return i.activeYPan[e]=new k(0,1)}),this.setIgnoreSettings(!0),this.axis.x.forEach(function(t,e){return t.setRangeViewstate(null,"Xaxes",e)}),this.axis.y.forEach(function(t,e){return t.setRangeViewstate(null,"Yaxes",e)}),this.setIgnoreSettings(!1),this.getSelectionViewstates(),this.invalidate(Ot.Process)},Rt.prototype.onPan=function(t,e,i,n){e&&this.crosshairSelected.onPan(e),"Right"===n||"Left"===n?this.activeXPan[i]=new k(t.x,t.z):this.activeYPan[i]=new k(t.y,t.w),this.invalidate(Ot.Axis)},Rt.prototype.onResize=function(){this.size=new k(this.el.offsetWidth,this.el.offsetHeight),this.legend.onResize(this.axis);var t=this.layers.filter(function(t){return t.hasFixedWidth()||t.isCandlestick()});_.each(t,function(t){return t.onResize()}),this.invalidate(t.length?Ot.Process:Ot.Axis)},Rt.prototype.onSettingsChange=function(i){var t,e,n,r,o,a,s,l,h,u,c,p=this;this.ignoreSettingsChange||(t=_.find(_.keys(i),function(t){return 0===t.indexOf(Rt.PROP_SELECT)}),e=_.find(_.keys(i),function(t){return 0===t.indexOf(Rt.PROP_HOVER)}),(!t&&e||!e&&t)&&(this.settingsSelected=!(!t||this.click),this.settingsHovered=!(!e||this.hover),this.invalidate(Ot.Tooltip)),i.hasOwnProperty("Layers")||(h=G.expandNestedViewStates(i,this.api),h=G.replaceViewStatesWithValue("",h,this.api),i=h),0<(h=_.filter(_.keys(i),function(t){return-1!==t.indexOf("Layers.")})).length&&(n={},_.each(h,function(t){_.set(n,t,i[t]),delete i[t]}),_.extend(i,n)),i[Rt.PROP_LAYERS]&&(r=this.api.getProperty(Rt.PROP_LAYERS),o=!1,a=_.reduce(r,function(t,e){return t[e[Rt.PROP_LAYER_ID]]=!0,t},{}),_.each(this.layers,function(t){void 0===t||a[t.getId()]||(o=!0,t.remove(p.gl),p.layers.splice(p.layers.indexOf(t),1),p.activeBounds.splice(p.layers.indexOf(t),1))}),_.each(this.layers,function(e){var t=_.findIndex(r,function(t){return t._Id===e.getId()});e.index!==t&&(e.index=t)}),u=_.some(this.layers,function(t){if(i&&i.Layers){var e=i.Layers[t.index];return t.wildcardDataChanged(e[xt.PROP_DATA])}}),this.updateWildcardLayers(!1,u),this.drawLayers(i),this.updateLegend=!0,this.invalidate(this.layers.length?o?Ot.Process:Ot.Axis:Ot.Uniforms)),s=_.find(_.keys(i),function(t){return 0===t.indexOf("Xaxes")}),l=_.find(_.keys(i),function(t){return 0===t.indexOf("Yaxes")}),h=this.api.getProperty("Xaxes"),u=this.api.getProperty("Yaxes"),(s||l)&&(s&&_.each(h,function(t,e){return p.axis.onSettingsChange(s,e)}),l&&_.each(u,function(t,e){return p.axis.onSettingsChange(l,e)}),c=h.concat(u),_.each(c,function(t,e){var i="Top"===t.Position||"Bottom"===t.Position?"Xaxes":"Yaxes",t=p.api.getPropertyMeta(i+"."+e+J.PROP_SEL_MIN),e=p.api.getPropertyMeta(i+"."+e+J.PROP_SEL_MAX);(null!==t&&t.viewstateType||null!==e&&e.viewstateType)&&(p.selZoom=!0)}),this.selZoom&&(this.getSelectionViewstates(),this.zoomTime=Date.now()),this.invalidate(Ot.Process)),(c=_.find(_.keys(i),function(t){return 0===t.indexOf(Rt.PROP_CROSSHAIRS)}))&&!i[c]&&this.crosshairHover.hideCrosshair("hide-both"),(c=_.find(_.keys(i),function(t){return 0===t.indexOf(Rt.PROP_COORDS)}))&&!i[c]&&this.tooltips.hideCoordinates(this.el))},Rt.prototype.updateWildcardLayers=function(i,n){var r=this,t=_.filter(this.api.getProperty("Layers"),function(t){return G.isRegexOrWild(t.YAxis)});_.each(t,function(e){var t=_.findIndex(r.layers,function(t){return t.getId()===e._Id});e.Enabled||r.legend.updateWildcards(r.layers[t],t),!0!==e.Enabled||i||r.legend.updateWildcards(r.layers[t],t,"reset",n)}),this.legend.getLayers(this.layers)},Rt.prototype.remove=function(){var e=this;return this.overlay&&this.overlay.remove(),this.layers.forEach(function(t){return t.remove(e.gl)}),this},Rt.prototype.setTheme=function(t){"Light"===t?this.el.classList.add("Light"):this.el.classList.remove("Light"),this.axis.updateTheme(t),this.axis.renderAxes(),this.legend.updateTheme(t),this.tooltips.updateTheme(t,this.el),this.updateLegend=!0,this.theme=t,this.invalidate(Ot.Axis)},Rt.prototype.calculateLayerAxisMaps=function(){var n=this;this.xAxisLayer={},this.yAxisLayer={},this.layerXAxis={},this.layerYAxis={},this.layers.forEach(function(t,e){var i=n.api.getProperty(t.indexProp(xt.PROP_XAXISID)).replace(/.*?(\d+)$/,"$1"),t=n.api.getProperty(t.indexProp(xt.PROP_YAXISID)).replace(/.*?(\d+)$/,"$1");i&&(i=Number(i)-1,void 0===n.xAxisLayer[i]?n.xAxisLayer[i]=[e]:n.xAxisLayer[i].push(e),n.layerXAxis[e]=i),t&&(t=Number(t)-1,void 0===n.yAxisLayer[t]?n.yAxisLayer[t]=[e]:n.yAxisLayer[t].push(e),n.layerYAxis[e]=t)})},Rt.prototype.createDataBounds=function(t,r,o,a){var s=this;return t.map(function(t,e){var i=new k(0,1);o[e]&&(n=o[e].map(function(t){return s.layers[t].isEnabled()&&s.layers[t].hasData()?r[t]:null}).filter(function(t){return t}),i=G.mergeRange(n)||new k(0,1));var n=_.max(s.getLayerTypes(a?"X":"Y",e));return s.axis.getBounds(i,a?"Xaxes":"Yaxes",e,n)})},Rt.prototype.createViewBounds=function(l,h,u,c,t){var p=this;return t.map(function(t,e){var i=new k(0,1),n=new k(0,1),r=c?p.xAxisLayer:p.yAxisLayer;if(!r[e])return[i,n];var o=r[e].map(function(t){if(l[t])return c?G.xPart(l[t]):G.yPart(l[t])}).filter(function(t){return t}),i=G.mergeRange(o)||new k(0,1),a=_.max(p.getLayerTypes(c?"X":"Y",e));p.updateZoomValues(i,e,a,c);var s=(c?p.xAxisZoom:p.yAxisZoom)[e],r=s?s.applyFn(G.convertJSToNumber):c?new k(p.activeZoom.x,p.activeZoom.z):new k(p.activeZoom.y,p.activeZoom.w),o=r;return h?(s=(c?p.lastXZoom:p.lastYZoom)[e],o=G.scale2(u,s,r)):(p.zoomTime=0,c?p.lastXZoom[e]=_.clone(r):p.lastYZoom[e]=_.clone(r)),n=o.applyFn(G.convertJSToNumber),[G.calculateCroppedJs2(n,i,a),n]})},Rt.prototype.drawCoordinates=function(t,e,i,n){var r="";e&&("x"===(r=this.overlay.getZoomDirection())?this.tooltips.hideCoordinates(this.el,"y"):"y"===r&&this.tooltips.hideCoordinates(this.el,"x"));var o,a,s=this.api.getProperty(Rt.PROP_SNAP)&&!e,l=!s&&this.overPoint?new k(this.overPoint.x,Math.abs(this.overPoint.y)):new k(t.overpoint.x,1-t.overpoint.y),h=e?0:t.layer.index,u=this.activeBounds[h].applyFn(G.toNumber),c=null,p=null;"y"!==r&&(a=(o=t.layer.XType)?new k(Number(G.convertJSToScalar(o,u.x)),Number(G.convertJSToScalar(o,u.z))):new k(u.x,u.z),h=s?i:(a.y-a.x)*l.x+a.x,c=this.getCoordinateInfo(t,e,h,i,"x")),"x"!==r&&(a=(o=t.layer.YType)?new k(Number(G.convertJSToScalar(o,u.y)),Number(G.convertJSToScalar(o,u.w))):new k(u.y,u.w),a=s?n:(a.x-a.y)*l.y+a.y,p=this.getCoordinateInfo(t,e,a,n,"y")),this.tooltips.drawCoordinates(this.canvas,l,this.renderedMargin,this.el,c,p)},Rt.prototype.drawLayers=function(a){var s=this,l=this.api.getProperty(Rt.PROP_LAYERS),h=_.reduce(l,function(t,e){return t[e[Rt.PROP_LAYER_ID]]=!0,t},{});_.each(l,function(t,e){var i=(t=a.Layers[e]?a.Layers[e]:t)[Rt.PROP_LAYER_ID];_.isEmpty(i)&&(i=t[Rt.PROP_LAYER_ID]=Rt.getNewLayerId(h),h[i]=!0,s.api.setProperty(Rt.PROP_LAYERS+"."+e+"."+Rt.PROP_LAYER_ID,i,{silent:!0}));var n=t[Rt.PROP_LAYER_NAME];_.isEmpty(n)&&s.api.setProperty(Rt.PROP_LAYERS+"."+e+"."+Rt.PROP_LAYER_NAME,n="Layer "+(e+1));var r,o=_.find(s.layers,function(t){return t.getId()===i}),e=_.findIndex(l,function(t){return t._Id===i}),n=!1;o||(n=!0,o=new xt(e,i,s.api,s.invalidate.bind(s),s.setIgnoreSettings.bind(s),s.el),s.layers.push(o)),o.onSettingsChange(t),0<e&&!o.getDataSource()&&n&&(r=e-1,n=[xt.PROP_COLOR,xt.PROP_XAXISID,xt.PROP_YAXISID,xt.PROP_TYPE,xt.PROP_XAXIS,xt.PROP_YAXIS,xt.PROP_BARPERCENT,xt.PROP_BARFIXED,xt.PROP_BARWIDTHTYPE,xt.PROP_FILL,xt.PROP_FILLCOLOR,xt.PROP_FILLOPACITY,xt.PROP_BEARCOLOR,xt.PROP_BULLCOLOR,xt.PROP_NEUTRALCOLOR,xt.PROP_WICKCOLOR,xt.PROP_CANDLEPERCENT,xt.PROP_CANDLEFIXED,xt.PROP_CANDLEWIDTHTYPE,xt.PROP_PALETTE],e=_.map(n,function(t){return s.api.getProperty("Layers."+r+"."+t)}),o.updateLayer(s.layers[r].getDataSource(),e,n))});var i=[];_.each(l,function(e){var t=s.layers[_.findIndex(s.layers,function(t){return t.getId()===e._Id})];t&&i.push(t)}),this.layers=i,this.legend.getLayers(this.layers);var n=this.layers.filter(function(t){return"Line"===s.api.getProperty(t.indexProp(xt.PROP_TYPE))});this.setIgnoreSettings(!0),_.each(n,function(t){var e=s.api.getProperty(t.indexProp("Fill")),i=s.api.getProperty(t.indexProp("possibleLayers"));i&&i.length===n.length+1||(i=_.map(n,function(t){return"Layer "+(t.index+1)}),i=["No Fill","Origin"].concat(_.without(i,"Layer "+(t.index+1))),s.api.setProperty(t.indexProp("possibleLayers"),i),-1===i.indexOf(e)&&s.api.setProperty(t.indexProp("Fill"),"No Fill"))}),this.setIgnoreSettings(!1)},Rt.prototype.doActions=function(t,n,r){var o,e=this.api.getProperty(t.indexProp(xt.PROP_ACTIONS));e.length&&(this.setIgnoreSettings(!0),o=[],e.forEach(function(t,e){var i=n.data[t.Current];"mousemove"===r&&"Hover"!==t.Trigger||"mousemove"!==r&&"Hover"===t.Trigger||o.push(a(a({},t),{Current:i,_PropertyIndex:e}))}),this.api.doActions(o,"Layers."+t.index+".Actions"),this.setIgnoreSettings(!1))},Rt.prototype.getLayerDataBounds=function(t){return H.fromVec2(this.xAxisDataBounds[this.layerXAxis[t]],this.yAxisDataBounds[this.layerYAxis[t]])},Rt.prototype.getLayerViewBounds=function(t){return H.fromVec2(this.xAxisViewBounds[this.layerXAxis[t]],this.yAxisViewBounds[this.layerYAxis[t]])},Rt.prototype.getCoordinateInfo=function(t,e,i,n,r){var o=t.layer.getAxisId(r.toUpperCase()),a="x"===r?"Xaxes.":"Yaxes.",a=e?this.api.getProperty(a+"0.Position"):this.api.getProperty(a+o+".Position"),o=i;return!_.isEqual(i,n)&&w.Tools.isKDBTemporal(n)&&(t=t.layer.index,o=G.convertToJsScalar(this.getLayerType(r,t),i,!0)),{position:a,val:o}},Rt.prototype.getLayerType=function(t,e){e=this.layers[e];return"y"===t?e.YType:e.XType},Rt.prototype.getLayerTypes=function(e,i){return this.layers.filter(function(t){return t.getAxisId(e)===i&&t.isEnabled()}).map(function(t){return"X"!==e&&t.YType||t.XType})},Rt.prototype.getSelectionViewstates=function(){var n=this;this.axis.x.forEach(function(t,e){var i=n.axis.getSelectionZoomBounds(n.xAxisDataBounds[e],"Xaxes",e,_.max(n.getLayerTypes("X",e)));n.xAxisZoom[e]=G.calculateCrop(i,n.xAxisDataBounds[e])}),this.axis.y.forEach(function(t,e){var i=n.axis.getSelectionZoomBounds(n.yAxisDataBounds[e],"Yaxes",e,_.max(n.getLayerTypes("Y",e)));n.yAxisZoom[e]=G.calculateCrop(i,n.yAxisDataBounds[e])})},Rt.prototype.initializeEventListeners=function(){var e,i=this;this.el.addEventListener("mousedown",function(t){t.target===i.el.getElementsByClassName("axis")[0]&&(i.panning=!0,e=i.pan.onAxisPan(t,i.el.getBoundingClientRect())[1],i.pan.onPointDown(i.pan.onAxisPan(t,i.el.getBoundingClientRect())[0],e))}),document.addEventListener("mouseup",function(){setTimeout(function(){i.panning=!1,document.body.style.cursor="default"},75)}),document.addEventListener("mousemove",function(t){i.panning&&(t=i.pan.onAxisPan(t,i.el.getBoundingClientRect())[0],i.pan.onPanning(t,e,i.xAxisZoom,i.yAxisZoom,i.activeXPan,i.activeYPan,i.el))})},Rt.prototype.invalidate=function(t){if(t<this.renderState){if((this.renderState=t)===Ot.Process&&this.expressTime<Date.now()-Rt.REST_MS&&_.every(this.layers,function(t){return t.RenderState===Ot.Process}))return this.expressTime=Date.now(),this.validate();window.requestAnimationFrame(this.validate.bind(this))}},Rt.prototype.onOverlayClick=function(){this.click=!0,this.invalidate(Ot.Tooltip)},Rt.prototype.setIgnoreSettings=function(t){this.ignoreSettingsChange=t},Rt.prototype.setRange=function(t,e,i,n,r){var o=r?new k(this.activeZoom.x,this.activeZoom.z):new k(this.activeZoom.y,this.activeZoom.w),o=n?n.applyFn(G.convertJSToNumber):o,i=G.calculateCroppedJs2(o,e,i);this.setIgnoreSettings(!0),r?this.axis.x[t].setRangeViewstate(i,"Xaxes",t):this.axis.y[t].setRangeViewstate(i,"Yaxes",t),this.setIgnoreSettings(!1)},Rt.prototype.updateLayerPossibleAxes=function(){var n=this;this.setIgnoreSettings(!0);var r=this.api.getProperty(Rt.PROP_XAXES),o=this.api.getProperty(Rt.PROP_YAXES);_.each(this.layers,function(t,e){var i=n.api.getProperty("Layers."+e+".possibleXAxes"),e=n.api.getProperty("Layers."+e+".possibleYAxes");i.length!==r.length&&t.updateAxisId(r,"X"),e.length!==o.length&&t.updateAxisId(o,"Y")}),this.setIgnoreSettings(!1)},Rt.prototype.updateZoomValues=function(t,e,i,n){var r=this.axis.getSelectionZoomBounds(t,n?"Xaxes":"Yaxes",e,i);n?(this.selZoom&&(this.xAxisZoom[e]=G.calculateCrop(r,t)),this.onXZoom&&this.setRange(e,t,i,this.xAxisZoom[e],n)):(this.selZoom&&(this.yAxisZoom[e]=G.calculateCrop(r,t)),this.onYZoom&&this.setRange(e,t,i,this.yAxisZoom[e],n))},Rt.prototype.validate=function(){var o=this;if(!this.api.getProperty("Layers").length)return this.api.showErrorMessage({error:t("To get started, please add a layer from")+" <b> "+t("Properties-Layers")+" </b> ",type:"Warning"}),void this.legend.drawLegends(this.axis);var e=this.layers.filter(function(t){return t.isEnabled()}),i=e.filter(function(t){return t.Config});this.layers.filter(function(t){return!t.isEnabled()}).length&&!i.length&&(this.renderState=Ot.Axis);var n=_.some(e,function(t){return t.RenderState===Ot.Data}),e=e.map(function(t){return t.datasourceError}).filter(function(t){return!!t});n&&_.isEmpty(e)?(this.isLoading||this.api.showQueryStatus({error:"",type:"Loading"}),this.isLoading=!0):(e.length&&e[0]?(this.api.showQueryStatus({error:t(e[0].error),type:"Error"}),this.renderState=Ot.Valid):this.api.hideQueryStatus(),this.isLoading=!1),this.calculateLayerAxisMaps(),this.renderState<=Ot.Process&&i.length&&(0<this.layers.length&&this.layers.some(function(t){return t.getDataSource()})&&this.api.hideErrorMessage(),r=this.layers.map(function(t){return t.getDataRangeX()}),s=this.layers.map(function(t){return t.getDataRangeY()}),L=this.api.getProperty("Xaxes"),A=this.api.getProperty("Yaxes"),this.xAxisDataBounds=this.createDataBounds(L,r,this.xAxisLayer,!0),this.yAxisDataBounds=this.createDataBounds(A,s,this.yAxisLayer,!1),this.activeXPan=L.map(function(t,e){return o.activeXPan[e]||new k(0,1)}),this.activeYPan=A.map(function(t,e){return o.activeYPan[e]||new k(0,1)}),l=this.layers.filter(function(t){return t.hasFixedWidth()||t.isCandlestick()}),(this.onXZoom||this.onYZoom||this.selZoom)&&!this.resetZoom||_.each(l,function(t){return t.onResize()}),(a=i.filter(function(t){return t.hasData()})).forEach(function(t){t.processData(o.gl,o.size,G.calculateCroppedJsBounds(o.activeZoom,o.getLayerDataBounds(t.index),o.getLayerType("x",t.index),o.getLayerType("y",t.index)))}),a.forEach(function(t){var e,i,n=t.getFillType(),r=-1!==n.indexOf("Layer");t.RenderState!==Ot.Process||!r&&"Origin"!==n||(i=e=null,r&&(i=Number(n.replace(/.*?(\d+)$/,"$1")||1)-1,e=o.layers[i].getFillToLayerData()),i={fill:n,cols:e,toBounds:null!==i?G.calculateCroppedJsBounds(o.activeZoom,o.getLayerDataBounds(i),o.getLayerType("x",i),o.getLayerType("y",i)):void 0,fromBounds:G.calculateCroppedJsBounds(o.activeZoom,o.getLayerDataBounds(t.index),o.getLayerType("x",t.index),o.getLayerType("y",t.index))},t.processLineFillData(o.gl,i))}),!i.filter(function(t){return t.RenderState>=Ot.Process}).length&&i.length||(this.renderState=Ot.Axis),_.some(i,function(t){return!1===t.hasData()})&&(this.renderState=Ot.Process));var r,a,s,l,h,u=[],c=[];if(this.renderState===Ot.Axis&&(this.updateLayerPossibleAxes(),r=this.layers.map(function(t){if(!t.isEnabled()||!t.Config)return null;var e=t.index,i=t.getAxisId("X"),n=t.getAxisId("Y"),i=o.activeXPan[i],n=o.activeYPan[n],i=new H(i.x,n.x,i.y,n.y),n=t.getPaddedRange(o.getLayerDataBounds(e),o.size),t=o.getLayerType("x",e),e=o.getLayerType("y",e);return G.calculateCroppedJsBounds(i,n,t,e)}),a=(s=Date.now()-this.zoomTime)<(l=this.api.getProperty(Rt.PROP_DURATION)),s=(0,_t[this.api.getProperty(Rt.PROP_EASING)])(s/l),this.animateZoom=a,l=this.api.getProperty("Xaxes"),l=this.createViewBounds(r,a,s,!0,l),this.xAxisViewBounds=l.map(function(t){return t[0]}),u=l.map(function(t){return t[1]}),l=this.api.getProperty("Yaxes"),l=this.createViewBounds(r,a,s,!1,l),this.yAxisViewBounds=l.map(function(t){return t[0]}),c=l.map(function(t){return t[1]}),this.onXZoom=!1,this.onYZoom=!1,this.selZoom=!1,this.setIgnoreSettings(!0),_.values(this.axis.x).forEach(function(t,e){var i=o.getLayerTypes("X",e),e=o.xAxisViewBounds[e]||new k(0,1);t.updateBounds(e,i)}),_.values(this.axis.y).forEach(function(t,e){var i=o.getLayerTypes("Y",e),e=o.yAxisViewBounds[e]||new k(0,1);t.updateBounds(e,i)}),this.setIgnoreSettings(!1),this.updateLegend&&(this.updateLegend=!1,this.legend.drawLegends(this.axis)),_.first(i.map(function(t){return t.Config}).filter(function(t){return!!t}))&&(f=this.axis.render(this.size.x,this.size.y,this.api.getProperty("Xaxes"),this.api.getProperty("Yaxes")),_.isEqual(f,this.renderedMargin)&&this.size===this.renderedSize||(g=Math.max(this.size.x-f.x-f.z,0),y=Math.max(this.size.y-f.y-f.w,0),this.overlay.resize(f.x,f.y,g,y),this.canvas.style.left=f.x+"px",this.canvas.style.top=f.y+"px",this.canvas.width=g,this.canvas.height=y,this.renderedMargin=_.clone(f),this.renderedSize=this.size),g=u[0]||new k(0,1),this.crosshairSelected.updateSelected(g,this.animateZoom)),this.renderState=Ot.Uniforms),this.renderState===Ot.Uniforms&&_.every(i.filter(function(t){return t.hasData()}),function(t){return t.RenderState>=Ot.Uniforms})&&(G.isWebGLHWAcclEnabled||G.isIE11?this.gl.clearColor(0,0,0,0):"Light"===this.theme?this.gl.clearColor(.973,.973,.973,0):this.gl.clearColor(.157,.157,.157,0),(h=this.gl).clear(h.COLOR_BUFFER_BIT),h.viewport(0,0,h.canvas.width,h.canvas.height),h.enable(h.BLEND),h.blendFunc(h.SRC_ALPHA,h.ONE_MINUS_SRC_ALPHA),_.filter(i,function(t){return t&&t.RenderState===Ot.Uniforms}).forEach(function(t){var e,i,n;t.hasData()&&(e=0,o.api.getProperty("Layers."+t.index+".ScaleOnZoom")&&(n=o.animateZoom?u:o.lastXZoom,i=o.animateZoom?c:o.lastYZoom,n=n[o.layerXAxis[t.index]]||new k(0,1),i=i[o.layerYAxis[t.index]]||new k(0,1),e=(n=H.fromVec2(n,i)).z-n.x+(n.w-n.y)),i="Line"===o.api.getProperty(t.indexProp("_Type")),n="No Fill"!==o.api.getProperty(t.indexProp("Fill")),i&&n&&t.render(h,o.getLayerViewBounds(t.index),e,!0),t.render(h,o.getLayerViewBounds(t.index),e,!1))}),this.renderState=this.panning||this.animateZoom?Ot.Axis:Ot.Tooltip),this.renderState===Ot.Tooltip){if(this.resetZoom=!1,this.activeBounds=this.layers.map(function(t){return o.getLayerViewBounds(t.index)}),!this.activeBounds.length)return;var p,d,y=this.api.getProperty(Rt.PROP_HOVER),f=this.api.getProperty(Rt.PROP_SELECT),g=void 0;null!==this.overPoint||!y&&!f||(p=this.settingsSelected?f:this.settingsHovered?y:"")&&(d=p,(m=_.find(this.xAxisViewBounds,function(t,e){e=_.max(o.getLayerTypes("X",e));return d=G.convertJSToNumber(G.convertStringToJsScalar(p,e)),t=t.applyFn(G.convertJSToNumber),d>=t.x&&d<=t.y}))&&(P=m.applyFn(G.convertJSToNumber),g=new k((d-P.x)/(P.y-P.x),0)));var m=this.api.getProperty(Rt.PROP_COORDS),P=this.overlay.isDragging(),x=this.overPoint||g;if(!x||P&&!m)return this.renderState=Ot.Valid,void(y||(this.tooltips.hideTooltip(),this.tooltips.hideCoordinates(this.el),this.crosshairHover.hideCrosshair(""),this.hover=!1));var v=[],O=[];i.forEach(function(e){var t=e.getClosestPointFromRelativeX(x.x,1+x.y,o.canvas.width,G.convertVec4ToScalar(o.getLayerViewBounds(e.index),o.getLayerType("x",e.index),o.getLayerType("y",e.index)));null!==t&&v.push(new j(e,t[0],t[1],t[2],t[3])),o.api.getProperty("Overlay.ShowAllPoints")&&(t=e.getAllPointsFromRelativeX(),_.each(t,function(t){_.each(t,function(t){t&&O.push(new j(e,t[0],t[1],t[2],t[3]))})}))});var S=null,R=null,b=null,T=x.x,C=1+x.y;if(_.each(v,function(t){var e=Number(t.overpoint.x),i=Number(t.overpoint.y);null===R?(R=Math.abs(T-e),b=Math.abs(C-i),S=t):(e=Math.abs(T-e))<R?(R=e,b=Math.abs(C-i),S=t):e===R&&b&&Math.abs(C-i)<b&&(b=Math.abs(C-i),R=e,S=t)}),S){y=S.overpoint;if(1<y.x||y.x<0||1<y.y||y.y<0||isNaN(y.x)||isNaN(y.y))return void(this.renderState=Ot.Valid);i=O.length?O:v,y=this.tooltips.render(this.canvas,S,i,v),i=this.tooltips.returnPointInfo();if(i&&y){var L=this.api.getProperty(S.layer.indexProp(xt.PROP_XAXIS)),A=S.yAxis,L=y[L];if(m&&this.drawCoordinates(S,P,L,y[A]),P)return this.crosshairHover.hideCrosshair(""),this.tooltips.hideTooltip(),void(this.renderState=Ot.Valid);this.hover||!this.click&&!this.settingsSelected?(this.doActions(S.layer,i,"mousemove"),P=!this.api.getProperty(Rt.PROP_SNAP)&&this.overPoint?new k(this.overPoint.x,1+this.overPoint.y):S.overpoint,this.crosshairHover.render(this.renderedMargin,P,"hover",this.options.dashboardViewModel.get(Rt.APP_THEME)),this.overPoint&&this.api.getPropertyMeta(Rt.PROP_HOVER).viewstateType&&(w.Tools.isKDBTemporal(L)&&(L=w.Tools.convertKDBTemporalToMoment(L).toDashString()),this.api.setProperty(Rt.PROP_HOVER,L))):(this.doActions(S.layer,i,"click"),this.crosshairSelected.render(this.renderedMargin,S.overpoint,"click",this.options.dashboardViewModel.get(Rt.APP_THEME)),this.click&&this.api.getPropertyMeta(Rt.PROP_SELECT).viewstateType&&(w.Tools.isKDBTemporal(L)&&(L=w.Tools.convertKDBTemporalToMoment(L).toDashString()),this.api.setProperty(Rt.PROP_SELECT,L)))}}else this.tooltips.hideTooltip();this.hover=!1,this.click=!1,this.settingsHovered=!1,this.settingsSelected=!1,this.renderState=Ot.Valid}this.renderState<Ot.Valid&&window.requestAnimationFrame(this.validate.bind(this))},Rt.getComponentDefinition=f.getComponentDefinition,Rt.PROP_COORDS="Overlay.ShowCoordinates",Rt.PROP_CROSSHAIRS="Overlay.ShowCrosshairs",Rt.PROP_DURATION="Basics.Duration",Rt.PROP_HOVER="Basics.Hover",Rt.PROP_SELECT="Basics.Selected",Rt.PROP_EASING="Basics.Easing",Rt.PROP_LAYERS="Layers",Rt.PROP_LAYER_ID="_Id",Rt.PROP_LAYER_NAME="Name",Rt.PROP_SNAP="Overlay.SnapToPoint",Rt.APP_THEME="DashboardTheme",Rt.PROP_XAXES="Xaxes",Rt.PROP_YAXES="Yaxes",Rt.REST_MS=500,Rt});